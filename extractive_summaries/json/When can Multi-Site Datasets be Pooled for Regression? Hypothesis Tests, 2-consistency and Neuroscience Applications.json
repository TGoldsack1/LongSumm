{
  "sections": [{
    "heading": "1. Introduction",
    "text": "In the last two decades, statistical machine learning algorithms for processing massive datasets have been intensively studied for a wide-range of applications in computer vision, biology, chemistry and healthcare (Murdoch & Detsky, 2013; Tarca et al., 2007). While the challenges posed by large scale datasets are compelling, one is often faced with a fairly distinct set of technical issues for studies in biological and health sciences. For instance, a sizable portion\n1University of Wisconsin-Madison 2William S. Middleton Memorial Veteran’s Affairs Hospital. Correspondence to: Hao Zhou <hzhou@stat.wisc.edu>, Vikas Singh <vsingh@biostat.wisc.edu>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nof scientific research is carried out by small or mediumsized groups (Fortin & Currie, 2013) supported by modest budgets (Lauer, 2016). Hence, there are logistic/financial constraints on the number of experiments and/or number of participants within a trial, leading to small size datasets. While the analysis may be sufficiently powered to evaluate the primary hypothesis of the study/experiment, interesting follow-up scientific questions (often more nuanced), come up during the course of the project. These tasks may be underpowered for the sample sizes available. This necessitates efforts to identify similar datasets elsewhere so that the combined sample size of the “pooled” dataset is enough to determine significant associations between a response and a set of predictors, e.g., within linear regression.\nMotivating Application. In genomics, funding agencies have invested effort into standardizing/curating data collection across large international projects (ENCODE Project Consortium, 2004). In other disciplines, such as in the study of neurological disorders, heterogeneity in disease etiology, variations in scanners and/or acquisition tools make standardization more difficult. For Alzheimer’s disease (AD), a motivation of this work, efforts such as ADNI (Weiner et al., 2015) provide a variety of clinical, imaging and cognitive tests data for 800+ older adults. However, the research focus has now moved to the early stages of disease – as early as late middle age – where treatments are expected to be more effective. But (a) the statistical signal at this stage is weak and difficult to demonstrate without large sample sizes and (b) such “preclinical” participants are not well represented, even in large ADNI sized studies. Hence, there is a concerted effort in general for smaller standalone projects (focused on a specific disease stage), that can be retrospectively pooled for analysis towards addressing a challenging scientific hypothesis (Jahanshad et al., 2013). Unfortunately, acquisition protocols for various measures across sites are usually different and data are heterogeneous. These issues raise a fundamental technical question. When is it meaningful to pool datasets for estimating a simple statistical model (e.g., linear regression)? When can we guarantee improvements in statistical power, and when are such pooling efforts not worth it? Can we give a hypothesis test and obtain p-values to inform our policies/decisions? While related problems have been stud-\nied in machine learning from an algorithm design perspective, even simple hypothesis tests which can be deployed by a researcher in practice, are currently unavailable. Our goal is to remove this significant limitation.\nPutting our development in context. The realization that “similar” datasets from multiple sites can be pooled to potentially improve statistical power is not new. With varying empirical success, models tailored to perform regression in multi-site studies (Group, 2002), (Haase et al., 2009), (Klunk et al., 2015) have been proposed, where due to operational reasons, recruitment and data acquisition are distributed over multiple sites, or even countries. When the pooling is being performed retrospectively (i.e., after the data has been collected), resolving site-specific confounds, such as distributional shifts or biases in measurements, is essential before estimation/inference of a statistical model. We will not develop new algorithms for estimating the distributional mismatch or for performing multi-site regression — rather, our primary goal is to identify the regimes (and give easily computable checks) where this regression task on a pooled dataset is statistically meaningful, assuming that good pre-processing schemes are available. We will present a rigorous yet simple to implement hypothesis test, analyze its behavior, and show extensive experimental evidence (for an important scientific problem). The practitioner is free to use his/her preferred procedure for the “before step” (estimating the distributional shifts).\nContributions: a) Our main result is a hypothesis test to evaluate whether pooling data across multiple sites for regression (before or after correcting for site-specific distributional shifts) can improve the estimation (mean squared error) of the relevant coefficients (while permitting an influence from a set of confounding variables). b) We derive analogous results in the high-dimensional setting by leveraging a different set of analysis techniques. Using an existing sparse multi-task Lasso model, we show how the utility of pooling can be evaluated even when the support set of the features (predictors) is not exactly the same across sites using ideas broadly related to high dimensional simultaneous inference (Dezeure et al., 2015). We show `2-consistency rate, which supports the use of sparse multitask Lasso when sparsity patterns are not totally identical. c) On an important scientific problem of analyzing early Alzheimer’s disease (AD) individuals, we provide compelling experimental results showing consistent acceptance rate and statistical power. Via a publicly available software package, this will facilitate many multi-site regression analysis efforts in the short to medium term future."
  }, {
    "heading": "1.1. Related Work",
    "text": "Meta-analysis approaches. If datasets at multiple different sites cannot be shared or pooled, the task of deriving\nmeaningful scientific conclusions from results of multiple independently conducted analyses generally falls under the umbrella term of “meta analysis”. The literature provides various strategies to cumulate the general findings from analyses on different datasets. But even experts believe that, minor violations of assumptions can lead to misleading scientific conclusions (Greco et al., 2013), and substantial personal judgment (and expertise) is needed to conduct them. It is widely accepted that when the ability to pool the data is an option, simpler schemes may perform better.\nDomain adaptation/shift. Separately, the idea of addressing “shift” within datasets has been rigorously studied within statistical machine learning, see (Patel et al., 2015; Li, 2012). For example, domain adaptation, including dataset and covariate shift, seeks to align (the distributions of) multiple datasets to enable follow-up processing (Ben-David & Schuller, 2003). Typically, such algorithms assume a bias in the sampling process, and adopt reweighting as the solution (Huang et al., 2007; Gong et al., 2013). Alternatively, a family of such methods assume that sites (or datasets) differ due to feature distortions (e.g., calibration error), which are resolved, in general, by minimizing some distance measure between appropriate distributions (Baktashmotlagh et al., 2013; Pan et al., 2011; Long et al., 2015; Ganin et al., 2016). In general, these approaches have nice theoretical properties (Ben-David et al., 2010; Cortes & Mohri, 2011; Zhou et al., 2016). However, it is important to note that the domain adaptation literature focuses on the algorithm itself – to resolve the distributional site-wise differences. It does not address the issue of whether pooling the datasets, after applying the calculated adaptation (i.e., transformation), is beneficial. Our goal in this work is to assess whether multiple datasets can be pooled — either before or usually after applying the best domain adaptation methods — for improving our estimation of the relevant coefficients within linear regression. We propose a hypothesis test to directly address this question.\nThe high-dimensional case. High dimensional scenarios, in general, involve predicting a response (e.g., cognitive score) from high dimensional predictors such as image scans (or derived features) and genetic data, which in general, entails Lasso-type formulations unlike the classical regression models. Putting multi-task representation learning (Maurer et al., 2016; Ando & Zhang, 2005; Maurer et al., 2013) together with a sparsity regularizer, we get the multitask Lasso model (Liu et al., 2009; Kim & Xing, 2010). Although this seems like a suitable model (Chen et al., 2012), it assumes that the multiple tasks (sites here) have an identical active set of predictors. Instead, we find that the sparse multi-task Lasso (Lee et al., 2010), roughly, a multitask version of sparse group Lasso (Simon et al., 2013; Lee et al., 2010) is a better starting point. There is no theoretical analysis in (Simon et al., 2013); although a `2-consistency\nfor sparse group lasso is derived in (Chatterjee et al., 2012) using a general proof procedure for M-estimators, it does not take into account the specific sparse group Lasso properties. This makes the result non-informative for sparse group Lasso (much less, sparse multi-task Lasso). Specifically, as we will see shortly, in sparse multi-task Lasso, the joint effects of two penalties induces a special type of asymmetric structure. We show a new result, in the style of Lasso (Meinshausen & Yu, 2009; Liu & Zhang, 2009b), for `2 convergence rate for this model. It matches known results for Lasso/group Lasso, and identifies regimes where the sparse multi-task (multi-site) setting is advantageous.\nSimultaneous High dimensional Inference. Simultaneous high dimensional inference models such as multi sample-splitting and de-biased Lasso is an active research topic in statistics (Dezeure et al., 2015). Multi samplesplitting use half of the dataset for variable selection and the rest for calculating p-values. De-biased Lasso chooses one feature as a response and the others as predictors to estimate a Lasso model; this procedure is repeated for each feature. Estimators from De-biased Lasso asymptotically follow the multi-normal distribution (Dezeure et al., 2016), and using Bonferroni-Holm adjustment produces simultaneous p-values. Such ideas together with the `2- convergence results for sparse multitask Lasso, will help extend our analysis to the high dimensional setting."
  }, {
    "heading": "2. Hypothesis Test for Multi-Site Regression",
    "text": "We first describe a simple setting where one seeks to apply standard linear regression to data pooled from multiple sites. For presentation purposes, we will deal with variable selection issues later. Within this setup, we will introduce our main result — a hypothesis test to evaluate statistical power improvements (e.g., mean squared error) when running a regression model on a pooled dataset. We will see that the proposed test is transparent to the use of adaptation algorithms, if any, to pre-process the multi-site data (more details in appendix). In later sections, we will present convergence analysis and extensions to the large p setting. Matrices (vectors/scalars) are upper case (and lower case). ‖.‖∗ is the nuclear norm.\nWe first introduce the single-site regression model. Let X ∈ Rn×p and y ∈ Rn×1 denote the feature matrix of predictors and the response vector respectively. If β corresponds to the coefficient vector (i.e., predictor weights), then the regression model is\nmin β\n1 n ‖y −Xβ‖22 (1)\nwhere y = Xβ∗ + and ∼ N(0, σ2) I.I.D. if β∗ is the true coefficient vector from which y is generated. The mean-squared error (MSE) and `2-consistency of regres-\nsion is well-known. The mean-squared error (MSE) of (1) is E‖β̂ − β∗‖22 = tr ( (XTX)−1 ) σ2. If k denotes the number of sites, then one may first apply a domain adaptation scheme to account for the distributional shifts between the k different predictors {Xi}ki=1, and then run a regression model. If the underlying “concept” (i.e., predictors and responses relationship) can be assumed to be the same across the different sites, then it is reasonable to impose the same β for all sites. For instance, the influence of CSF protein measurements on cognitive scores of an individual may be invariant to demographics. Nonetheless, if the distributional mismatch correction is imperfect, we may define ∆βi = βi − β∗ where i ∈ {1, . . . , k} as the residual difference between the site-specific coefficients and the true shared coefficient vector (in the ideal case, we have ∆βi = 0). In the multi-site setting, we can write\nmin β k∑ i=1 τ2i ‖yi −Xiβ‖22 (2)\nwhere for each site i we have yi = Xiβ∗+Xi∆βi+ i and i ∼ N (0, σ2i ) I.I.D. Here, τi is a weighting parameter for each site, if such information is available.\nOur main goal is to test if the combined regression improves the estimation for a single site. We can pose this question in terms of improvements in the mean squared error (MSE). Hence, W.L.O.G. using site 1 as the reference, we set τ1 = 1 in (2) and consider β∗ = β1,\nmin β ‖y1 −X1β‖22 + k∑ i=2 τ2i ‖yi −Xiβ‖22 (3)\nβ1 β2\nβ̂\nFigure 1. β1 and β2 are 1st and 2nd site coefficients. After combination, β1’s bias increases but variance reduces, resulting in a smaller MSE.\nClearly, when the sample size is not large enough, the multi-site formulation in (3) may reduce variance significantly, because of the averaging effect in the objective function, while increasing the bias by a little. This reduces the Mean Squared Error (MSE), see Figure 1. Note that while traditionally, the unbiasedness property was desirable, an extensive body of literature on ridge regression suggests that the quantity of interest should really be E ‖β̂ −\nβ∗‖22 (Hoerl & Kennard, 1970; James & Stein, 1961). These ideas are nicely studied within papers devoted to the “bias-variance” trade-off. Similar to these results, we will focus on the mean squared error because the asymptotic consistency properties that come with an unbiased estimator are not meaningful here anyway — the key reason we want to pool datasets in the first place is because of small sample sizes. We now provide a result showing how the tuning parameters τ2, . . . , τk can be chosen.\nTheorem 2.1 τi = σ1σi achieves the smallest variance in β̂.\nRemarks: This result follows from observing that the each site’s contribution is inversely proportional to site-specific noise level, σi. We will show that this choice of τis also leads to a simple mechanism to setup a hypothesis test."
  }, {
    "heading": "2.1. Sharing all βs",
    "text": "In the specification above, the estimates of βi across all k sites are restricted to be the same. Without this constraint, (3) is equivalent to fitting a regression separately on each site. So, a natural question is whether this constraint improves estimation. To evaluate whether MSE is reduced, we first need to quantify the change in the bias and variance of (3) compared to (1). To do so, we introduce a few notations. Let ni be the sample size of site i, and let β̂i denote the regression estimate from a specific site i. We have ∆β̂i = β̂i − β̂1. We define the length kp vector ∆βT as ∆βT = (∆βT2 , ...,∆β T k ) (similarly for ∆β̂\nT ). We use Σ̂i for the sample covariance matrix of the data (predictors) from the site i and G ∈ R(k−1)p×(k−1)p for the covariance matrix of ∆β̂, where Gii = (n1Σ̂1)−1 + (niτ2i Σ̂i)\n−1 and Gij = (n1Σ̂1) −1 whenever i 6= j.\nLet the difference in bias and variance between the single site model in (1) and the multi-site model in (3) be Biasβ and V arβ respectively. Let Σ̂k2 = ∑k i=2 niτ 2 i Σ̂i and Σ̂ k 1 = n1Σ̂1 + Σ̂ k 2 . We have,\nLemma 2.2 For model (3), we have\n‖Biasβ‖22 ‖G−1/2∆β‖22 ≤ ‖(Σ̂k1)−2(Σ̂k2(n1Σ̂1)−1Σ̂k2 + Σ̂k2)‖∗, (4)\nV arβ = σ 2 1 ∥∥∥(n1Σ̂1)−1 − (n1Σ̂1 + Σ̂k2)−1∥∥∥ ∗ . (5)\nRemarks: The above result bounds the increase in bias and the reduction in variance (see discussion of Figure 1). Since our goal is to test MSE reduction — in principle, we can use bootstrapping to calculate MSE approximately. This procedure has a significant computational footprint. Instead, (4) (from a one-step Cauchy-Schwartz inequality), gives a sufficient condition for MSE reduction as shown below.\nTheorem 2.3 a) Model (3) has smaller MSE of β̂ than model (1) whenever\nH0 : ‖G−1/2∆β‖22 ≤ σ21 . (6)\nb) Further, we have the following test statistic,∥∥∥∥∥G−1/2∆β̂σ1 ∥∥∥∥∥ 2\n2\n∼ χ2(k−1)∗p (∥∥∥∥G−1/2∆βσ1 ∥∥∥∥2 2 ) , (7)\nwhere ‖G−1/2∆β/σ1‖2 is called a “condition value”.\nRemarks: This is our main test result. Although σi is typically unknown, it can be easily replaced using its sitespecific estimation. Theorem 2.3 implies that we can conduct a non-central χ2 distribution test based on the statistic. Also, (6) shows that the non-central χ2 distribution, which the test statistics will follow, has a non-central parameter smaller than 1 when the sufficient condition H0 holds. Meanwhile, in obtaining the (surprisingly simple) sufficient condition H0, no other arbitrary assumption is needed except the application of Cauchy-Schwartz inequality. From a practical perspective, Theorem 2.3 implies that the sites, in fact, do not even need to share the full dataset to assess whether pooling will be useful. Instead, the test only requires very high-level information such as β̂i, Σ̂i, σi and ni for all participating sites – which can be transferred very cheaply with no additional cost of data storage, or privacy implications. The following result deals with the special case where we have two participating sites.\nCorollary 2.4 For the case where we have two participating sites, the condition (6) from Theorem 2.3 reduces to\nH0 : ∆β T ((n1Σ̂1) −1 + (n2τ 2 2 Σ̂2) −1)−1∆β ≤ σ21 . (8)\nRemarks: The left side above relates to the Mahalanobis distance between β1, β2 with covariance (n1Σ̂1)−1 + (n2τ 2 2 Σ̂2)\n−1, implying that the test statistic is a type of a normalized metric between the two regression models."
  }, {
    "heading": "2.2. Sharing a subset of βs",
    "text": "In numerous pooling scenarios, we are faced with certain systemic differences in the way predictors and responses associate across sites. For example, socio-economic status may (or may not) have a significant association with a health outcome (response) depending on the country of the study (e.g., due to insurance coverage policies). Unlike in Section 2.1, we now relax the restriction that all coefficients are the same across sites, see Fig. 2. The model in (3) will now include another design matrix of predictors Z ∈ Rn×q and corresponding coefficients γi for each site i,\nmin β,γ k∑ i=1 τ2i ‖yi −Xiβ − Ziγi‖22 (9)\nyi = Xiβ ∗ +Xi∆βi + Ziγ ∗ i + i, τ1 = 1 (10)\nOur goal is still to evaluate whether the MSE of β reduces. We do not take into account the MSE change in γ because they correspond to site-specific variables. For estimation, β̂ can first be computed from (9). Treating it as a fixed entity now, γ̂i can be computed using yi and Zi on each site independently. Clearly, if β̂ is close to the “true” β∗, it will also enable a better estimation of site-specific variables. It turns out that, if Σ̂is are replaced by the conditional covariance, the analysis from Section 2.1 still holds for this case.\nSpecifically, let Σ̂abi be the sample covariance matrix between features a and b from some site i. We have,\nTheorem 2.5 Analysis in Section 2.1 holds for β in (9) by replacing Σ̂i with Σ̃i = Σ̂xxi − Σ̂xzi(Σ̂zzi)−1Σ̂zxi\nRemarks: The test now allows evaluating power improvements focused only on the subset of coefficients that is shared and permits site-specific confounds. For example, we can test which subset of parameters might benefit from parameter estimation on pooled data from multiple sites."
  }, {
    "heading": "3. Pooling in High Dimensional Regression",
    "text": "We now describe our analysis of pooling multi-site data in the high-dimensional setting where p n. The challenge here is that variable section has to be a first order concern. In classical regression, `2 consistency properties are well known and so our focus in Section 2 was devoted to deriving sufficient conditions for the hypothesis test. In other words, imposing the same β across sites works in (3) because we understand its consistency. In contrast, here, one cannot enforce a shared β for all sites before the active set of predictors within each site are selected — directly imposing the same β leads to a loss of `2-consistency, making follow-up analysis problematic. Therefore, once a suitable model for high-dimensional multi-site regression is chosen, the first requirement is to characterize its consistency.\nWe start with the multi-task Lasso (a special case of group Lasso) (Liu et al., 2009), where the authors show that the strategy selects better explanatory features compared to separately fitting Lasso on each site. But this algorithm underperforms when the sparsity pattern of the predictors is not identical across sites, so we use a recent variant called sparse multi-task Lasso (Lee et al., 2010) – essentially substituting “sites” for “tasks”. The sparse multi-site Lasso in p n setting (p is the number of predictors) is given as\nB̂λ = arg min β k∑ i=1 ‖yi −Xiβi‖22 + λΛ(B) (11)\nΛ(B) = α p∑ j=1 ‖βj‖1 + (1− α) √ k p∑ j=1 ‖βj‖2, (12)\nwhere λ is the Lasso regularization parameter. Here, B ∈\nRk×p is a matrix where the ith row gives the coefficients from ith site (k sites in total). Also, βi with subscript denotes the ith row (site) of B, we use βj with superscript to give the j-th column (coefficients) of B. The hyperparameter α ∈ [0, 1] balances the two penalties (and will be used shortly); a larger α weighs the `1 penalty more and a smaller α puts more weight on the grouping. Similar to a Lasso-based regularization parameter, λ here will produce a solution path (to select coefficients) for a given α. We first address the consistency behavior of the sparse multisite Lasso in (11), which was not known in the literature."
  }, {
    "heading": "3.1. `2 consistency",
    "text": "Our analysis of (11) is related to known results for Lasso (Meinshausen & Yu, 2009) and the group Lasso (Liu & Zhang, 2009a). Recall that X1, . . . , Xk are the data matrices from k sites. We define n̄ = maxki=1{ni} and C = n̄−1DIAG(XT1 X1, ..., X T k Xk) where DIAG(A,B) corresponds to constructing a block-diagonal matrix with A and B as blocks on the diagonal. We require the following useful properties of C (‖·‖0 denotes `0-norm).\nDefinition 3.1 The m-sparse minimal and maximal eigenvalues of C, denoted by φmin(m) and φmax(m), are\nmin ν:‖ν‖0≤dme\nνTCν\nνT ν and max ν:‖ν‖0≤dme\nνTCν\nνT ν (13)\nWe call a feature “active” if its coefficient is non-zero. Now, each site may have different active features: let sh ≤ kp be the sum of the number of active features over all sites. Similarly, sp is the cardinality of the union of features that are active in at least one site (sh ≤ ksp, sp ≤ p). Recall that when α 6= 0, we add the Lasso penalty to the multi-site Lasso penalty. When the sparsity patterns are assumed to be similar across all sites, α is small. In contrast, to encourage site-specific sparsity patterns, we may set α to be large. We now analyze these cases independently.\nTheorem 3.2 Let 0 ≤ α ≤ 0.4. Assume there exist constants 0 ≤ ρmin ≤ ρmax ≤ ∞ such that\nlim inf n→∞ φmin\n( sp ( 1 + 2α\n1− 2α\n)2) ≥ ρmin\nlim sup n→∞ φmax(sp + min{ k∑ i=1 ni, kp}) ≤ ρmax.\n(14)\nThen, for λ ∝ σ √ n̄ log(kp), there exists a constant ω > 0\nsuch that, with probability converging to 1 for n→∞,\n1 k ‖B̂λ −B∗‖2F ≤ ωσ2 s̄ log(kp) n̄ , (15)\nwhere s̄ = {(1−α)√sp+α √ sh/k}2, σ is the noise level.\nRemarks: The above result agrees with known results for multi-task Lasso (Liu et al., 2009; Liu & Zhang, 2009b) when the sparsity patterns are the same across sites. The simplest way to interpret Theorem 3.2 is via the ratio r = sh sp\n. Here, r = k when the sparsity patterns are the same across sites. As r decreases, the sparsity patterns across sites start to differ, in turn, the sparse multi-site Lasso from (11) will provide stronger consistency compared to the multi-site Lasso (which corresponds to α = 0). In other words, whenever we expect site-specific active features, the `2 consistency of (11) will improve as one includes an additional `1-penalty together with multi-site Lasso.\nObserve that for the non-sparse βj , we can verify that ‖βj‖1 and √ k‖βj‖2 have the same scale. On the other hand, for sparse βj , ‖βj‖1 has the same scale as ‖βj‖2, i.e., with no √ k penalization (see appendix). Unlike Theorem 3.2 where the sparsity patterns across sites are similar, due to this scaling issue, the parameters α and λ need to be ‘corrected’ for the setting where sparsity patterns have little overlap. We denote these corrected versions by α̃ = α\n(1−α) √ k+α\nand λ̃ = ((1− α) √ k + α)λ.\nTheorem 3.3 Let 0.4 ≤ α̃ ≤ 1. Assume there exist constants 0 ≤ ρmin ≤ ρmax ≤ ∞ such that\nlim inf n→∞ φmin\n( sh ( 1 +\n(1− α̃) α̃\n)2) ≥ ρmin\nlim sup n→∞ φmax(sh + min{ k∑ i=1 ni, kp}) ≤ ρmax.\n(16)\nThen, for λ̃ ∝ σ √ n̄ log(kp), there exists ω > 0 such that,\nwith probability converging to 1 for n → ∞, we have (15) with s̃ = {(1− α̃) √ sp/k + α̃ √ sh/k}2 instead of s̄.\nRemarks: This result agrees with known results for Lasso (Meinshausen & Yu, 2009) when the sparsity patterns are completely different across sites. In this case (i.e., α is large), the sparse multi-site Lasso has stronger consistency compared to Lasso (α = 1). The sparse multi-site Lasso is preferable as r = shsp increases. Note that although α̃ and λ̃ are used for the results instead of α and λ, in practice, one can simply scale the chosen αs appropriately, e.g., with k = 100, we see that α ≈ 0.99 corresponds to α̃ = 0.95.\nPerforming hypothesis tests: Theorems 3.2 and 3.3 show consistency of sparse multi-site Lasso estimation. Hence, if the hyper-parameters α and λ are known, we can estimate the coefficients B∗. This variable selection phase can be followed by a hypothesis test, similar to Theorem 2.3 from Section 2. The only remaining issue is the choice of α. The existing methods show that joint crossvalidation for α and λ performs unsatisfactorily and instead use a heuristic: set it to 0.05 when it is known that sparsity\npatterns are similar across sites and 0.95 otherwise (Simon et al., 2013). Below, instead of a fixed α, we provide a data-driven alternative that works well in practice.\nChoosing α using simultaneous inference: Our results in Thm. 3.2 (and Thm. 3.3 resp.) seem to suggest that increasing (and decreasing resp.) α will always improve consistency; however, this ends up requiring stronger msparsity conditions. We now describe a procedure to choose α. First, recall that an active feature corresponds to a variable with non-zero coefficient. We call a feature “siteactive” if it is active at a site, an “always-active” feature is active at all k sites. The proposed solution involves three steps. (1) First, we apply simultaneous inference (like multi sample-splitting or de-biased Lasso) using all features at each of the k sites with FWER control. This step yields “site-active” features for each site, and therefore, gives the set of always-active features and the sparsity patterns. (2) Then, each site runs a Lasso and chooses a λi based on cross-validation. We then set λmulti−site to be the minimum among the best λ’s from each site. Using λmulti−site, we can vary α to fit various sparse multi-site Lasso models – each run will select some number of always-active features. We plot α versus the number of always-active features. (3) Finally, based on the sparsity patterns from the site-active set, we estimate whether the sparsity patterns across sites are similar or different (i.e., share few active features). Then, based on the plot from step (2), if the sparsity patterns from the site-active sets are different (similar) across sites, then the smallest (largest) value of α that selects the minimum (maximum) number of always-active features is chosen. The appendix includes details."
  }, {
    "heading": "4. Experiments",
    "text": "Our experiments are two-fold. First we perform simulations evaluating the hypothesis test from §2 and sparse multi-site Lasso from §3. We then evaluate pooling two Alzheimer’s disease (AD) datasets from different studies to evaluate improvements in power, and checking whether the proposed tests provide insights into the regimes when pooling is beneficial for regression, and will yield tangible statistical benefits in investigating scientific hypotheses.\nPower and Type I Error of Theorem 2.3: The first set of simulations evaluate the setting from Section 2.1 where the coefficients are same across two different sites. The inputs for the two sites are set as X1, X2(∈ Rn×3) ∼ N (0,Σ) with Σ = 0.5(I + E) (where I is identity and E is a 3 × 3 matrix of 1s). The true coefficients are given by β1 ∼ U(0, 4I) and β2 = β1+0.1 (where U(·) is multivariate uniform), and the noise corresponds to 1 ∼ N (0, 3I) and 2 ∼ N (0, 0.5I) for the two sites respectively. With this design, the responses are set as y1 = X1β1 + 1 and y2 = X2β2 + 2. Using {X1, y1} and {X2, y2}, the shared\nβ̂ are estimated. The simulation is repeated 100 times with 9 different sample sizes (n = 2b with b = 4, . . . , 12) for each repetition. Fig. 3(a) shows the MSE of two-site (blue bars) and a baseline single-site (red bars) model computed using the corresponding β̂s on site 1. Although both MSEs decrease as n increases, the two-sites model consistently produces smaller MSE – with large gains for small sample sizes (left-end of Fig. 3(a)). Fig. 3(d) shows the acceptance rates of our proposed hypothesis test (from (6) and (8)) with 0.05 significance level. The purple solid line is the sufficient condition from Theorem 2.3, while the dotted line is where the MSE of the baseline single-site model starts to decrease below that of the two-site model. The trend in Fig. 3(d) implies that as n increases, the test tends to reject pooling the multi-site data with power→ 1. Further, the type I error is well-controlled to the left of the solid line, and is low between the two lines. See appendix for additional details about Figs. 3(a,d).\nPower and Type I Error of Theorem 2.5: The second set of simulations evaluate the confounding variables setup from Section 2.2. Similar to Section 4, here we have (X1, Z1), (X2, Z2) ∼ N (0,Σ) with Σ =(\n0.5I3×3 + 0.5E3×3, 0.2E3×5 0.2E5×3, 0.8I5×5 + 0.2E5×5\n) . β1 and\nβ2 are the same as before. γ1 = (1, 1, 2, 2, 2)T and γ2 = (2, 2, 2, 1, 1)\nT are the coefficients for Z1 and Z2 respectively. The new responses y1 and y2 will have the extra terms Z1γ1 and Z2γ2 respectively. Fig. 3(b,e) shows the results. All the observations from Fig. 3(a,d) hold here as well. For small n, MSE of two-site model is much smaller than baseline, and as sample size increases this difference reduces. The test accepts with high probability for small n, and as sample size increases it rejects with high power. The regimes of low type I error and high power in Fig. 3(e) are similar to those from Fig. 3(d).\n4.1. Sparse multi-sites Lasso `2-consistency\nWe now use 4 sites with n = 150 samples each and p = 400 features to test the sparse multi-site model from §3. We set the design matrices Xi (i = 1, . . . , 4) ∼ N (0,Σ) with Σ = 0.8Ip×p + 0.2Ep×p. We consider the two cases (sparsity patterns shared/not shared) separately.\nFew sparsity patterns shared: 6 shared features and 14 site-specific features (out of the 400) are set to be active in 4 sites. Each shared feature is sampled from U(0, 4) for the first two sites and U(0, 0.5) for the rest. All the sitespecific features are ∼ U(0, 4). The noise i ∼ N (0, 1), and the responses are yi = Xiβi + i. Fig. 3(c) shows the 10-fold cross validation error as λ changes (i.e., solution path) for different α settings, including the value from our proposed selection procedure (from Section 3.1), Lasso (α = 1), group Lasso (α = 0) and arbitrary values α = 0.05, 0.95 (as suggested by (Simon et al., 2013)).\nOur chosen α = 0.97 (the blue curve in Fig. 3(c)) has the smallest error, across all λs, thereby implying a better `2 consistency. Table 1 in the appendix includes more details, including α = 0.97 discovers more always-active features, while preserving the ratio of correctly discovered active features to all the discovered ones.\nMost sparsity patterns shared: Unlike the earlier case, here we set 16 shared and 4 site-specific features (both ∼ U(0, 4)) to be active among all 400 features. The result, shown in Fig. 3(f), is similar to Fig. 3(c). The proposed choice of α = 0.25 competes favorably with alternate choices while preserving the correctly discovered number of always-active features. Unlike the previous case, the ratio of correctly discovered active features to all discovered ones increases here (see appendix)."
  }, {
    "heading": "4.2. Combining AD datasets from multiple sites",
    "text": "We now evaluate whether two AD datasets acquired at different sites – an Alzheimer’s Disease Neuroimage Initiative (ADNI) dataset and a local dataset from Wisconsin ADRC (ADlocal) can be combined (appendix has dataset details). The sample sizes are 318 and 156 respectively. Cerebrospinal fluid (CSF) protein levels are the inputs, and the response is hippocampus volume. Using 81 age-matched samples from each dataset, we first perform domain adaptation (using a maximum mean discrepancy objective as a measure of distance between the two marginals), and then transform CSF proteins from ADlocal to match with ADNI. The transformed data is then used to evaluate whether adding ADlocal data to ADNI will improve the regression performed on the ADNI data. This is done by training a regression model on the ‘transformed’ ADlocal and a subset of ADNI data, and then testing the resulting model on the remaining ADNI samples. We use two baseline models each of which are trained using – ADNI data alone; and non-transformed ADlocal (with ADNI subset).\nFig. 4(a,b) show the resulting mean prediction error (MPE) scaled by the estimated noise level in ADNI responses, and the corresponding acceptance rate (with significance level 0.05) respectively. The x-axis in Fig. 4(a,b) represents the size of ADNI subset used for training. As expected, the MPE reduces as this subset size increases. Most importantly, pooling after transformation (green bars) seems to be the most beneficial in terms of MPE reduction. As shown in Fig. 4(a), to the left of purple line where the subset size is smaller than ADlocal datasize, pooling the datasets improves estimation. This is the small sample size regime which necessitates pooling efforts in general. As the dataset size increases (to the right of x-axis in Fig. 4(a)) the resulting MPE for the pooled model is close to what we will achieve using the ADNI data by itself.\nSince pooling after transformation is at least as good as us-\ning ADNI data alone, our hypothesis test accepts the combination with high rate (≈ 95%), see Fig. 4(b). The test rejects the pooling strategy with high power for combining before domain adaptation (see Fig. 4(b)), as one would expect. This rejection power increases rapidly as sample size increases, see red curve in Fig. 4(b). The results in Fig. 4(c,d) show the setting where one cannot change the dataset sizes at the sites i.e., the training set uses an equal number of labeled samples from both the ADNI and ADlocal (x-axis in Fig. 4(c)), and the testing set always corresponds to 20% of ADNI data. This is a more interesting scenario for a practitioner compared to Fig. 4(a,b), because in Fig. 4(c,d) we use same sample sizes for both datasets. The trends in Fig. 4(c,d) are the same as Fig. 4(a,b)."
  }, {
    "heading": "5. Conclusions",
    "text": "We present a hypothesis test to answer whether pooling multiple datasets acquired from different sites is guaran-\nteed to increase statistical power for regression models. For both standard and high dimensional linear regression, we identify regimes where such pooling is sensible, and show how such policy decisions can be made via simple checks executable on each site before any data transfer ever happens. We also show empirical results by combining two Alzheimer’s disease datasets in the context of different regimes proposed by our analysis, and see that the regression fit improves as suggested by the theory. The code is available at https://github.com/hzhoustat/ICML2017.\nAcknowledgments: This work is supported by NIH grants R01 AG040396, R01 EB022883, UW CPCP AI117924, R01 AG021155, and NSF awards DMS 1308877, CAREER 1252725 and CCF 1320755. The authors are grateful for partial support from UW ADRC AG033514, UW ICTR 1UL1RR025011 and funding from a UW-Madison/DZNE collaboration initiative."
  }],
  "year": 2017,
  "references": [{
    "title": "A framework for learning predictive structures from multiple tasks and unlabeled data",
    "authors": ["Ando", "Rie Kubota", "Zhang", "Tong"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2005
  }, {
    "title": "Unsupervised domain adaptation by domain invariant projection",
    "authors": ["Baktashmotlagh", "Mahsa", "Harandi", "Mehrtash T", "Lovell", "Brian C", "Salzmann", "Mathieu"],
    "venue": "In Proceedings of the IEEE International Conference on Computer Vision, pp",
    "year": 2013
  }, {
    "title": "Exploiting task relatedness for multiple task learning",
    "authors": ["Ben-David", "Shai", "Schuller", "Reba"],
    "venue": "In Learning Theory and Kernel Machines,",
    "year": 2003
  }, {
    "title": "A theory of learning from different domains",
    "authors": ["Ben-David", "Shai", "Blitzer", "John", "Crammer", "Koby", "Kulesza", "Alex", "Pereira", "Fernando", "Vaughan", "Jennifer Wortman"],
    "venue": "Machine learning,",
    "year": 2010
  }, {
    "title": "Sparse group lasso: Consistency and climate applications",
    "authors": ["Chatterjee", "Soumyadeep", "Steinhaeuser", "Karsten", "Banerjee", "Arindam", "Snigdhansu", "Ganguly", "Auroop"],
    "venue": "In Proceedings of the 2012 SIAM International Conference on Data Mining,",
    "year": 2012
  }, {
    "title": "Adaptive multi-task sparse learning with an application to fmri study",
    "authors": ["Chen", "Xi", "He", "Jinghui", "Lawrence", "Rick", "Carbonell", "Jaime G"],
    "venue": "In Proceedings of the 2012 SIAM International Conference on Data Mining,",
    "year": 2012
  }, {
    "title": "Domain adaptation in regression",
    "authors": ["Cortes", "Corinna", "Mohri", "Mehryar"],
    "venue": "In International Conference on Algorithmic Learning Theory,",
    "year": 2011
  }, {
    "title": "High-dimensional inference: Confidence intervals, p-values and r-software hdi",
    "authors": ["Dezeure", "Ruben", "Bühlmann", "Peter", "Meier", "Lukas", "Meinshausen", "Nicolai"],
    "venue": "Statistical Science,",
    "year": 2015
  }, {
    "title": "High-dimensional simultaneous inference with the bootstrap",
    "authors": ["Dezeure", "Ruben", "Bühlmann", "Peter", "Zhang", "Cun-Hui"],
    "venue": "arXiv preprint arXiv:1606.03940,",
    "year": 2016
  }, {
    "title": "Big science vs. little science: how scientific impact scales with funding",
    "authors": ["Fortin", "Jean-Michel", "Currie", "David J"],
    "venue": "PloS one,",
    "year": 2013
  }, {
    "title": "Domainadversarial training of neural networks",
    "authors": ["Ganin", "Yaroslav", "Ustinova", "Evgeniya", "Ajakan", "Hana", "Germain", "Pascal", "Larochelle", "Hugo", "Laviolette", "François", "Marchand", "Mario", "Lempitsky", "Victor"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2016
  }, {
    "title": "Meta-analysis: pitfalls and hints",
    "authors": ["T Greco", "A Zangrillo", "G Biondi-Zoccai", "G. Landoni"],
    "venue": "Heart Lung Vessel,",
    "year": 2013
  }, {
    "title": "Ridge regression: Biased estimation for nonorthogonal problems",
    "authors": ["Hoerl", "Arthur E", "Kennard", "Robert W"],
    "year": 1970
  }, {
    "title": "Correcting sample selection bias by unlabeled data",
    "authors": ["Huang", "Jiayuan", "Smola", "Alexander J", "Gretton", "Arthur", "Borgwardt", "Karsten M", "Schölkopf", "Bernhard"],
    "venue": "Advances in neural information processing systems,",
    "year": 2007
  }, {
    "title": "Estimation with quadratic loss",
    "authors": ["James", "William", "Stein", "Charles"],
    "venue": "In Proceedings of the fourth Berkeley symposium on mathematical statistics and probability,",
    "year": 1961
  }, {
    "title": "Tree-guided group lasso for multi-task regression with structured sparsity",
    "authors": ["Kim", "Seyoung", "Xing", "Eric P"],
    "year": 2010
  }, {
    "title": "Fy2015 by the numbers, and a quick look at recent trends. 2016",
    "authors": ["Lauer", "Mike"],
    "venue": "URL https://nexus.od.nih.gov/all/2016/",
    "year": 2015
  }, {
    "title": "Adaptive multi-task lasso: with application to eqtl detection",
    "authors": ["Lee", "Seunghak", "Zhu", "Jun", "Xing", "Eric P"],
    "venue": "In Advances in neural information processing systems,",
    "year": 2010
  }, {
    "title": "Literature survey: domain adaptation algorithms for natural language processing. Department of Computer Science The Graduate Center, The City",
    "authors": ["Li", "Qi"],
    "year": 2012
  }, {
    "title": "Estimation consistency of the group lasso and its applications",
    "authors": ["Liu", "Han", "Zhang", "Jian"],
    "venue": "In AISTATS,",
    "year": 2009
  }, {
    "title": "Estimation consistency of the group lasso and its applications",
    "authors": ["Liu", "Han", "Zhang", "Jian"],
    "venue": "In AISTATS,",
    "year": 2009
  }, {
    "title": "Blockwise coordinate descent procedures for the multi-task lasso, with applications to neural semantic basis discovery",
    "authors": ["Liu", "Han", "Palatucci", "Mark", "Zhang", "Jian"],
    "venue": "In Proceedings of the 26th Annual International Conference on Machine Learning,",
    "year": 2009
  }, {
    "title": "Learning transferable features with deep adaptation networks",
    "authors": ["Long", "Mingsheng", "Cao", "Yue", "Wang", "Jianmin", "Jordan", "Michael I"],
    "venue": "In ICML, pp",
    "year": 2015
  }, {
    "title": "The benefit of multitask representation learning",
    "authors": ["Maurer", "Andreas", "Pontil", "Massimiliano", "RomeraParedes", "Bernardino"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2016
  }, {
    "title": "Lasso-type recovery of sparse representations for high-dimensional data",
    "authors": ["Meinshausen", "Nicolai", "Yu", "Bin"],
    "venue": "The Annals of Statistics,",
    "year": 2009
  }, {
    "title": "The inevitable application of big data to health",
    "authors": ["Murdoch", "Travis B", "Detsky", "Allan S"],
    "venue": "care. Jama,",
    "year": 2013
  }, {
    "title": "Domain adaptation via transfer component analysis",
    "authors": ["Pan", "Sinno Jialin", "Tsang", "Ivor W", "Kwok", "James T", "Yang", "Qiang"],
    "venue": "IEEE Transactions on Neural Networks,",
    "year": 2011
  }, {
    "title": "Visual domain adaptation: A survey of recent advances",
    "authors": ["Patel", "Vishal M", "Gopalan", "Raghuraman", "Li", "Ruonan", "Chellappa", "Rama"],
    "venue": "IEEE signal processing magazine,",
    "year": 2015
  }, {
    "title": "A sparse-group lasso",
    "authors": ["Simon", "Noah", "Friedman", "Jerome", "Hastie", "Trevor", "Tibshirani", "Robert"],
    "venue": "Journal of Computational and Graphical Statistics,",
    "year": 2013
  }, {
    "title": "Machine learning and its applications to biology",
    "authors": ["Tarca", "Adi L", "Carey", "Vincent J", "Chen", "Xue-wen", "Romero", "Roberto", "Drăghici", "Sorin"],
    "venue": "PLoS Comput Biol,",
    "year": 2007
  }, {
    "title": "Impact of the alzheimer’s disease neuroimaging",
    "authors": ["Weiner", "Michael W", "Veitch", "Dallas P", "Aisen", "Paul S", "Beckett", "Laurel A", "Cairns", "Nigel J", "Cedarbaum", "Jesse", "Donohue", "Michael C", "Green", "Robert C", "Harvey", "Danielle", "Jack", "Clifford R"],
    "year": 2004
  }, {
    "title": "Hypothesis testing in unsupervised domain adaptation with applications in alzheimer’s disease",
    "authors": ["Zhou", "Hao H", "Ravi", "Sathya N", "Ithapu", "Vamsi K", "Johnson", "Sterling C", "Wahba", "Grace", "Singh", "Vikas"],
    "venue": "In Advances in Neural Information Processing Systems,",
    "year": 2016
  }],
  "id": "SP:b040496ae4e418585624f1d11e45fed0ac3d1824",
  "authors": [{
    "name": "Hao Henry Zhou",
    "affiliations": []
  }, {
    "name": "Yilin Zhang",
    "affiliations": []
  }, {
    "name": "Vamsi K. Ithapu",
    "affiliations": []
  }, {
    "name": "Sterling C. Johnson",
    "affiliations": []
  }, {
    "name": "Grace Wahba",
    "affiliations": []
  }, {
    "name": "Vikas Singh",
    "affiliations": []
  }],
  "abstractText": "Many studies in biomedical and health sciences involve small sample sizes due to logistic or financial constraints. Often, identifying weak (but scientifically interesting) associations between a set of predictors and a response necessitates pooling datasets from multiple diverse labs or groups. While there is a rich literature in statistical machine learning to address distributional shifts and inference in multi-site datasets, it is less clear when such pooling is guaranteed to help (and when it does not) – independent of the inference algorithms we use. In this paper, we present a hypothesis test to answer this question, both for classical and high dimensional linear regression. We precisely identify regimes where pooling datasets across multiple sites is sensible, and how such policy decisions can be made via simple checks executable on each site before any data transfer ever happens. With a focus on Alzheimer’s disease studies, we present empirical results showing that in regimes suggested by our analysis, pooling a local dataset with data from an international study improves power.",
  "title": "When can Multi-Site Datasets be Pooled for Regression? Hypothesis Tests, 2-consistency and Neuroscience Applications"
}