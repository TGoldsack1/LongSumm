{
  "sections": [{
    "text": "Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Long Papers), pages 1098–1107 Melbourne, Australia, July 15 - 20, 2018. c©2018 Association for Computational Linguistics\n1098"
  }, {
    "heading": "1 Introduction",
    "text": "Classic dialog systems rely on developing a meaning representation to represent the utterances from both the machine and human users (Larsson and Traum, 2000; Bohus et al., 2007). The dialog manager of a conventional dialog system outputs the system’s next action in a semantic frame that usually contains hand-crafted dialog acts and slot values (Williams and Young, 2007). Then a natural language generation module is used to generate the system’s output in natural language based on the given semantic frame. This approach suffers from generalization to more complex domains because it soon become intractable to man-\n1Data and code are available at https://github. com/snakeztc/NeuralDialog-LAED.\nually design a frame representation that covers all of the fine-grained system actions. The recently developed neural dialog system is one of the most prominent frameworks for developing dialog agents in complex domains. The basic model is based on encoder-decoder networks (Cho et al., 2014) and can learn to generate system responses without the need for hand-crafted meaning representations and other annotations.\nAlthough generative dialog models have advanced rapidly (Serban et al., 2016; Li et al., 2016; Zhao et al., 2017), they cannot provide interpretable system actions as in the conventional dialog systems. This inability limits the effectiveness of generative dialog models in several ways. First, having interpretable system actions enables human to understand the behavior of a dialog system and better interpret the system intentions. Also, modeling the high-level decision-making policy in dialogs enables useful generalization and dataefficient domain adaptation (Gašić et al., 2010). Therefore, the motivation of this paper is to develop an unsupervised neural recognition model that can discover interpretable meaning representations of utterances (denoted as latent actions) as a set of discrete latent variables from a large unlabelled corpus as shown in Figure 1. The discovered meaning representations will then be integrated with encoder decoder networks to achieve interpretable dialog generation while preserving\nall the merit of neural dialog systems. We focus on learning discrete latent representations instead of dense continuous ones because discrete variables are easier to interpret (van den Oord et al., 2017) and can naturally correspond to categories in natural languages, e.g. topics, dialog acts and etc. Despite the difficulty of learning discrete latent variables in neural networks, the recently proposed Gumbel-Softmax offers a reliable way to back-propagate through discrete variables (Maddison et al., 2016; Jang et al., 2016). However, we found a simple combination of sentence variational autoencoders (VAEs) (Bowman et al., 2015) and Gumbel-Softmax fails to learn meaningful discrete representations. We then highlight the anti-information limitation of the evidence lowerbound objective (ELBO) in VAEs and improve it by proposing Discrete Information VAE (DI-VAE) that maximizes the mutual information between data and latent actions. We further enrich the learning signals beyond auto encoding by extending Skip Thought (Kiros et al., 2015) to Discrete Information Variational Skip Thought (DI-VST) that learns sentence-level distributional semantics. Finally, an integration mechanism is presented that combines the learned latent actions with encoder decoder models.\nThe proposed systems are tested on several realworld dialog datasets. Experiments show that the proposed methods significantly outperform the standard VAEs and can discover meaningful latent actions from these datasets. Also, experiments confirm the effectiveness of the proposed integration mechanism and show that the learned latent actions can control the sentence-level attributes of the generated responses and provide humaninterpretable meaning representations."
  }, {
    "heading": "2 Related Work",
    "text": "Our work is closely related to research in latent variable dialog models. The majority of models are based on Conditional Variational Autoencoders (CVAEs) (Serban et al., 2016; Cao and Clark, 2017) with continuous latent variables to better model the response distribution and encourage diverse responses. Zhao et al., (2017) further introduced dialog acts to guide the learning of the CVAEs. Discrete latent variables have also been used for task-oriented dialog systems (Wen et al., 2017), where the latent space is used to represent intention. The second line of related work\nis enriching the dialog context encoder with more fine-grained information than the dialog history. Li et al., (2016) captured speakers’ characteristics by encoding background information and speaking style into the distributed embeddings. Xing et al., (2016) maintain topic encoding based on Latent Dirichlet Allocation (LDA) (Blei et al., 2003) of the conversation to encourage the model to output more topic coherent responses.\nThe proposed method also relates to sentence representation learning using neural networks. Most work learns continuous distributed representations of sentences from various learning signals (Hill et al., 2016), e.g. the Skip Thought learns representations by predicting the previous and next sentences (Kiros et al., 2015). Another area of work focused on learning regularized continuous sentence representation, which enables sentence generation by sampling the latent space (Bowman et al., 2015; Kim et al., 2017). There is less work on discrete sentence representations due to the difficulty of passing gradients through discrete outputs. The recently developed Gumbel Softmax (Jang et al., 2016; Maddison et al., 2016) and vector quantization (van den Oord et al., 2017) enable us to train discrete variables. Notably, discrete variable models have been proposed to discover document topics (Miao et al., 2016) and semi-supervised sequence transaction (Zhou and Neubig, 2017)\nOur work differs from these as follows: (1) we focus on learning interpretable variables; in prior research the semantics of latent variables are mostly ignored in the dialog generation setting. (2) we improve the learning objective for discrete VAEs and overcome the well-known posterior collapsing issue (Bowman et al., 2015; Chen et al., 2016). (3) we focus on unsupervised learning of salient features in dialog responses instead of hand-crafted features."
  }, {
    "heading": "3 Proposed Methods",
    "text": "Our formulation contains three random variables: the dialog context c, the response x and the latent action z. The context often contains the discourse history in the format of a list of utterances. The response is an utterance that contains a list of word tokens. The latent action is a set of discrete variables that define high-level attributes of x. Before introducing the proposed framework, we first identify two key properties that are essential in or-\nder for z to be interpretable:\n1. z should capture salient sentence-level features about the response x.\n2. The meaning of latent symbols z should be independent of the context c.\nThe first property is self-evident. The second can be explained: assume z contains a single discrete variable with K classes. Since the context c can be any dialog history, if the meaning of each class changes given a different context, then it is difficult to extract an intuitive interpretation by only looking at all responses with class k ∈ [1,K]. Therefore, the second property looks for latent actions that have context-independent semantics so that each assignment of z conveys the same meaning in all dialog contexts.\nWith the above definition of interpretable latent actions, we first introduce a recognition network R : qR(z|x) and a generation network G. The role of R is to map an sentence to the latent variable z and the generator G defines the learning signals that will be used to train z’s representation. Notably, our recognition network R does not depend on the context c as has been the case in prior work (Serban et al., 2016). The motivation of this design is to encourage z to capture context-independent semantics, which are further elaborated in Section 3.4. With the z learned by R and G, we then introduce an encoder decoder network F : pF(x|z, c) and and a policy network π : pπ(z|c). At test time, given a context c, the policy network and encoder decoder will work together to generate the next response via x̃ = pF(x|z ∼ pπ(z|c), c). In short, R, G, F and π are the four components that comprise our proposed framework. The next section will first focus on developing R and G for learning interpretable z and then will move on to integrating R with F and π in Section 3.3."
  }, {
    "heading": "3.1 Learning Sentence Representations from Auto-Encoding",
    "text": "Our baseline model is a sentence VAE with discrete latent space. We use an RNN as the recognition network to encode the response x. Its last hidden state hR|x| is used to represent x. We define z to be a set of K-way categorical variables z = {z1...zm...zM}, where M is the number of variables. For each zm, its posterior distribution is defined as qR(zm|x) = Softmax(WqhR|x| + bq).\nDuring training, we use the Gumbel-Softmax trick to sample from this distribution and obtain lowvariance gradients. To map the latent samples to the initial state of the decoder RNN, we define {e1...em...eM} where em ∈ RK×D and D is the generator cell size. Thus the initial state of the generator is: hG0 = ∑M m=1 em(zm). Finally, the generator RNN is used to reconstruct the response given hG0 . VAEs is trained to maxmimize the evidence lowerbound objective (ELBO) (Kingma and Welling, 2013). For simplicity, later discussion drops the subscript m in zm and assumes a single latent z. Since each zm is independent, we can easily extend the results below to multiple variables."
  }, {
    "heading": "3.1.1 Anti-Information Limitation of ELBO",
    "text": "It is well-known that sentence VAEs are hard to train because of the posterior collapse issue. Many empirical solutions have been proposed: weakening the decoder, adding auxiliary loss etc. (Bowman et al., 2015; Chen et al., 2016; Zhao et al., 2017). We argue that the posterior collapse issue lies in ELBO and we offer a novel decomposition to understand its behavior. First, instead of writing ELBO for a single data point, we write it as an expectation over a dataset:\nLVAE = Ex[EqR(z|x)[log pG(x|z)] − KL(qR(z|x)‖p(z))]\n(1)\nWe can expand the KL term as Eq. 2 (derivations in Appendix A.1) and rewrite ELBO as:\nEx[KL(qR(z|x)‖p(z))] = (2) I(Z,X)+KL(q(z)‖p(z))\nLVAE =Eq(z|x)p(x)[log p(x|z)] − I(Z,X)− KL(q(z)‖p(z)) (3)\nwhere q(z) = Ex[qR(z|x)] and I(Z,X) is the mutual information between Z and X . This expansion shows that the KL term in ELBO is trying to reduce the mutual information between latent variables and the input data, which explains why VAEs often ignore the latent variable, especially when equipped with powerful decoders."
  }, {
    "heading": "3.1.2 VAE with Information Maximization and Batch Prior Regularization",
    "text": "A natural solution to correct the anti-information issue in Eq. 3 is to maximize both the data likeli-\nhood lowerbound and the mutual information between z and the input data:\nLVAE + I(Z,X) = EqR(z|x)p(x)[log pG(x|z)]− KL(q(z)‖p(z)) (4)\nTherefore, jointly optimizing ELBO and mutual information simply cancels out the informationdiscouraging term. Also, we can still sample from the prior distribution for generation because of KL(q(z)‖p(z)). Eq. 4 is similar to the objectives used in adversarial autoencoders (Makhzani et al., 2015; Kim et al., 2017). Our derivation provides a theoretical justification to their superior performance. Notably, Eq. 4 arrives at the same loss function proposed in infoVAE (Zhao S et al., 2017). However, our derivation is different, offering a new way to understand ELBO behavior.\nThe remaining challenge is how to minimize KL(q(z)‖p(z)), since q(z) is an expectation over q(z|x). When z is continuous, prior work has used adversarial training (Makhzani et al., 2015; Kim et al., 2017) or Maximum Mean Discrepancy (MMD) (Zhao S et al., 2017) to regularize q(z). It turns out that minimizing KL(q(z)‖p(z)) for discrete z is much simpler than its continuous counterparts. Let xn be a sample from a batch of N data points. Then we have:\nq(z) ≈ 1 N N∑ n=1 q(z|xn) = q′(z) (5)\nwhere q′(z) is a mixture of softmax from the posteriors q(z|xn) of each xn. We can approximate KL(q(z)‖p(z)) by:\nKL(q′(z)‖p(z)) = K∑ k=1 q′(z = k) log q′(z = k) p(z = k)\n(6)\nWe refer to Eq. 6 as Batch Prior Regularization (BPR). When N approaches infinity, q′(z) approaches the true marginal distribution of q(z). In practice, we only need to use the data from each mini-batch assuming that the mini batches are randomized. Last, BPR is fundamentally different from multiplying a coefficient < 1 to anneal the KL term in VAE (Bowman et al., 2015). This is because BPR is a non-linear operation log sum exp. For later discussion, we denote our discrete infoVAE with BPR as DI-VAE."
  }, {
    "heading": "3.2 Learning Sentence Representations from the Context",
    "text": "DI-VAE infers sentence representations by reconstruction of the input sentence. Past research in distributional semantics has suggested the meaning of language can be inferred from the adjacent context (Harris, 1954; Hill et al., 2016). The distributional hypothesis is especially applicable to dialog since the utterance meaning is highly contextual. For example, the dialog act is a wellknown utterance feature and depends on dialog state (Austin, 1975; Stolcke et al., 2000). Thus, we introduce a second type of latent action based on sentence-level distributional semantics.\nSkip thought (ST) is a powerful sentence representation that captures contextual information (Kiros et al., 2015). ST uses an RNN to encode a sentence, and then uses the resulting sentence representation to predict the previous and next sentences. Inspired by ST’s robust performance across multiple tasks (Hill et al., 2016), we adapt our DI-VAE to Discrete Information Variational Skip Thought (DI-VST) to learn discrete latent actions that model distributional semantics of sentences. We use the same recognition network from DI-VAE to output z’s posterior distribution qR(z|x). Given the samples from qR(z|x), two RNN generators are used to predict the previous sentence xp and the next sentences xn. Finally, the learning objective is to maximize:\nLDI-VST = EqR(z|x)p(x))[log(p n G(xn|z)p p G(xp|z))]\n− KL(q(z)‖p(z)) (7)"
  }, {
    "heading": "3.3 Integration with Encoder Decoders",
    "text": "We now describe how to integrate a given qR(z|x) with an encoder decoder and a policy network. Let the dialog context c be a sequence of utterances. Then a dialog context encoder network can encode the dialog context into a distributed representation he = Fe(c). The decoder Fd can generate the responses x̃ = Fd(he, z) using samples from qR(z|x). Meanwhile, we train π to predict the aggregated posterior Ep(x|c)[qR(z|x)] from c via maximum likelihood training. This model is referred as Latent Action Encoder Decoder (LAED) with the following objective.\nLLAED(θF , θπ) = EqR(z|x)p(x,c)[logpπ(z|c) + log pF(x|z, c)] (8)\nAlso simply augmenting the inputs of the decoders with latent action does not guarantee that the generated response exhibits the attributes of the give action. Thus we use the controllable text generation framework (Hu et al., 2017) by introducing LAttr, which reuses the same recognition network qR(z|x) as a fixed discriminator to penalize the decoder if its generated responses do not reflect the attributes in z.\nLAttr(θF) = EqR(z|x)p(c,x)[log qR(z|F(c, z))] (9) Since it is not possible to propagate gradients through the discrete outputs at Fd at each word step, we use a deterministic continuous relaxation (Hu et al., 2017) by replacing output of Fd with the probability of each word. Let ot be the normalized probability at step t ∈ [1, |x|], the inputs to qR at time t are then the sum of word embeddings weighted by ot, i.e. hRt = RNN(hRt−1,Eot) and E is the word embedding matrix. Finally this loss is combined with LLAED and a hyperparameter λ to have Attribute Forcing LAED.\nLattrLAED = LLAED + λLAttr (10)"
  }, {
    "heading": "3.4 Relationship with Conditional VAEs",
    "text": "It is not hard to see LLAED is closely related to the objective of CVAEs for dialog generation (Serban et al., 2016; Zhao et al., 2017), which is:\nLCVAE = Eq[log p(x|z, c)]−KL(q(z|x, c)‖p(z|c)) (11) Despite their similarities, we highlight the key differences that prohibit CVAE from achieving interpretable dialog generation. First LCVAE encourages I(x, z|c) (Agakov, 2005), which learns z that capture context-dependent semantics. More intuitively, z in CVAE is trained to generate x via p(x|z, c) so the meaning of learned z can only be interpreted along with its context c. Therefore this violates our goal of learning context-independent semantics. Our methods learn qR(z|x) that only depends on x and trains qR separately to ensure the semantics of z are interpretable standalone."
  }, {
    "heading": "4 Experiments and Results",
    "text": "The proposed methods are evaluated on four datasets. The first corpus is Penn Treebank (PTB) (Marcus et al., 1993) used to evaluate sentence VAEs (Bowman et al., 2015). We used\nthe version pre-processed by Mikolov (Mikolov et al., 2010). The second dataset is the Stanford Multi-Domain Dialog (SMD) dataset that contains 3,031 human-Woz, task-oriented dialogs collected from 3 different domains (navigation, weather and scheduling) (Eric and Manning, 2017). The other two datasets are chat-oriented data: Daily Dialog (DD) and Switchboard (SW) (Godfrey and Holliman, 1997), which are used to test whether our methods can generalize beyond task-oriented dialogs but also to to open-domain chatting. DD contains 13,118 multi-turn human-human dialogs annotated with dialog acts and emotions. (Li et al., 2017). SW has 2,400 human-human telephone conversations that are annotated with topics and dialog acts. SW is a more challenging dataset because it is transcribed from speech which contains complex spoken language phenomenon, e.g. hesitation, self-repair etc."
  }, {
    "heading": "4.1 Comparing Discrete Sentence Representation Models",
    "text": "The first experiment used PTB and DD to evaluate the performance of the proposed methods in learning discrete sentence representations. We implemented DI-VAE and DI-VST using GRURNN (Chung et al., 2014) and trained them using Adam (Kingma and Ba, 2014). Besides the proposed methods, the following baselines are compared. Unregularized models: removing the KL(q|p) term from DI-VAE and DI-VST leads to a simple discrete autoencoder (DAE) and discrete skip thought (DST) with stochastic discrete hidden units. ELBO models: the basic discrete sentence VAE (DVAE) or variational skip thought (DVST) that optimizes ELBO with regularization term KL(q(z|x)‖p(z)). We found that standard training failed to learn informative latent actions for either DVAE or DVST because of the posterior collapse. Therefore, KL-annealing (Bowman et al., 2015) and bag-of-word loss (Zhao et al., 2017) are used to force these two models learn meaningful representations. We also include the results for VAE with continuous latent variables reported on the same PTB (Zhao et al., 2017). Additionally, we report the perplexity from a standard GRU-RNN language model (Zaremba et al., 2014).\nThe evaluation metrics include reconstruction perplexity (PPL), KL(q(z)‖p(z)) and the mutual information between input data and latent vari-\nables I(x, z). Intuitively a good model should achieve low perplexity and KL distance, and simultaneously achieve high I(x, z). The discrete latent space for all models are M=20 and K=10. Mini-batch size is 30.\nTable 1 shows that all models achieve better perplexity than an RNNLM, which shows they manage to learn meaningful q(z|x). First, for autoencoding models, DI-VAE is able to achieve the best results in all metrics compared other methods. We found DAEs quickly learn to reconstruct the input but they are prone to overfitting during training, which leads to lower performance on the test data compared to DI-VAE. Also, since there is no regularization term in the latent space, q(z) is very different from the p(z) which prohibits us from generating sentences from the latent space. In fact, DI-VAE enjoys the same linear interpolation properties reported in (Bowman et al., 2015) (See Appendix A.2). As for DVAEs, it achieves zero I(x, z) in standard training and only manages to learn some information when training with KL-annealing and bag-of-word loss. On the other hand, our methods achieve robust performance without the need for additional processing. Similarly, the proposed DI-VST is able to achieve the lowest PPL and similar KL compared to the strongly regularized DVST. Interestingly, although DST is able to achieve the highest I(x, z), but PPL is not further improved. These results confirm the effectiveness of the proposed BPR in terms of regularizing q(z) while learning meaningful posterior q(z|x).\nIn order to understand BPR’s sensitivity to batch size N , a follow-up experiment varied the batch size from 2 to 60 (If N=1, DI-VAE is equivalent to DVAE). Figure 2 show that asN increases,\nperplexity, I(x, z) monotonically improves, while KL(q‖p) only increases from 0 to 0.159. After N > 30, the performance plateaus. Therefore, using mini-batch is an efficient trade-off between q(z) estimation and computation speed.\nThe last experiment in this section investigates the relation between representation learning and the dimension of the latent space. We set a fixed budget by restricting the maximum number of modes to be about 1000, i.e. KM ≈ 1000. We then vary the latent space size and report the same evaluation metrics. Table 2 shows that models with multiple small latent variables perform significantly better than those with large and few latent variables."
  }, {
    "heading": "4.2 Interpreting Latent Actions",
    "text": "The next question is to interpret the meaning of the learned latent action symbols. To achieve this, the latent action of an utterance xn is obtained from a greedy mapping: an = argmaxk qR(z = k|xn). We set M=3 and K=5, so that there are at most 125 different latent actions, and each xn can now be represented by a1-a2-a3, e.g. “How are you?” → 1-4-2. Assuming that we have access to manually clustered data according to certain classes\n(e.g. dialog acts), it is unfair to use classic cluster measures (Vinh et al., 2010) to evaluate the clusters from latent actions. This is because the uniform prior p(z) evenly distribute the data to all possible latent actions, so that it is expected that frequent classes will be assigned to several latent actions. Thus we utilize the homogeneity metric (Rosenberg and Hirschberg, 2007) that measures if each latent action contains only members of a single class. We tested this on the SW and DD, which contain human annotated features and we report the latent actions’ homogeneity w.r.t these features in Table 3. On DD, results show DI-VST\nworks better than DI-VAE in terms of creating actions that are more coherent for emotion and dialog acts. The results are interesting on SW since DI-VST performs worse on dialog acts than DIVAE. One reason is that the dialog acts in SW are more fine-grained (42 acts) than the ones in DD (5 acts) so that distinguishing utterances based on words in x is more important than the information in the neighbouring utterances.\nWe then apply the proposed methods to SMD which has no manual annotation and contains taskoriented dialogs. Two experts are shown 5 randomly selected utterances from each latent action and are asked to give an action name that can describe as many of the utterances as possible. Then an Amazon Mechanical Turk study is conducted to evaluate whether other utterances from the same latent action match these titles. 5 workers see the action name and a different group of 5 utterances from that latent action. They are asked to select all utterances that belong to the given actions, which tests the homogeneity of the utterances falling in the same cluster. Negative samples are included to prevent random selection. Table 4 shows that both methods work well and DI-VST achieved better homogeneity than DI-VAE.\nSince DI-VAE is trained to reconstruct its input and DI-VST is trained to model the context, they group utterances in different ways. For example, DI-VST would group “Can I get a restaurant”, “I am looking for a restaurant” into one action where\nDI-VAE may denote two actions for them. Finally,\nTable 4.2 shows sample annotation results, which show cases of the different types of latent actions discovered by our models.\nModel Action Sample utterance DI-VAE scheduling - sys: okay, scheduling a yoga\nactivity with Tom for the 8th at 2pm. - sys: okay, scheduling a meeting for 6 pm on Tuesday with your boss to go over the quarterly report.\nrequests - usr: find out if it ’s supposed to rain - usr: find nearest coffee shop\nDI-VST ask schedule info - usr: when is my football activity and who is going with me? - usr: tell me when my dentist appointment is?\nrequests - usr: how about other coffee? - usr: 11 am please\nTable 5: Example latent actions discovered in SMD using our methods."
  }, {
    "heading": "4.3 Dialog Response Generation with Latent Actions",
    "text": "Finally we implement an LAED as follows. The encoder is a hierarchical recurrent encoder (Serban et al., 2016) with bi-directional GRU-RNNs as the utterance encoder and a second GRU-RNN as the discourse encoder. The discourse encoder output its last hidden state he|x|. The decoder is another GRU-RNN and its initial state of the decoder is obtained by hd0 = h e |x| + ∑M m=1 em(zm), where z comes from the recognition network of the proposed methods. The policy network π is a 2-layer multi-layer perceptron (MLP) that models pπ(z|he|x|). We use up to the previous 10 utterances as the dialog context and denote the LAED using DI-VAE latent actions as AE-ED and the one uses DI-VST as ST-ED.\nFirst we need to confirm whether an LAED can generate responses that are consistent with the semantics of a given z. To answer this, we use a pre-trained recognition network R to check if a generated response carries the attributes in\nthe given action. We generate dialog responses on a test dataset via x̃ = F(z ∼ π(c), c) with greedy RNN decoding. The generated responses are passed into the R and we measure attribute accuracy by counting x̃ as correct if z = argmaxk qR(k|x̃). Table 4.3 shows our generated\nresponses are highly consistent with the given latent actions. Also, latent actions from DI-VAE achieve higher attribute accuracy than the ones from DI-VST, because z from auto-encoding is explicitly trained for x reconstruction. Adding Lattr is effective in forcing the decoder to take z into account during its generation, which helps the most in more challenging open-domain chatting data, e.g. SW and DD. The accuracy of ST-ED on SW is worse than the other two datasets. The reason is that SW contains many short utterances that can be either a continuation of the same speaker or a new turn from the other speaker, whereas the responses in the other two domains are always followed by a different speaker. The more complex context pattern in SW may require special treatment. We leave it for future work.\nThe second experiment checks if the policy network π is able to predict the right latent action given just the dialog context. We report both accuracy, i.e. argmaxk qR(k|x) = argmaxk′ pπ(k′|c) and perplexity of pπ(z|c). The perplexity measure is more useful for open domain dialogs because decision-making in complex dialogs is often one-to-many given a similar context (Zhao et al., 2017). Table 7 shows the prediction scores on\nthe three dialog datasets. These scores provide\nuseful insights to understand the complexity of a dialog dataset. For example, accuracy on opendomain chatting is harder than the task-oriented SMD data. Also, it is intuitive that predicting system actions is easier than predicting user actions on SMD. Also, in general the prediction scores for ST-ED are higher the ones for AE-ED. The reason is related to our previous discussion about the granularity of the latent actions. Since latent actions from DI-VST mainly model the the type of utterances used in certain types of context, it is easier for the policy network to predict latent actions from DI-VST. Therefore, choosing the type of latent actions is a design choice and depends on the type of interpretability that is needed. We finish with an example generated from the two variants of LAED on SMD as shown in Table 8. Given a dialog context, our systems are able to output a probability distribution over different latent actions that have interpretable meaning along with their natural language realizations."
  }, {
    "heading": "5 Conclusion and Future Work",
    "text": "This paper presents a novel unsupervised framework that enables the discovery of discrete latent actions and interpretable dialog response generation. Our main contributions reside in the two sentence representation models DI-VAE and DIVST, and their integration with the encoder decoder models. Experiments show the proposed methods outperform strong baselines in learning discrete latent variables and showcase the effectiveness of interpretable dialog response generation. Our findings also suggest promising future research directions, including learning better context-based latent actions and using reinforce-\nment learning to adapt policy networks. We believe that this work is an important step forward towards creating generative dialog models that can not only generalize to large unlabelled datasets in complex domains but also be explainable to human users."
  }],
  "year": 2018,
  "references": [{
    "title": "Variational Information Maximization in Stochastic Environments",
    "authors": ["Felix Vsevolodovich Agakov."],
    "venue": "Ph.D. thesis, University of Edinburgh.",
    "year": 2005
  }, {
    "title": "How to do things with words",
    "authors": ["John Langshaw Austin."],
    "venue": "Oxford university press.",
    "year": 1975
  }, {
    "title": "Latent dirichlet allocation",
    "authors": ["David M Blei", "Andrew Y Ng", "Michael I Jordan."],
    "venue": "Journal of machine Learning research 3(Jan):993–1022.",
    "year": 2003
  }, {
    "title": "Olympus: an open-source framework for conversational spoken language interface research",
    "authors": ["Dan Bohus", "Antoine Raux", "Thomas K Harris", "Maxine Eskenazi", "Alexander I Rudnicky."],
    "venue": "Proceedings of the workshop on bridging the gap: Academic and",
    "year": 2007
  }, {
    "title": "Generating sentences from a continuous space",
    "authors": ["Samuel R Bowman", "Luke Vilnis", "Oriol Vinyals", "Andrew M Dai", "Rafal Jozefowicz", "Samy Bengio."],
    "venue": "arXiv preprint arXiv:1511.06349 .",
    "year": 2015
  }, {
    "title": "Latent variable dialogue models and their diversity",
    "authors": ["Kris Cao", "Stephen Clark."],
    "venue": "arXiv preprint arXiv:1702.05962 .",
    "year": 2017
  }, {
    "title": "Variational lossy autoencoder",
    "authors": ["Xi Chen", "Diederik P Kingma", "Tim Salimans", "Yan Duan", "Prafulla Dhariwal", "John Schulman", "Ilya Sutskever", "Pieter Abbeel."],
    "venue": "arXiv preprint arXiv:1611.02731 .",
    "year": 2016
  }, {
    "title": "Learning phrase representations using rnn encoder-decoder for statistical machine translation",
    "authors": ["Kyunghyun Cho", "Bart Van Merriënboer", "Caglar Gulcehre", "Dzmitry Bahdanau", "Fethi Bougares", "Holger Schwenk", "Yoshua Bengio."],
    "venue": "arXiv preprint",
    "year": 2014
  }, {
    "title": "Empirical evaluation of gated recurrent neural networks on sequence modeling",
    "authors": ["Junyoung Chung", "Caglar Gulcehre", "KyungHyun Cho", "Yoshua Bengio."],
    "venue": "arXiv preprint arXiv:1412.3555 .",
    "year": 2014
  }, {
    "title": "Keyvalue retrieval networks for task-oriented dialogue",
    "authors": ["Mihail Eric", "Christopher D Manning."],
    "venue": "arXiv preprint arXiv:1705.05414 .",
    "year": 2017
  }, {
    "title": "Gaussian processes for fast policy optimisation of pomdp-based dialogue managers",
    "authors": ["Milica Gašić", "Filip Jurčı́ček", "Simon Keizer", "François Mairesse", "Blaise Thomson", "Kai Yu", "Steve Young"],
    "year": 2010
  }, {
    "title": "Switchboard-1 release 2",
    "authors": ["John J Godfrey", "Edward Holliman."],
    "venue": "Linguistic Data Consortium, Philadelphia .",
    "year": 1997
  }, {
    "title": "Distributional structure",
    "authors": ["Zellig S Harris."],
    "venue": "Word 10(2-3):146–162.",
    "year": 1954
  }, {
    "title": "Learning distributed representations of sentences from unlabelled data",
    "authors": ["Felix Hill", "Kyunghyun Cho", "Anna Korhonen."],
    "venue": "arXiv preprint arXiv:1602.03483 .",
    "year": 2016
  }, {
    "title": "Toward controlled generation of text",
    "authors": ["Zhiting Hu", "Zichao Yang", "Xiaodan Liang", "Ruslan Salakhutdinov", "Eric P Xing."],
    "venue": "International Conference on Machine Learning. pages 1587–1596.",
    "year": 2017
  }, {
    "title": "Categorical reparameterization with gumbel-softmax",
    "authors": ["Eric Jang", "Shixiang Gu", "Ben Poole."],
    "venue": "arXiv preprint arXiv:1611.01144 .",
    "year": 2016
  }, {
    "title": "Adversarially regularized autoencoders for generating discrete structures",
    "authors": ["Yoon Kim", "Kelly Zhang", "Alexander M Rush", "Yann LeCun"],
    "year": 2017
  }, {
    "title": "Adam: A method for stochastic optimization",
    "authors": ["Diederik Kingma", "Jimmy Ba."],
    "venue": "arXiv preprint arXiv:1412.6980 .",
    "year": 2014
  }, {
    "title": "Autoencoding variational bayes",
    "authors": ["Diederik P Kingma", "Max Welling."],
    "venue": "arXiv preprint arXiv:1312.6114 .",
    "year": 2013
  }, {
    "title": "Skip-thought vectors",
    "authors": ["Ryan Kiros", "Yukun Zhu", "Ruslan R Salakhutdinov", "Richard Zemel", "Raquel Urtasun", "Antonio Torralba", "Sanja Fidler."],
    "venue": "Advances in neural information processing systems. pages 3294–3302.",
    "year": 2015
  }, {
    "title": "Information state and dialogue management in the trindi dialogue move engine toolkit",
    "authors": ["Staffan Larsson", "David R Traum."],
    "venue": "Natural language engineering 6(3-4):323–340.",
    "year": 2000
  }, {
    "title": "A persona-based neural conversation model",
    "authors": ["Jiwei Li", "Michel Galley", "Chris Brockett", "Jianfeng Gao", "Bill Dolan."],
    "venue": "arXiv preprint arXiv:1603.06155 .",
    "year": 2016
  }, {
    "title": "Dailydialog: A manually labelled multi-turn dialogue dataset",
    "authors": ["Yanran Li", "Hui Su", "Xiaoyu Shen", "Wenjie Li", "Ziqiang Cao", "Shuzi Niu."],
    "venue": "arXiv preprint arXiv:1710.03957 .",
    "year": 2017
  }, {
    "title": "The concrete distribution: A continuous relaxation of discrete random variables",
    "authors": ["Chris J Maddison", "Andriy Mnih", "Yee Whye Teh."],
    "venue": "arXiv preprint arXiv:1611.00712 .",
    "year": 2016
  }, {
    "title": "Adversarial autoencoders",
    "authors": ["Alireza Makhzani", "Jonathon Shlens", "Navdeep Jaitly", "Ian Goodfellow", "Brendan Frey."],
    "venue": "arXiv preprint arXiv:1511.05644 .",
    "year": 2015
  }, {
    "title": "Building a large annotated corpus of english: The penn treebank",
    "authors": ["Mitchell P Marcus", "Mary Ann Marcinkiewicz", "Beatrice Santorini."],
    "venue": "Computational linguistics 19(2):313–330.",
    "year": 1993
  }, {
    "title": "Neural variational inference for text processing",
    "authors": ["Yishu Miao", "Lei Yu", "Phil Blunsom."],
    "venue": "International Conference on Machine Learning. pages 1727–1736.",
    "year": 2016
  }, {
    "title": "Recurrent neural network based language model",
    "authors": ["Tomas Mikolov", "Martin Karafiát", "Lukas Burget", "Jan Cernockỳ", "Sanjeev Khudanpur."],
    "venue": "Interspeech. volume 2, page 3.",
    "year": 2010
  }, {
    "title": "Vmeasure: A conditional entropy-based external cluster evaluation measure",
    "authors": ["Andrew Rosenberg", "Julia Hirschberg."],
    "venue": "Proceedings of the 2007 joint conference on empirical methods in natural language processing and computational natural lan-",
    "year": 2007
  }, {
    "title": "A hierarchical latent variable encoder-decoder model for generating dialogues",
    "authors": ["Iulian Vlad Serban", "Alessandro Sordoni", "Ryan Lowe", "Laurent Charlin", "Joelle Pineau", "Aaron Courville", "Yoshua Bengio."],
    "venue": "arXiv preprint arXiv:1605.06069 .",
    "year": 2016
  }, {
    "title": "Dialogue act modeling for automatic tagging and recognition",
    "authors": ["Andreas Stolcke", "Noah Coccaro", "Rebecca Bates", "Paul Taylor", "Carol Van Ess-Dykema", "Klaus Ries", "Elizabeth Shriberg", "Daniel Jurafsky", "Rachel Martin", "Marie Meteer"],
    "year": 2000
  }, {
    "title": "Neural discrete representation learning",
    "authors": ["Aaron van den Oord", "Oriol Vinyals"],
    "venue": "In Advances in Neural Information Processing Systems",
    "year": 2017
  }, {
    "title": "Information theoretic measures for clusterings comparison: Variants, properties, normalization and correction for chance",
    "authors": ["Nguyen Xuan Vinh", "Julien Epps", "James Bailey."],
    "venue": "Journal of Machine Learning Research 11(Oct):2837–2854.",
    "year": 2010
  }, {
    "title": "Latent intention dialogue models",
    "authors": ["Tsung-Hsien Wen", "Yishu Miao", "Phil Blunsom", "Steve Young."],
    "venue": "arXiv preprint arXiv:1705.10229 .",
    "year": 2017
  }, {
    "title": "Partially observable markov decision processes for spoken dialog systems",
    "authors": ["Jason D Williams", "Steve Young."],
    "venue": "Computer Speech & Language 21(2):393–422.",
    "year": 2007
  }, {
    "title": "Topic augmented neural response generation with a joint attention mechanism",
    "authors": ["Chen Xing", "Wei Wu", "Yu Wu", "Jie Liu", "Yalou Huang", "Ming Zhou", "Wei-Ying Ma."],
    "venue": "arXiv preprint arXiv:1606.08340 .",
    "year": 2016
  }, {
    "title": "Recurrent neural network regularization",
    "authors": ["Wojciech Zaremba", "Ilya Sutskever", "Oriol Vinyals."],
    "venue": "arXiv preprint arXiv:1409.2329 .",
    "year": 2014
  }, {
    "title": "Learning discourse-level diversity for neural dialog models using conditional variational autoencoders",
    "authors": ["Tiancheng Zhao", "Ran Zhao", "Maxine Eskenazi."],
    "venue": "arXiv preprint arXiv:1703.10960 .",
    "year": 2017
  }, {
    "title": "Infovae: Information maximizing variational autoencoders",
    "authors": ["Shengjia Zhao S", "Jiaming Song", "Stefano Ermon."],
    "venue": "arXiv preprint arXiv:1706.02262 .",
    "year": 2017
  }, {
    "title": "Multispace variational encoder-decoders for semisupervised labeled sequence transduction",
    "authors": ["Chunting Zhou", "Graham Neubig."],
    "venue": "arXiv preprint arXiv:1704.01691 .",
    "year": 2017
  }],
  "id": "SP:6b0e17f2674aff004465fbd1597855b045f83207",
  "authors": [{
    "name": "Tiancheng Zhao",
    "affiliations": []
  }, {
    "name": "Kyusong Lee",
    "affiliations": []
  }, {
    "name": "Maxine Eskenazi",
    "affiliations": []
  }],
  "abstractText": "The encoder-decoder dialog model is one of the most prominent methods used to build dialog systems in complex domains. Yet it is limited because it cannot output interpretable actions as in traditional systems, which hinders humans from understanding its generation process. We present an unsupervised discrete sentence representation learning method that can integrate with any existing encoderdecoder dialog models for interpretable response generation. Building upon variational autoencoders (VAEs), we present two novel models, DI-VAE and DI-VST that improve VAEs and can discover interpretable semantics via either auto encoding or context predicting. Our methods have been validated on real-world dialog datasets to discover semantic representations and enhance encoder-decoder models with interpretable generation.1",
  "title": "Unsupervised Discrete Sentence Representation Learning for Interpretable Neural Dialog Generation"
}