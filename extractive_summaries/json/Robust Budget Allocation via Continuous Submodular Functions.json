{
  "sections": [{
    "heading": "1. Introduction",
    "text": "The optimal allocation of resources for maximizing influence, spread of information or coverage, has gained attention in the past few years, in particular in machine learning and data mining (Domingos & Richardson, 2001; Kempe et al., 2003; Chen et al., 2009; Gomez Rodriguez & Schölkopf, 2012; Borgs et al., 2014).\nIn the Budget Allocation Problem, one is given a bipartite influence graph between channels S and people T , and the task is to assign a budget y(s) to each channel s in S with the goal of maximizing the expected number of influenced people I(y). Each edge (s, t) 2 E between channel s and\n1Massachusetts Institute of Technology. Correspondence to: Matthew Staib <mstaib@mit.edu>, Stefanie Jegelka <stefje@mit.edu>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nperson t is weighted with a probability pst that, e.g., an advertisement on radio station s will influence person t to buy some product. The budget y(s) controls how many independent attempts are made via the channel s to influence the people in T . The probability that a customer t is influenced when the advertising budget is y is\nIt(y) = 1 Y (s,t)2E [1 pst]y(s), (1)\nand hence the expected number of influenced people is I(y) = P\nt2T It(y). We write I(y; p) = I(y) to make the dependence on the probabilities pst explicit. The total budget y must remain within some feasible set Y which may encode e.g. a total budget limit P\ns2S y(s)  C. We allow the budgets y to be continuous, as in (Bian et al., 2017).\nSince its introduction by Alon et al. (2012), several works have extended the formulation of Budget Allocation and provided algorithms (Bian et al., 2017; Hatano et al., 2015; Maehara et al., 2015; Soma et al., 2014; Soma & Yoshida, 2015). Budget Allocation may also be viewed as influence maximization on a bipartite graph, where information spreads as in the Independent Cascade model. For integer y, Budget Allocation and Influence Maximization are NPhard. Yet, constant-factor approximations are possible, and build on the fact that the influence function is submodular in the binary case, and DR-submodular in the integer case (Soma et al., 2014; Hatano et al., 2015). If y is continuous, the problem is a concave maximization problem.\nThe formulation of Budget Allocation assumes that the transmission probabilities are known exactly. But this is rarely true in practice. Typically, the probabilities pst, and possibly the graph itself, must be inferred from observations (Gomez Rodriguez et al., 2010; Du et al., 2013; Narasimhan et al., 2015; Du et al., 2014; Netrapalli & Sanghavi, 2012). In Section 4 we will see that a misspecification or point estimate of parameters pst can lead to much reduced outcomes. A more realistic assumption is to know confidence intervals for the pst. Realizing this severe deficiency, recent work studied robust versions of Influence Maximization, where a budget y must be chosen that maximizes the worst-case approximation ratio over a set of possible influence functions (He & Kempe, 2016; Chen et al., 2016; Lowalekar et al., 2016). The resulting optimization problem is hard but admits bicriteria approximations.\nIn this work, we revisit Budget Allocation under uncertainty from the perspective of robust optimization (Bertsimas et al., 2011; Ben-Tal et al., 2009). We maximize the worst-case influence – not approximation ratio – for p in a confidence set centered around the “best guess” (e.g., posterior mean). This avoids pitfalls of the approximation ratio formulation (which can be misled to return poor worst-case budgets, as demonstrated in Appendix A), while also allowing us to formulate the problem as a max-min game:\nmax y2Y min p2P I(y; p), (2)\nwhere an “adversary” can arbitrarily manipulate p within the confidence set P . With p fixed, I(y; p) is concave in y. However, the influence function I(y; p) is not convex, and not even quasiconvex, in the adversary’s variables pst.\nThe new, key insight we exploit in this work is that I(y; p) has the property of continuous submodularity in p – in contrast to previously exploited submodular maximization in y – and can hence be minimized by generalizing techniques from discrete submodular optimization (Bach, 2015). The techniques in (Bach, 2015), however, are restricted to box constraints, and do not directly apply to our confidence sets. In fact, general constrained submodular minimization is hard (Svitkina & Fleischer, 2011; Goel et al., 2009; Iwata & Nagano, 2009). We make the following contributions:\n1. We present an algorithm with optimality bounds for Robust Budget Allocation in the nonconvex adversarial scenario (2).\n2. We provide the first results for continuous submodular minimization with box constraints and one more “nice” constraint, and conditions under which the algorithm is guaranteed to return a global optimum."
  }, {
    "heading": "1.1. Background and Related Work",
    "text": "We begin with some background material and, along the way, discuss related work."
  }, {
    "heading": "1.1.1. SUBMODULARITY OVER THE INTEGER LATTICE AND CONTINUOUS DOMAINS",
    "text": "Submodularity is perhaps best known as a property of set functions. A function F : 2V ! R defined on subsets S ✓ V of a ground set V is submodular if for all sets S, T ✓ V , it holds that F (S) + F (T ) F (S \\ T ) + F (S[T ). A similar definition extends to functions defined over a distributive lattice L, e.g. the integer lattice. Such a function f is submodular if for all x, y 2 L, it holds that\nf(x) + f(y) f(x _ y) + f(x ^ y). (3)\nFor the integer lattice and vectors x, y, x _ y denotes the coordinate-wise maximum and x ^ y the coordinate-wise\nminimum. Submodularity has also been considered on continuous domains X ⇢ Rd, where, if f is also twicedifferentiable, the property of submodularity means that all off-diagonal entries of the the Hessian are nonpositive, i.e., @f(x) @xi@xj\n 0 for all i 6= j (Topkis, 1978, Theorem 3.2). These functions may be convex, concave, or neither.\nSubmodular functions on lattices can be minimized by a reduction to set functions, more precisely, ring families (Birkhoff, 1937). Combinatorial algorithms for submodular optimization on lattices are discussed in (Khachaturov et al., 2012). More recently, Bach (2015) extended results based on the convex Lovász extension, by building on connections to optimal transport. The subclass of L\\-convex functions admits strongly polynomial time minimization (Murota, 2003; Kolmogorov & Shioura, 2009; Murota & Shioura, 2014), but does not apply in our setting.\nSimilarly, results for submodular maximization extend to integer lattices, e.g. (Gottschalk & Peis, 2015). Stronger results are possible if the submodular function also satisfies diminishing returns: for all x  y (coordinate-wise) and i such that y+ei 2 X , it holds that f(x+ei) f(x) f(y+ei) f(y). For such DR-submodular functions, many approximation results for the set function case extend (Bian et al., 2017; Soma & Yoshida, 2015; Soma et al., 2014). In particular, Ene & Nguyen (2016) show a generic reduction to set function optimization that they apply to maximization. In fact, it also applies to minimization:\nProposition 1.1. A DR-submodular function f defined on\nQn i=1[ki] can be minimized in strongly polynomial time O(n4 log4 k · log2(n log k) · EO + n4 log4 k · log O(1) (n log k)), where k = maxi ki and EO is the time complexity of evaluating f . Here, [ki] = {0, 1, . . . , ki 1}.\nIn particular, the time complexity is logarithmic in k. For general lattice submodular functions, this is not possible without further assumptions."
  }, {
    "heading": "1.1.2. RELATED PROBLEMS",
    "text": "A sister problem of Budget Allocation is Influence Maximization on general graphs, where a set of seed nodes is selected to start a propagation process. The influence function is still monotone submodular and amenable to the greedy algorithm (Kempe et al., 2003), but it cannot be evaluated explicitly and requires approximation (Chen et al., 2010). Stochastic Coverage (Goemans & Vondrák, 2006) is a version of Set Cover where the covering sets Si ⇢ V are random. A variant of Budget Allocation can be written as stochastic coverage with multiplicity. Stochastic Coverage has mainly been studied in the online or adaptive setting, where logarithmic approximation factors can be achieved (Golovin & Krause, 2011; Deshpande et al., 2016; Adamczyk et al., 2016).\nOur objective function (2) is a signomial in p, i.e., a linear combination of monomials of the form Q\ni x ci i . Gen-\neral signomial optimization is NP-hard (Chiang, 2005), but certain subclasses are tractable: posynomials with all nonnegative coefficients can be minimized via Geometric Programming (Boyd et al., 2007), and signomials with a single negative coefficient admit sum of squares-like relaxations (Chandrasekaran & Shah, 2016). Our problem, a constrained posynomial maximization, is not in general a geometric program. Some work addresses this setting via monomial approximation (Pascual & Ben-Israel, 1970; Ecker, 1980), but, to our knowledge, our algorithm is the first that solves this problem to arbitrary accuracy."
  }, {
    "heading": "1.1.3. ROBUST OPTIMIZATION",
    "text": "Two prominent strategies of addressing uncertainty in parameters of optimization problems are stochastic and robust optimization. If the distribution of the parameters is known (stochastic optimization), formulations such as value-at-risk (VaR) and conditional value-at-risk (CVaR) (Rockafellar & Uryasev, 2000; 2002) apply. In contrast, robust optimization (Ben-Tal et al., 2009; Bertsimas et al., 2011) assumes that the parameters (of the cost function and constraints) can vary arbitrarily within a known confidence set U , and the aim is to optimize the worst-case setting, i.e.,\nmin y sup u,A,b2U {g(y;u) s.t. Ay  b}. (4)\nHere, we will only have uncertainty in the cost function.\nIn this paper we are principally concerned with robust maximization of the continuous influence function I(y), but mention some results for the discrete case. While there exist results for robust and CVaR optimization of modular (linear) functions (Nikolova, 2010; Bertsimas & Sim, 2003), submodular objectives do not in general admit such optimization (Maehara, 2015), but variants admit approximations (Zhang et al., 2014). The brittleness of submodular optimization under noise has been studied in (Balkanski et al., 2016; 2017; Hassidim & Singer, 2016).\nApproximations for robust submodular and influence optimization have been studied in (Krause et al., 2008; He & Kempe, 2016; Chen et al., 2016; Lowalekar et al., 2016), where an adversary can pick among a finite set of objective functions or remove selected elements (Orlin et al., 2016)."
  }, {
    "heading": "2. Robust and Stochastic Budget Allocation",
    "text": "The unknown parameters in Budget Allocation are the transmission probabilities pst or edge weights in a graph. If these are estimated from data, we may have posterior distributions or, a weaker assumption, confidence sets for the parameters. For ease of notation, we will work with the failure probabilities xst = 1 pst instead of the pst\ndirectly, and write I(y;x) instead of I(y; p)."
  }, {
    "heading": "2.1. Stochastic Optimization",
    "text": "If a (posterior) distribution of the parameters is known, a simple strategy is to use expectations. We place a uniform prior on xst, and observe nst independent observations drawn from Ber(xst). If we observe ↵st failures and and st successes, the resulting posterior distribution on the variable Xst is Beta(1 + ↵st, 1 + st). Given such a posterior, we may optimize\nmax y2Y I(y;E[X]), or (5)\nmax y2Y E[I(y;X)]. (6)\nProposition 2.1. Problems (5) and (6) are concave maximization problems over the (convex) set Y and can be solved exactly.\nConcavity of (6) follows since it is an expectation over concave functions, and the problem can be solved by stochastic gradient ascent or by explicitly computing gradients.\nMerely maximizing expectation does not explicitly account for volatility and hence risk. One option is to include variance (Ben-Tal & Nemirovski, 2000; Bertsimas et al., 2011; Atamtürk & Narayanan, 2008):\nmin y2Y E[I(y;X)] + \"\np\nVar(I(y;X)), (7)\nbut in our case this CVaR formulation seems difficult: Fact 2.1. For y in the nonnegative orthant, the term p\nVar(I(y;X)) need not be convex or concave, and need not be submodular or supermodular.\nThis observation does not rule out a solution, but the apparent difficulties further motivate a robust formulation that, as we will see, is amenable to optimization."
  }, {
    "heading": "2.2. Robust Optimization",
    "text": "The focus of this work is the robust version of Budget Allocation, where we allow an adversary to arbitrarily set the parameters x within an uncertainty set X . This uncertainty set may result, for instance, from a known distribution, or simply assumed bounds. Formally, we solve\nmax y2Y min x2X I(y;x), (8)\nwhere Y ⇢ RS + is a convex set with an efficient projection oracle, and X is an uncertainty set containing an estimate x̂. In the sequel, we use uncertainty sets X = {x 2 Box(l, u) : R(x)  B}, where R is a distance (or divergence) from the estimate x̂, and Box(l, u) is the box Q\n(s,t)2E [lst, ust]. The intervals [lst, ust] can be thought of\nas either confidence intervals around x̂, or, if [lst, ust] = [0, 1], enforce that each xst is a valid probability.\nCommon examples of uncertainty sets used in Robust Optimization are Ellipsoidal and D-norm uncertainty sets (Bertsimas et al., 2011). Our algorithm in Section 3.1 applies to both.\nEllipsoidal uncertainty. The ellipsoidal or quadratic uncertainty set is defined by\nXQ( ) = {x 2 Box(0, 1) : (x x̂)T⌃ 1(x x̂)  },\nwhere ⌃ is the covariance of the random vector X of probabilities distributed according to our Beta posteriors. In our case, since the distributions on each xst are independent, ⌃ 1 is actually diagonal. Writing ⌃ = diag( 2), we have\nXQ( ) = n x 2 Box(0, 1) : X\n(s,t)2E\nRst(xst)  o ,\nwhere Rst(x) = (xst x̂st)2 2st .\nD-norm uncertainty. The D-norm uncertainty set is similar to an `\n1\n-ball around x̂, and is defined as\nXD( ) = n x : 9c 2 Box(0, 1) s.t.\nxst = x̂st + (ust x̂st)cst, X\n(s,t)2E\ncst  o .\nEssentially, we allow an adversary to increase x̂st up to some upper bound ust, subject to some total budget across all terms xst. The set XD( ) can be rewritten as\nXD( ) = n x 2 Box(x̂, u) : X\n(s,t)2E\nRst(xst)  o ,\nwhere Rst(xst) = (xst x̂st)/(ust x̂st) is the fraction of the interval [x̂st, ust] we have used up in increasing xst.\nThe min-max formulation maxy2Y minx2X I(y;x) has several merits: the model is not tied to a specific learning algorithm for the probabilities x as long as we can choose a suitable confidence set. Moreover, this formulation allows to fully hedge against a worst-case scenario."
  }, {
    "heading": "3. Optimization Algorithm",
    "text": "As noted above, the function I(y;x) is concave as a function of y for fixed x. As a pointwise minimum of concave functions, F (y) := minx2X I(y;x) is concave. Hence, if we can compute subgradients of F (y), we can solve our max-min-problem via the subgradient method, as outlined in Algorithm 1.\nA subgradient gy 2 @F (y) at y is given by the gradient of I(y;x⇤) for the minimizing x⇤ 2 argminx2X I(y;x), i.e.,\nAlgorithm 1 Subgradient Ascent Input: suboptimality tolerance \" > 0, initial feasible budget y(0) 2 Y Output: \"-optimal budget y for Problem (8) repeat x(k) argminx2X I(y(k);x) g(k) ryI(y(k);x(k)) L(k) I(y(k);x(k)) U (k) maxy2Y I(y;x(k)) (k) (U (k) L(k))/kg(k)k2\n2\ny(k+1) projY(y(k) + (k)g(k)) k k + 1\nuntil U (k) L(k)  \"\ngy = ryI(y;x⇤). Hence, we must be able to compute x⇤ for any y. We also obtain a duality gap: for any x0, y0 we have\nmin x2X I(y0;x)  max y2Y min x2X I(y;x)  max y2Y I(y;x0). (9)\nThis means we can estimate the optimal value I⇤ and use it in Polyak’s stepsize rule for the subgradient method (Polyak, 1987).\nBut I(y;x) is not convex in x, and not even quasiconvex. For example, standard methods (Wainwright & Chiang, 2004, Chapter 12) imply that f(x\n1 , x 2 , x 3\n) = 1 x 1 x 2 px 3 is not quasiconvex on R3 +\n. Moreover, the above-mentioned signomial optimization techniques do not apply for an exact solution either. So, it is not immediately clear that we can solve the inner optimization problem.\nThe key insight we will be using is that I(y;x) has a different beneficial property: while not convex, I(y;x) as a function of x is continuous submodular. Lemma 3.1. Suppose we have n 1 differentiable functions fi : R! R+, for i = 1, . . . , n, either all nonincreasing or all nondecreasing. Then, f(x) =\nQn i=1 fi(xi) is a\ncontinuous supermodular function from Rn to R + .\nProof. For n = 1, the resulting function is modular and therefore supermodular. In the case n 2, we simply need to compute derivatives. The mixed derivatives are\n@f\n@xi@xj = f 0i(xi)f 0 j(xj) ·\nY\nk 6=i,j fk(xk). (10)\nBy monotonicity, f 0i and f 0j have the same sign, so their product is nonnegative, and since each fk is nonnegative, the entire expression is nonnegative. Hence, f(x) is continuous supermodular by Theorem 3.2 of (Topkis, 1978).\nCorollary 3.1. The influence function I(y;x) defined in Section 2 is continuous submodular in x over the nonnegative orthant, for each y 0.\nProof. Since submodularity is preserved under summation, it suffices to show that each function It(y) is continuous submodular. By Lemma 3.1, since fs(z) = zy(s) is nonnegative and monotone nondecreasing for y(s) 0, the product Q\n(s,t)2E x y(s) st is continuous supermodular in x.\nFlipping the sign and adding a constant term yields It(y), which is hence continuous submodular.\nConjecture 3.1. Strong duality holds, i.e.\nmax y2Y min x2X I(y;x) = min x2X max y2Y I(y;x). (11)\nIf strong duality holds, then the duality gap maxy2Y I(y;x⇤) minx2X I(y⇤;x) in Equation (9) is zero at optimality. If I(y;x) were quasiconvex in x, strong duality would hold by Sion’s min-max theorem, but this is not the case. In practice, we observe that the duality gap always converges to zero.\nBach (2015) demonstrates how to minimize a continuous submodular function H(x) subject to box constraints x 2 Box(l, u), up to an arbitrary suboptimality gap \" > 0. The constraint set X in our Robust Budget Allocation problem, however, has box constraints with an additional constraint R(x)  B. This case is not addressed in any previous work. Fortunately, for a large class of functions R, there is still an efficient algorithm for continuous submodular minimization, which we present in the next section."
  }, {
    "heading": "3.1. Constrained Continuous Submodular Function Minimization",
    "text": "We next address an algorithm for minimizing a monotone continuous submodular function H(x) subject to box constraints x 2 Box(l, u) and a constraint R(x)  B:\nminimize H(x) s.t. R(x)  B\nx 2 Box(l, u). (12)\nIf H and R were convex, the constrained problem would be equivalent to solving, with the right Lagrange multipler ⇤ 0:\nminimize H(x) + ⇤R(x) s.t. x 2 Box(l, u). (13)\nAlthough H and R are not necessarily convex here, it turns out that a similar approach indeed applies. The main idea of our approach bears similarity with (Nagano et al., 2011) for the set function case, but our setting with continuous functions and various uncertainty sets is more general, and requires more argumentation. We outline our theoretical results here, and defer further implementation details and proofs to the appendix.\nFollowing (Bach, 2015), we discretize the problem; for a sufficiently fine discretization, we will achieve arbitrary accuracy. Let A be an interpolation mapping that maps the\ndiscrete set Qn i=1[ki] into Box(l, u) = Qn\ni=1[li, ui] via the componentwise interpolation functions Ai : [ki]! [li, ui]. We say Ai is -fine if Ai(xi + 1) Ai(xi)  for all xi 2 {0, 1, . . . , ki 2}, and we say the full interpolation function A is -fine if each Ai is -fine.\nThis mapping yields functions H : Qn i=1[ki] ! R and R :\nQn i=1[ki] ! R via H (x) = H(A(x)) and R (x) =\nR(A(x)). H is lattice submodular (on the integer lattice). This construction leads to a reduction of Problem (12) to a submodular minimization problem over the integer lattice:\nminimize H (x) + R (x) s.t. x 2\nQn i=1[ki].\n(14)\nIdeally, there should then exist a such that the associated minimizer x( ) yields a close to optimal solution for the constrained problem. Theorem 3.1 below states that this is indeed the case.\nMoreover, a second benefit of submodularity is that we can find the entire solution path for Problem (14) by solving a single optimization problem.\nLemma 3.2. Suppose H is continuous submodular, and suppose the regularizer R is strictly increasing and separable: R(x) =\nPn i=1 Ri(xi). Then we can recover a min-\nimizer x( ) for the induced discrete Problem (14) for any 2 R by solving a single convex optimization problem.\nThe problem in question arises from a relaxation h# that extends H in each coordinate i to a function on distributions over the domain [ki]. These distributions are represented via their inverse cumulative distribution functions ⇢i, which take the coordinate xi as input, and output the probability of exceeding xi. The function h# is an analogue of the Lovász extension of set functions to continuous submodular functions (Bach, 2015), it is convex and coincides with H on lattice points.\nFormally, this resulting single optimization problem is:\nminimize h#(⇢) + Pn\ni=1 Pki 1 ji=1 aixi(⇢i(xi))\ns.t. ⇢ 2 Qn i=1 R ki 1 #\n(15)\nwhere Rk# refers to the set of ordered vectors z 2 Rk that satisfy z\n1 z 2 · · · zk, the notation ⇢i(xi) denotes the xi-th coordinate of the vector ⇢i, and the aixi are strictly convex functions given by\naixi(t) = 1\n2\nt2 · [R i (xi) R i (xi 1)]. (16)\nProblem (15) can be solved by Frank-Wolfe methods (Frank & Wolfe, 1956; Dunn & Harshbarger, 1978; Lacoste-Julien, 2016; Jaggi, 2013). This is because the greedy algorithm for computing subgradients of the Lovász\nextension can be generalized, and yields a linear optimization oracle for the dual of Problem (15). We detail the relationship between Problems (14) and (15), as well as how to implement the Frank-Wolfe methods, in Appendix C.\nLet ⇢⇤ be the optimal solution for Problem (15). For any , we obtain a rounded solution x( ) for Problem (14) by thresholding: we set x( )i = max{j | 1  j  ki 1, ⇢⇤i (j) }, or zero if ⇢⇤i (j) < for all j. Each x( 0) is the optimal solution for Problem (14) with = 0. We use the largest parameterized solution x( ) that is still feasible, i.e. the solution x( ⇤) where ⇤ solves\nmin H (x( )) s.t. 0\nR (x( ))  B. (17)\nThis ⇤ can be found efficiently via binary search or a linear scan. Theorem 3.1. Let H be continuous submodular and monotone decreasing, with `1-Lipschitz constant G, and let R be strictly increasing and separable. Assume all entries ⇢⇤i (j) of the optimal solution ⇢⇤ of Problem (15) are distinct. Let x0 = A(x( ⇤)) be the thresholding corresponding to the optimal solution ⇤ of Problem (17), mapped back into the original continuous domain X . Then x0 is feasible for the continuous Problem (12), and is a 2G - approximate solution:\nH(x0)  2G + min x2Box(l,u), R(x)B H(x).\nTheorem 3.1 implies an algorithm for solving Problem (12) to \"-optimality: (1) set = \"/G, (2) compute ⇢⇤ which solves Problem (15), (3) find the optimal thresholding of ⇢⇤ by determining the smallest ⇤ for which R (x( ⇤))  B, and (4) map x( ⇤) back into continuous space via the interpolation mapping A.\nOptimality Bounds. Theorem 3.1 is proved by comparing x0 and x⇤ to the optimal solution on the discretized mesh\nx⇤d 2 argmin x2 Qn i=1[ki]:R (x)B H (x).\nBeyond the theoretical guarantee of Theorem 3.1, for any problem instance and candidate solution x0, we can compute a bound on the gap between H(x0) and H (x⇤d). The following two bounds are proved in the appendix:\n1. We can generate a discrete point x( + ) satisfying\nH(x0)  [H(x0) H (x( + ))] +H (x⇤d).\n2. The Lagrangian yields the bound\nH(x0)  ⇤(B R(x0)) +H (x⇤d).\nImprovements. The requirement in Theorem 3.1 that the elements of ⇢⇤ be distinct may seem somewhat restrictive, but as long as ⇢⇤ has distinct elements in the neighborhood of our particular ⇤, this bound still holds. We see in Section 4.1.1 that in practice, ⇢⇤ almost always has distinct elements in the regime we care about, and the bounds of Remark 3.1 are very good.\nIf H is DR-submodular and R is affine in each coordinate, then Problem (14) can be represented more compactly via the reduction of Ene & Nguyen (2016), and hence problem (12) can be solved more efficiently. In particular, the influence function I(y;x) is DR-submodular in x when for each s, y(s) = 0 or y(s) 1."
  }, {
    "heading": "3.2. Application to Robust Budget Allocation",
    "text": "The above algorithm directly applies to Robust Allocation with the uncertainty sets in Section 2.2. The ellipsoidal uncertainty set XQ corresponds to the constraint that P\n(s,t)2E Rst(xst)  with Rst(x) = (xst x̂st)2 2 st , and x 2 Box(0, 1). By the monotonicity of I(x, y), there is never incentive to reduce any xst below x̂st, so we can replace Box(0, 1) with Box(x̂, 1). On this interval, each Rst is strictly increasing, and Theorem 3.1 applies.\nFor D-norm sets, we have Rst(xst) = (xst x̂st)/(ust x̂st). Since each Rst is monotone, Theorem 3.1 applies.\nRuntime and Alternatives. Since the core algorithm is Frank-Wolfe, it is straightforward to show that Problem (15) can be solved to \"-suboptimality in time O(\" 1n2 3↵ 1|T |2 log n 1), where ↵ is the minimum derivative of the functions Ri. If ⇢⇤ has distinct elements separated by ⌘, then choosing \" = ⌘2↵ /8 results in an exact solution to (14) in time O(⌘ 2n2 4↵ 2|T |2 log n 1).\nNoting that H + R is submodular for all , one could instead perform binary search over , each time converting the objective into a submodular set function via Birkhoff’s theorem and solving submodular minimization e.g. via one of the recent fast methods (Chakrabarty et al., 2017; Lee et al., 2015). However, we are not aware of a practical implementation of the algorithm in (Lee et al., 2015). The algorithm in (Chakrabarty et al., 2017) yields a solution in expectation. This approach also requires care in the precision of the search over , whereas our approach searches directly over the O(n 1) elements of ⇢⇤."
  }, {
    "heading": "4. Experiments",
    "text": "We evaluate our Robust Budget Allocation algorithm on both synthetic test data and a real-world bidding dataset from Yahoo! Webscope (yah) to demonstrate that our method yields real improvements. For all experiments, we\nused Algorithm 1 as the outer loop. For the inner submodular minimization step, we implemented the pairwise Frank-Wolfe algorithm of (Lacoste-Julien & Jaggi, 2015). In all cases, the feasible set of budgets Y is {y 2 RS\n+\n:\nP\ns2S y(s)  C} where the specific budget C depends on the experiment. Our code is available at git.io/vHXkO."
  }, {
    "heading": "4.1. Synthetic",
    "text": "On the synthetic data, we probe two questions: (1) how often does the distinctness condition of Theorem 3.1 hold, so that we are guaranteed an optimal solution; and (2) what is the gain of using a robust versus non-robust solution in an adversarial setting? For both settings, we set |S| = 6 and |T | = 2 and discretize with = 0.001. We generated true probabilties pst, created Beta posteriors, and built both Ellipsoidal uncertainty sets XQ( ) and D-norm sets XD( )."
  }, {
    "heading": "4.1.1. OPTIMALITY",
    "text": "Theorem 3.1 and Remark 3.1 demand that the values ⇢⇤i (j) be distinct at our chosen Lagrange multiplier ⇤ and, under this condition, guarantee optimality. We illustrate this in four examples: for Ellipsoidal or a D-norm uncertainty set, and a total influence budget C 2 {0.4, 4}. Figure 3 shows all elements of ⇢⇤ in sorted order, as well as a horizontal line indicating our Lagrange multiplier ⇤ which serves as a threshold. Despite some plateaus, the entries ⇢⇤i (j) are distinct in most regimes, in particular around ⇤, the regime that is needed for our results. Moreover, in practice (on the Yahoo data) we observe later in Figure 3 that both solutiondependent bounds from Remark 3.1 are very good, and all solutions are optimal within a very small gap."
  }, {
    "heading": "4.1.2. ROBUSTNESS AND QUALITY",
    "text": "Next, we probe the effect of a robust versus non-robust solution for different uncertainty sets and budgets of the adversary. We compare our robust solution with using a point estimate for x, i.e., y\nnom 2 argmaxy2Y I(y; x̂), treating estimates as ground truth, and the stochastic solution y\nexpect 2 argmaxy2Y E[I(y;X)] as per Section 2.1. These two optimization problems were solved via standard first-order methods using TFOCS (Becker et al., 2011).\nFigure 2 demonstrates that indeed, the alternative budgets are sensitive to the adversary and the robustly-chosen budget y\nrobust performs better, even in cases where the other budgets achieve zero influence. When the total budget C is large, y\nexpect performs nearly as well as y robust , but when resources are scarce (C is small) and the actual choice seems to matter more, y\nrobust\nperforms far better."
  }, {
    "heading": "4.2. Yahoo! data",
    "text": "To evaluate our method on real-world data, we formulate a Budget Allocation instance on advertiser bidding data from Yahoo! Webscope (yah). This dataset logs bids on 1000 different phrases by advertising accounts. We map the phrases to channels S and the accounts to customers T , with an edge between s and t if a corresponding bid was made. For each pair (s, t), we draw the associated transmission probability pst uniformly from [0, 0.4]. We bias these towards zero because we expect people not to be easily influenced by advertising in the real world. We then generate an estimate p̂st and build up a posterior by gener-\nating nst samples from Ber(pst), where nst is the number of bids between s and t in the dataset.\nThis transformation yields a bipartite graph with |S| = 1000, |T | = 10475, and more than 50,000 edges that we use for Budget Allocation. In our experiments, the typical gap between the naive y\nnom and robust y robust was 100- 500 expected influenced people. We plot convergence of the outer loop in Figure 3, where we observe fast convergence of both primal influence value and the dual bound."
  }, {
    "heading": "4.3. Comparison to first-order methods",
    "text": "Given the success of first-order methods on nonconvex problems in practice, it is natural to compare these to our method for finding the worst-case vector x. On one of our Yahoo problem instances with D-norm uncertainty set, we compared our submodular minimization scheme to FrankWolfe with fixed stepsize as in (Lacoste-Julien, 2016), implementing the linear oracle using MOSEK (MOSEK ApS, 2015). Interestingly, from various initializations, FrankWolfe finds an optimal solution, as verified by comparing to the guaranteed solution of our algorithm. Note that, due to non-convexity, there are no formal guarantees for FrankWolfe to be optimal here, motivating the question of global convergence properties of Frank-Wolfe in the presence of submodularity.\nIt is important to note that there are many cases where firstorder methods are inefficient or do not apply to our setup. These methods require either a projection oracle (PO) onto or linear optimization oracle (LO) over the feasible set X defined by `, u and R(x). The D-norm set admits a LO via linear programming, but we are not aware of any efficient LO for Ellipsoidal uncertainty, nor PO for either set, that does not require quadratic programming. Even more, our algorithm applies for nonconvex functions R(x) which induce nonconvex feasible sets X . Such nonconvex sets may not even admit a unique projection, while our algorithm achieves provable solutions."
  }, {
    "heading": "5. Conclusion",
    "text": "We address the issue of uncertain parameters (or, model misspecification) in Budget Allocation or Bipartite Influence Maximization (Alon et al., 2012) from a robust optimization perspective. The resulting Robust Budget Allocation is a nonconvex-concave saddle point problem. Although the inner optimization problem is nonconvex, we show how continuous submodularity can be leveraged to solve the problem to arbitrary accuracy \", as can be verified with the proposed bounds on the duality gap. In particular, our approach extends continuous submodular minimization methods (Bach, 2015) to more general constraint sets, introducing a mechanism to solve a new class of constrained nonconvex optimization problems. We confirm on synthetic and real data that our method finds high-quality solutions that are robust to parameters varying arbitrarily in an uncertainty set, and scales up to graphs with over 50,000 edges.\nThere are many compelling directions for further study. The uncertainty sets we use are standard in the robust optimization literature, but have not been applied to e.g. Robust Influence Maximization; it would be interesting to generalize our ideas to general graphs. Finally, despite the inherent nonconvexity of our problem, first-order methods are often able to find a globally optimal solution. Explaining this phenomenon requires further study of the geometry of constrained monotone submodular minimization."
  }, {
    "heading": "Acknowledgements",
    "text": "We thank the anonymous reviewers for their helpful suggestions. We also thank MIT Supercloud and the Lincoln Laboratory Supercomputing Center for providing computational resources. This research was conducted with Government support under and awarded by DoD, Air Force Office of Scientific Research, National Defense Science and Engineering Graduate (NDSEG) Fellowship, 32 CFR 168a, and also supported by NSF CAREER award 1553284."
  }],
  "year": 2017,
  "references": [{
    "title": "Submodular Stochastic Probing on Matroids",
    "authors": ["Adamczyk", "Marek", "Sviridenko", "Maxim", "Ward", "Justin"],
    "venue": "Mathematics of Operations Research,",
    "year": 2016
  }, {
    "title": "Optimizing Budget Allocation Among Channels and Influencers",
    "authors": ["Alon", "Noga", "Gamzu", "Iftah", "Tennenholtz", "Moshe"],
    "venue": "In WWW",
    "year": 2012
  }, {
    "title": "Polymatroids and mean-risk minimization in discrete optimization",
    "authors": ["Atamtürk", "Alper", "Narayanan", "Vishnu"],
    "venue": "Operations Research Letters,",
    "year": 2008
  }, {
    "title": "Submodular Functions: From Discrete to Continous Domains",
    "authors": ["Bach", "Francis"],
    "year": 2015
  }, {
    "title": "The power of optimization from samples",
    "authors": ["Balkanski", "Eric", "Rubinstein", "Aviad", "Singer", "Yaron"],
    "venue": "In NIPS,",
    "year": 2016
  }, {
    "title": "The limitations of optimization from samples",
    "authors": ["Balkanski", "Eric", "Rubinstein", "Aviad", "Singer", "Yaron"],
    "venue": "In STOC,",
    "year": 2017
  }, {
    "title": "Templates for convex cone problems with applications to sparse signal recovery",
    "authors": ["Becker", "Stephen R", "Candès", "Emmanuel J", "Grant", "Michael C"],
    "venue": "Mathematical programming computation,",
    "year": 2011
  }, {
    "title": "Robust solutions of Linear Programming problems contaminated with uncertain data",
    "authors": ["Ben-Tal", "Aharon", "Nemirovski", "Arkadi"],
    "venue": "Mathematical Programming,",
    "year": 2000
  }, {
    "title": "Robust Optimization",
    "authors": ["Ben-Tal", "Aharon", "El Ghaoui", "Laurent", "Nemirovski", "Arkadi"],
    "year": 2009
  }, {
    "title": "Robust discrete optimization and network flows",
    "authors": ["Bertsimas", "Dimitris", "Sim", "Melvyn"],
    "venue": "Mathematical programming,",
    "year": 2003
  }, {
    "title": "Theory and Applications of Robust Optimization",
    "authors": ["Bertsimas", "Dimitris", "Brown", "David B", "Caramanis", "Constantine"],
    "venue": "SIAM Review,",
    "year": 2011
  }, {
    "title": "Active set algorithms for isotonic regression; A unifying framework",
    "authors": ["Best", "Michael J", "Chakravarti", "Nilotpal"],
    "venue": "Mathematical Programming,",
    "year": 1990
  }, {
    "title": "Guaranteed Nonconvex Optimization: Submodular Maximization over Continuous Domains",
    "authors": ["Bian", "Andrew An", "Mirzasoleiman", "Baharan", "Buhmann", "Joachim M", "Krause", "Andreas"],
    "year": 2017
  }, {
    "title": "Maximizing Social Influence in Nearly Optimal Time",
    "authors": ["Borgs", "Christian", "Brautbar", "Michael", "Chayes", "Jennifer", "Lucier", "Brendan"],
    "venue": "In SODA,",
    "year": 2014
  }, {
    "title": "A tutorial on geometric programming",
    "authors": ["Boyd", "Stephen", "Kim", "Seung-Jean", "Vandenberghe", "Lieven", "Hassibi", "Arash"],
    "venue": "Optimization and engineering,",
    "year": 2007
  }, {
    "title": "Subquadratic submodular function minimization",
    "authors": ["Chakrabarty", "Deeparnab", "Lee", "Yin Tat", "Sidford", "Aaron", "Wong", "Sam Chiu-wai"],
    "venue": "In STOC,",
    "year": 2017
  }, {
    "title": "Relative Entropy Relaxations for Signomial Optimization",
    "authors": ["Chandrasekaran", "Venkat", "Shah", "Parikshit"],
    "venue": "SIAM Journal on Optimization,",
    "year": 2016
  }, {
    "title": "Efficient influence maximization in social networks",
    "authors": ["Chen", "Wei", "Wang", "Yajun", "Yang", "Siyu"],
    "venue": "In KDD,",
    "year": 2009
  }, {
    "title": "Scalable Influence Maximization for Prevalent Viral Marketing in Large-scale Social Networks",
    "authors": ["Chen", "Wei", "Wang", "Chi", "Yajun"],
    "venue": "In KDD,",
    "year": 2010
  }, {
    "title": "Robust influence maximization",
    "authors": ["Chen", "Wei", "Lin", "Tian", "Tan", "Zihan", "Zhao", "Mingfei", "Zhou", "Xuren"],
    "venue": "In KDD",
    "year": 2016
  }, {
    "title": "Geometric Programming for Communication Systems",
    "authors": ["Chiang", "Mung"],
    "venue": "Commun. Inf. Theory,",
    "year": 2005
  }, {
    "title": "Approximation Algorithms for Stochastic Submodular Set Cover with Applications to Boolean Function Evaluation and Min-Knapsack",
    "authors": ["Deshpande", "Amol", "Hellerstein", "Lisa", "Kletenik", "Devorah"],
    "venue": "ACM Trans. Algorithms,",
    "year": 2016
  }, {
    "title": "Mining the network value of customers",
    "authors": ["Domingos", "Pedro", "Richardson", "Matt"],
    "venue": "In KDD,",
    "year": 2001
  }, {
    "title": "Scalable influence estimation in continuoustime diffusion networks",
    "authors": ["Du", "Nan", "Song", "Le", "Gomez Rodriguez", "Manuel", "Zha", "Hongyuan"],
    "venue": "In NIPS",
    "year": 2013
  }, {
    "title": "Influence function learning in information diffusion networks",
    "authors": ["Du", "Nan", "Liang", "Yingyu", "Balcan", "Maria-Florina", "Song", "Le"],
    "venue": "In ICML,",
    "year": 2014
  }, {
    "title": "Conditional gradient algorithms with open loop step size rules",
    "authors": ["Dunn", "Joseph C", "S. Harshbarger"],
    "venue": "Journal of Mathematical Analysis and Applications,",
    "year": 1978
  }, {
    "title": "Geometric Programming: Methods, Computations and Applications",
    "authors": ["Ecker", "Joseph"],
    "venue": "SIAM Review,",
    "year": 1980
  }, {
    "title": "A Reduction for Optimizing Lattice Submodular Functions with Diminishing Returns",
    "authors": ["Ene", "Alina", "Nguyen", "Huy L"],
    "year": 2016
  }, {
    "title": "An algorithm for quadratic programming",
    "authors": ["Frank", "Marguerite", "Wolfe", "Philip"],
    "venue": "Naval Research Logistics Quarterly,",
    "year": 1956
  }, {
    "title": "Approximability of combinatorial problems with multi-agent submodular cost functions",
    "authors": ["Goel", "Gagan", "Karande", "Chinmay", "Tripathi", "Pushkar", "Wang", "Lei"],
    "venue": "In FOCS,",
    "year": 2009
  }, {
    "title": "Stochastic Covering and Adaptivity",
    "authors": ["Goemans", "Michel", "Vondrák", "Jan"],
    "venue": "In LATIN 2006: Theoretical Informatics. Springer Berlin Heidelberg,",
    "year": 2006
  }, {
    "title": "Adaptive Submodularity: Theory and Applications in Active Learning and Stochastic Optimization",
    "authors": ["Golovin", "Daniel", "Krause", "Andreas"],
    "venue": "Journal of Artificial Intelligence,",
    "year": 2011
  }, {
    "title": "Influence maximization in continuous time diffusion networks",
    "authors": ["Gomez Rodriguez", "Manuel", "Schölkopf", "Bernhard"],
    "venue": "In ICML,",
    "year": 2012
  }, {
    "title": "Inferring networks of diffusion and influence",
    "authors": ["Gomez Rodriguez", "Manuel", "Leskovec", "Jure", "Krause", "Andreas"],
    "venue": "In KDD,",
    "year": 2010
  }, {
    "title": "Submodular function maximization on the bounded integer lattice",
    "authors": ["Gottschalk", "Corinna", "Peis", "Britta"],
    "venue": "In Approximation and Online Algorithms: 13th International Workshop (WAOA),",
    "year": 2015
  }, {
    "title": "Submodular optimization under noise",
    "authors": ["Hassidim", "Avinatan", "Singer", "Yaron"],
    "venue": "arXiv preprint arXiv:1601.03095,",
    "year": 2016
  }, {
    "title": "Lagrangian Decomposition Algorithm for Allocating Marketing Channels",
    "authors": ["Hatano", "Daisuke", "Fukunaga", "Takuro", "Maehara", "Takanori", "Kawarabayashi", "Ken-ichi"],
    "venue": "In AAAI,",
    "year": 2015
  }, {
    "title": "Robust influence maximization",
    "authors": ["He", "Xinran", "Kempe", "David"],
    "venue": "In KDD",
    "year": 2016
  }, {
    "title": "Submodular function minimization under covering constraints",
    "authors": ["Iwata", "Satoru", "Nagano", "Kiyohito"],
    "venue": "In FOCS,",
    "year": 2009
  }, {
    "title": "Revisiting Frank-Wolfe: Projection-Free Sparse Convex Optimization",
    "authors": ["Jaggi", "Martin"],
    "venue": "In ICML,",
    "year": 2013
  }, {
    "title": "Maximizing the Spread of Influence Through a Social Network",
    "authors": ["Kempe", "David", "Kleinberg", "Jon", "Tardos", "Éva"],
    "venue": "In KDD,",
    "year": 2003
  }, {
    "title": "Supermodular programming on finite lattices",
    "authors": ["Khachaturov", "Vladimir R", "Roman V", "Ruben V"],
    "venue": "Computational Mathematics and Mathematical Physics,",
    "year": 2012
  }, {
    "title": "New algorithms for convex cost tension problem with application to computer vision",
    "authors": ["Kolmogorov", "Vladimir", "Shioura", "Akiyoshi"],
    "venue": "Discrete Optimization,",
    "year": 2009
  }, {
    "title": "Robust submodular observation selection",
    "authors": ["Krause", "Andreas", "McMahan", "H Brendan", "Guestrin", "Carlos", "Gupta", "Anupam"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2008
  }, {
    "title": "Convergence Rate of Frank-Wolfe for Non-Convex Objectives",
    "authors": ["Lacoste-Julien", "Simon"],
    "year": 2016
  }, {
    "title": "On the global linear convergence of Frank-Wolfe optimization variants",
    "authors": ["Lacoste-Julien", "Simon", "Jaggi", "Martin"],
    "venue": "In NIPS,",
    "year": 2015
  }, {
    "title": "A faster cutting plane method and its implications for combinatorial and convex optimization",
    "authors": ["Lee", "Yin Tat", "Sidford", "Aaron", "Wong", "Sam Chiu-wai"],
    "venue": "In FOCS,",
    "year": 2015
  }, {
    "title": "Robust Influence Maximization: (Extended Abstract)",
    "authors": ["Lowalekar", "Meghna", "Varakantham", "Pradeep", "Kumar", "Akshat"],
    "venue": "In AAMAS,",
    "year": 2016
  }, {
    "title": "Risk averse submodular utility maximization",
    "authors": ["Maehara", "Takanori"],
    "venue": "Operations Research Letters,",
    "year": 2015
  }, {
    "title": "Budget Allocation Problem with Multiple Advertisers: A Game Theoretic View",
    "authors": ["Maehara", "Takanori", "Yabe", "Akihiro", "Kawarabayashi", "Ken-ichi"],
    "venue": "In ICML,",
    "year": 2015
  }, {
    "title": "Discrete convex analysis",
    "authors": ["Murota", "Kazuo"],
    "year": 2003
  }, {
    "title": "Exact bounds for steepest descent algorithms of l-convex function minimization",
    "authors": ["Murota", "Kazuo", "Shioura", "Akiyoshi"],
    "venue": "Operations Research Letters,",
    "year": 2014
  }, {
    "title": "Size-constrained submodular minimization through minimum norm base",
    "authors": ["Nagano", "Kiyohito", "Kawahara", "Yoshinobu", "Aihara", "Kazuyuki"],
    "venue": "In ICML,",
    "year": 2011
  }, {
    "title": "Learnability of influence in networks",
    "authors": ["Narasimhan", "Harikrishna", "Parkes", "David C", "Singer", "Yaron"],
    "venue": "In NIPS",
    "year": 2015
  }, {
    "title": "Learning the graph of epidemic cascades",
    "authors": ["Netrapalli", "Praneeth", "Sanghavi", "Sujay"],
    "venue": "In SIGMETRICS",
    "year": 2012
  }, {
    "title": "Approximation algorithms for reliable stochastic combinatorial optimization",
    "authors": ["Nikolova", "Evdokia"],
    "venue": "In APPROX",
    "year": 2010
  }, {
    "title": "Robust monotone submodular function maximization",
    "authors": ["Orlin", "James B", "Schulz", "Andreas", "Udwani", "Rajan"],
    "venue": "In IPCO,",
    "year": 2016
  }, {
    "title": "Constrained maximization of posynomials by geometric programming",
    "authors": ["Pascual", "Luis D", "Ben-Israel", "Adi"],
    "venue": "Journal of Optimization Theory and Applications,",
    "year": 1970
  }, {
    "title": "Introduction to Optimization",
    "authors": ["Polyak", "Boris T"],
    "venue": "Number 04;",
    "year": 1987
  }, {
    "title": "Optimization of conditional value-at-risk",
    "authors": ["Rockafellar", "R Tyrrell", "Uryasev", "Stanislav"],
    "venue": "Journal of risk,",
    "year": 2000
  }, {
    "title": "Conditional value-at-risk for general loss distributions",
    "authors": ["Rockafellar", "R Tyrrell", "Uryasev", "Stanislav"],
    "venue": "Journal of banking & finance,",
    "year": 2002
  }, {
    "title": "A Generalization of Submodular Cover via the Diminishing Return Property on the Integer Lattice",
    "authors": ["Soma", "Tasuku", "Yoshida", "Yuichi"],
    "venue": "In NIPS,",
    "year": 2015
  }, {
    "title": "Optimal Budget Allocation: Theoretical Guarantee and Efficient Algorithm",
    "authors": ["Soma", "Tasuku", "Kakimura", "Naonori", "Inaba", "Kazuhiro", "Kawarabayashi", "Ken-ichi"],
    "venue": "In ICML,",
    "year": 2014
  }, {
    "title": "Submodular approximation: Sampling-based algorithms and lower bounds",
    "authors": ["Svitkina", "Zoya", "Fleischer", "Lisa"],
    "venue": "SIAM Journal on Computing,",
    "year": 2011
  }, {
    "title": "Minimizing a submodular function on a lattice",
    "authors": ["Topkis", "Donald M"],
    "venue": "Operations research,",
    "year": 1978
  }, {
    "title": "Fundamental Methods of Mathematical Economics",
    "authors": ["Wainwright", "Kevin", "Chiang", "Alpha"],
    "venue": "McGraw-Hill Education,",
    "year": 2004
  }],
  "id": "SP:2a754269c61375bd43ae7a0edcbdc5c68dccaf95",
  "authors": [{
    "name": "Matthew Staib",
    "affiliations": []
  }, {
    "name": "Stefanie Jegelka",
    "affiliations": []
  }],
  "abstractText": "The optimal allocation of resources for maximizing influence, spread of information or coverage, has gained attention in the past years, in particular in machine learning and data mining. But in applications, the parameters of the problem are rarely known exactly, and using wrong parameters can lead to undesirable outcomes. We hence revisit a continuous version of the Budget Allocation or Bipartite Influence Maximization problem introduced by Alon et al. (2012) from a robust optimization perspective, where an adversary may choose the least favorable parameters within a confidence set. The resulting problem is a nonconvex-concave saddle point problem (or game). We show that this nonconvex problem can be solved exactly by leveraging connections to continuous submodular functions, and by solving a constrained submodular minimization problem. Although constrained submodular minimization is hard in general, here, we establish conditions under which such a problem can be solved to arbitrary precision ✏.",
  "title": "Robust Budget Allocation via Continuous Submodular Functions"
}