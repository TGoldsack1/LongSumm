{
  "sections": [{
    "heading": "1. Introduction",
    "text": "Multi-relational embedding, or knowledge graph embedding, is the task of finding the latent representations of entities and relations for better inference over knowledge graphs. This problem has become increasingly important in recent machine learning due to the broad range of important applications of large-scale knowledge bases, such as Freebase (Bollacker et al., 2008), DBpedia (Auer et al., 2007) and Google’s Knowledge Graph (Singhal, 2012), including question-answering (Ferrucci et al., 2010), information retrieval (Dalton et al., 2014) and natural language processing (Gabrilovich & Markovitch, 2009).\nA knowledge base (KB) typically stores factual information as subject-relation-object triplets. The collection of such triplets forms a directed graph whose nodes are entities and whose edges are the relations among entities. Real-\n1Carnegie Mellon University, Pittsburgh, PA 15213, USA. Correspondence to: Hanxiao Liu <hanxiaol@cs.cmu.edu>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nworld knowledge graph is both extremely large and highly incomplete by nature (Min et al., 2013). How can we use the observed triplets in an incomplete graph to induce the unobserved triples in the graph presents a tough challenge for machine learning research.\nVarious statistical relational learning methods (Getoor, 2007; Nickel et al., 2015) have been proposed for this task, among which vector-space embedding models are most particular due to their advantageous performance and scalability (Bordes et al., 2013). The key idea in those approaches is to find dimensionality reduced representations for both the entities and the relations, and hence force the models to generalize during the course of compression. Representative models of this kind include tensor factorization (Singhal, 2012; Nickel et al., 2011), neural tensor networks (Socher et al., 2013; Chen et al., 2013), translationbased models (Bordes et al., 2013; Wang et al., 2014; Lin et al., 2015b), bilinear models and its variants (Yang et al., 2014; Trouillon et al., 2016), pathwise methods (Guu et al., 2015), embeddings based on holographic representations (Nickel et al., 2016), and product graphs that utilizes additional site information for the predictions of unseen edges in a semi-supervised manner (Liu & Yang, 2015; 2016).\nLearning the embeddings of entities and relations can be viewed as a knowledge induction process, as those induced latent representations can be used to make inference about new triplets that have not been seen before.\nDespite the substantial efforts and great successes so far in the research on multi-relational embedding, one important aspect is missing, i.e., to study the solutions of the problem from the analogical inference point of view, by which we mean to rigorously define the desirable analogical properties for multi-relational embedding of entities and relations, and to provide algorithmic solution for optimizing the embeddings w.r.t. the analogical properties. We argue that analogical inference is particularly desirable for knowledge base completion, since for instance if system A (a subset of entities and relations) is analogous to system B (another subset of entities and relations), then the unobserved triples inB could be inferred by mirroring their counterparts inA. Figure 1 uses a toy example to illustrate the intuition, where system A corresponds to the solar system with three concepts (entities), and systemB corresponds the atom system with another three concepts. An analogy exists between the two systems because B is a “miniature” of A. As a result, knowing how the entities are related to each other in system A allows us to make inference about how the entities are related to each other in system B by analogy.\nAlthough analogical reasoning was an active research topic in classic AI (artificial intelligence), early computational models mainly focused on non-differentiable rulebased reasoning (Gentner, 1983; Falkenhainer et al., 1989; Turney, 2008), which can hardly scale to very large KBs such as Freebase or Google’s Knowledge Graph. How to leverage the intuition of analogical reasoning via statistical inference for automated embedding of very large knowledge graphs has not been studied so far, to our knowledge.\nIt is worth mentioning that analogical structures have been observed in the output of several word/entity embedding models (Mikolov et al., 2013; Pennington et al., 2014). However, those observations stopped there as merely empirical observations. Can we mathematically formulate the desirable analogical structures and leverage them in our objective functions to improve multi-relational embedding? In this case, can we develop new algorithms for tractable inference for the embedding of very large knowledge graphs? These questions present a fundamental challenge which has not been addressed by existing work, and answering these questions are the main contributions we aim in this paper. We name this open challenge as the analogical inference problem, for the distinction from rule-based analogical reasoning in classic AI.\nOur specific novel contributions are the following:\n1. A new framework that, for the first time, explicitly\nmodels analogical structures in multi-relational embedding, and that improves the state-of-the-art performance on benchmark datasets;\n2. The algorithmic solution for conducting analogical inference in a differentiable manner, whose implementation is as scalable as the fastest known relational embedding algorithms;\n3. The theoretical insights on how our framework provides a unified view of several representative methods as its special (and restricted) cases, and why the generalization of such cases lead to the advantageous performance of our method as empirically observed.\nThe rest of this paper is organized as follows: §2 introduces related background where multi-relational embedding is formulated as linear maps. §3 describes our new optimization framework where the desirable analogical structures are rigorously defined by the the commutative property of linear maps. §4 offers an efficient algorithm for scalable inference by exploiting the special structures of commutative linear maps, §5 shows how our framework subsumes several representative approaches in a principled way, and §6 reports our experimental results, followed by the concluding remarks in §7."
  }, {
    "heading": "2. Related Background",
    "text": ""
  }, {
    "heading": "2.1. Notations",
    "text": "Let E and R be the space of all entities and their relations. A knowledge base K is a collection of triplets (s, r, o) ∈ K where s ∈ E , o ∈ E , r ∈ R stand for the subject, object and their relation, respectively. Denote by v ∈ R|E|×m a look-up table where ve ∈ Rm is the vector embedding for entity e, and denote by tensor W ∈ R|R|×m×m another look-up table where Wr ∈ Rm×m is the matrix embedding for relation r. Both v and W are to be learned from K."
  }, {
    "heading": "2.2. Relations as Linear Maps",
    "text": "We formulate each relation r as a linear map that, for any given (s, r, o) ∈ K, transforms the subject s from its original position in the vector space to somewhere near the object o. In other words, we expect the latent representations for any valid (s, r, o) to satisfy\nv>s Wr ≈ v>o (1)\nThe degree of satisfaction in the approximated form of (1) can be quantified using the inner product of v>s Wr and vo. That is, we define a bilinear score function as:\nφ(s, r, o) = 〈v>s Wr, vo〉 = v>s Wrvo (2)\nOur goal is to learn v and W such that φ(s, r, o) gives high scores to valid triples, and low scores to the invalid ones.\nIn contrast to some previous models (Bordes et al., 2013) where relations are modeled as additive translating operators, namely vs + wr ≈ vo, the multiplicative formulation in (1) offers a natural analogy to the first-order logic where each relation is treated as a predicate operator over input arguments (subject and object in our case). Clearly, the linear transformation defined by a matrix, a.k.a. a linear map, is a richer operator than the additive transformation defined by a vector. Multiplicative models are also found to substantially outperform additive models empirically (Nickel et al., 2011; Yang et al., 2014)."
  }, {
    "heading": "2.3. Normal Transformations",
    "text": "Instead of allowing arbitrary linear maps to be used for representing relations, a particular family of matrices has been studied for “well-behaved” linear maps. This family is named as the normal matrices. Definition 2.1 (Normal Matrix). A real matrixA is normal if and only if A>A = AA>.\nNormal matrices have nice theoretical properties which are often desirable form relational modeling, e.g., they are unitarily diagonalizable and hence can be conveniently analyzed by the spectral theorem (Dunford et al., 1971). Representative members of the normal family include:\n• Symmetric Matrices for which WrW>r = W>r Wr = W 2r . These includes all diagonal matrices and positive semi-definite matrices, and the symmetry implies φ(s, r, o) = φ(o, r, s). They are suitable for modeling symmetric relations such as is identical.\n• Skew-/Anti-symmetric Matrices for which WrW>r = W>r Wr = −W 2r , which implies φ(s, r, o) = −φ(o, r, s). These matrices are suitable for modeling asymmetric relations such as is parent of .\n• Rotation Matrices for which WrW>r = W>r Wr = Im, which suggests that the relation r is invertible as W−1r always exists. Rotation matrices are suitable for modeling 1-to-1 relationships (bijections).\n• Circulant Matrices (Gray et al., 2006), which have been implicitly used in recent work on holographic representations (Nickel et al., 2016). These matrices are usually related to the learning of latent representations in the Fourier domain (see §5 for more details).\nIn the remaining parts of this paper, we denote all the real normal matrices in Rm×m as Nm(R)."
  }, {
    "heading": "3. Proposed Analogical Inference Framework",
    "text": "Analogical reasoning is known to play a central role in human induction about knowledge (Gentner, 1983; Minsky,\n1988; Holyoak et al., 1996; Hofstadter, 2001). Here we provide a mathematical formulation of the analogical structures of interest in multi-relational embedding in a latent semantic space, to support algorithmic inference about the embeddings of entities and relations in a knowledge graph."
  }, {
    "heading": "3.1. Analogical Structures",
    "text": "Consider the famous example in the word embedding literature (Mikolov et al., 2013; Pennington et al., 2014), for the following entities and relations among them:\n“man is to king as woman is to queen”\nIn an abstract notion we denote the entities by a (as man) , b (as king), c (as woman) and d (as queen), and the relations by r (as crown) and r′ (asmale 7→ female), respectively. These give us the subject-relation-object triplets as follows:\na r→ b, c r→ d, a r\n′ → c, b r ′ → d (3)\nFor multi-relational embeddings, r and r′ are members of R and are modeled as linear maps in our case.\nThe relational maps in (3) can be visualized using a commutative diagram (Adámek et al., 2004; Brown & Porter, 2006) from the Category Theory, as shown in Figure 2, where each node denotes an entity and each edge denotes a linear map that transforms one entity to the other. We also refer to such a diagram as a “parallelogram” to highlight its particular algebraic structure1.\nThe parallelogram in Figure 2 represents a very basic analogical structure which could be informative for the inference about unknown facts (triplets). To get a sense about why analogies would help in the inference about unobserved facts, we notice that for entities a, b, c, d which form an analogical structure in our example, the parallelogram structure is fully determined by symmetry. This means that if we know a r→ b and a r ′\n→ c, then we can induce the remaining triplets of c r→ d and b r ′\n→ d. In other words, understanding the relation betweenman and king helps us to fill up the unknown relation between woman and queen.\n1Notice that this is different from parallelograms in the geometric sense because each edge here is a linear map instead of the difference between two nodes in the vector space.\nAnalogical structures are not limited to parallelograms, of course, though parallelograms often serve as the building blocks for more complex analogical structures. As an example, in Figure 1 of §1 we show a compound analogical structure in the form of a triangular prism, for mirroring the correspondent entities/relations between the atom system and the solar system. Formally define the desirable analogical structures in a computationally tractable objective for optimization is the key for solving our problem, which we will introduce next."
  }, {
    "heading": "3.2. Commutative Constraint for Linear Maps",
    "text": "Although it is tempting to explore all potentially interesting parallelograms in the modeling of analogical structure, it is computationally intractable to examine the entire powerset of entities as the candidate space of analogical structures. A more reasonable strategy is to identify some desirable properties of the analogical structures we want to model, and use those properties as constraints for reducing the candidate space.\nAn desirable property of the linear maps we want is that all the directed paths with the same starting node and end node form the compositional equivalence. Denoting by “◦” the composition operator between two relations, the parallelogram in Figure 2 contains two equivalent compositions as:\nr ◦ r′ = r′ ◦ r (4) which means that a is connected to d via either path. We call this the commutativity property of the linear maps, which is a necessary condition for forming commutative parallelograms and therefore the corresponding analogical structures. Yet another example is given by Figure 1, where sun can traverse to charge along multiple alternative paths of length three, implying the commutativity of relations surrounded by, made of , scale down.\nThe composition of two relations (linear maps) is naturally implemented via matrix multiplication (Yang et al., 2014; Guu et al., 2015), hence equation (4) indicates\nWr◦r′ =WrWr′ =Wr′Wr (5)\nOne may further require the commutative constraint (5) to be satisfied for any pair of relations inR because they may be simultaneously present in the same commutative parallelogram for certain subsets of entities. In this case, we say the relations inR form a commuting family.\nIt is worth mentioning thatNm(R) is not closed under matrix multiplication. As the result, the composition rule in eq. (5) may not always yield a legal new relation—Wr◦r′ may no longer be a normal matrix. However, any commuting family inNm(R) is indeed closed under multiplication. This explains the necessity of having a commuting family of relations from an alternative perspective."
  }, {
    "heading": "3.3. The Optimization Objective",
    "text": "The generic goal for multi-relational embedding is to find entity and relation representations such that positive triples labeled as y = +1 receive higher score than the negative triples labeled as y = −1. This can be formulated as\nmin v,W\nEs,r,o,y∼D ` (φv,W (s, r, o), y) (6)\nwhere φv,W (s, r, o) = v>s Wrvo is our score function based on the embeddings, ` is our loss function, and D is the data distribution constructed based on the training set K.\nTo impose analogical structures among the representations, we in addition require the linear maps associated with relations to form a commuting family of normal matrices. This gives us the objective function for ANALOGY:\nmin v,W\nEs,r,o,y∼D ` (φv,W (s, r, o), y) (7)\ns.t. WrW>r =W > r Wr ∀r ∈ R (8)\nWrWr′ =Wr′Wr ∀r, r′ ∈ R (9)\nwhere constraints (8) and (9) are corresponding to the normality and commutativity requirements, respectively. Such a constrained optimization may appear to be computationally expensive at the first glance. In §4, however, we will recast it as a simple lightweight problem for which each SGD update can be carried out efficiently in O(m) time."
  }, {
    "heading": "4. Efficient Inference Algorithm",
    "text": "The constrained optimization (7) is computationally challenging due to the large number of model parameters in tensor W , the matrix normality constraints, and the quadratic number of pairwise commutative constraints in (9).\nInterestingly, by exploiting the special properties of commuting normal matrices, we will show in Corollary 4.2.1 that ANALOGY can be alternatively solved via an another formulation of substantially lower complexity. Our findings are based on the following lemma and theorem:\nLemma 4.1. (Wilkinson & Wilkinson, 1965) For any real normal matrix A, there exists a real orthogonal matrix Q and a block-diagonal matrix B such that A = QBQ>, where each diagonal block of B is either (1) A real scalar,\nor (2) A 2-dimensional real matrix in the form of [ x −y y x ] , where both x, y are real scalars.\nThe lemma suggests any real normal matrix can be blockdiagonalized into an almost-diagonal canonical form.\nTheorem 4.2 (Proof given in the supplementary material). If a set of real normal matrices A1, A2, ... form a commuting family, namely AiAj = AjAi ∀i, j, then they can be block-diagonalized by the same real orthogonal basis Q.\nThe theorem above implies that the set of dense relational matrices {Wr}r∈R, if mutually commutative, can always be simultaneously block-diagonalized into another set of sparse almost-diagonal matrices {Br}r∈R. Corollary 4.2.1 (Alternative formulation for ANALOGY). For any given solution (v∗,W ∗) of optimization (7), there always exists an alternative set of embeddings (u∗, B∗) such that φv∗,W∗(s, r, o) ≡ φu∗,B∗(s, r, o), ∀(s, r, o), and (u∗, B∗) is given by the solution of:\nmin u,B\nEs,r,o,y∼D ` (φu,B(s, r, o), y) (10)\nBr ∈ Bnm ∀r ∈ R (11)\nwhere Bnm denotes all m×m almost-diagonal matrices in Lemma 4.1 with n < m real scalars on the diagonal.\nproof sketch. With the commutative constraints, there must exist some orthogonal matrix Q, such that Wr = QBrQ>, Br ∈ Bnm, ∀r ∈ R. We can plug-in these expressions into optimization (7) and let u = vQ, obtaining\nφv,W (s, r, o) =v > s Wrvo = v > s QBrQ >vo (12)\n=u>s Bruo = φu,B(s, r, o) (13)\nIn addition, it is not hard to verify that constraints (8) and (9) are automatically satisfied by exploiting the facts thatQ is orthogonal and Bnm is a commutative normal family.\nConstraints (11) in the alternative optimization problem can be handled by simply binding together the coefficients within each of those 2× 2 blocks in Br. Note that each Br consists of only m free parameters, allowing the gradient w.r.t. any given triple to be efficiently evaluated in O(m)."
  }, {
    "heading": "5. Unified View of Representative Methods",
    "text": "In the following we provide a unified view of several embedding models (Yang et al., 2014; Trouillon et al., 2016; Nickel et al., 2016), by showing that they are restricted versions under our framework, hence are implicitly imposing analogical properties. This explains their strong empirical performance as compared to other baselines (§6)."
  }, {
    "heading": "5.1. DistMult",
    "text": "DistMult (Yang et al., 2014) embeds both entities and relations as vectors, and defines the score function as\nφ(s, r, o) = 〈vs, vr, vo〉 (14) where vs, vr, vo ∈ Rm,∀s, r, o (15)\nwhere 〈·, ·, ·〉 denotes the generalized inner product. Proposition 5.1. DistMult embeddings can be fully recovered by ANALOGY embeddings when n = m.\nProof. This is trivial to verify as the score function (15) can be rewritten as φ(s, r, o) = v>s Brvo whereBr is a diagonal matrix given by Br = diag(vr).\nEntity analogies are encouraged in DistMult as the diagonal matrices diag(vr)’s are both normal and mutually commutative. However, DistMult is restricted to model symmetric relations only, since φ(s, r, o) ≡ φ(o, r, s)."
  }, {
    "heading": "5.2. Complex Embeddings (ComplEx)",
    "text": "ComplEx (Trouillon et al., 2016) extends the embeddings to the complex domain C, which defines\nφ(s, r, o) = < (〈vs, vr, vo〉) (16) where vs, vr, vo ∈ Cm,∀s, r, o (17)\nwhere x denotes the complex conjugate of x. Proposition 5.2. ComplEx embeddings of embedding size m can be fully recovered by ANALOGY embeddings of embedding size 2m when n = 0.\nProof. Let <(x) and =(x) be the real and imaginary parts of any complex vector x. We recast φ in (16) as\nφ(r, s, o) = + 〈 <(vr),<(vs),<(vo) 〉 (18)\n+ 〈 <(vr),=(vs),=(vo) 〉 (19)\n+ 〈 =(vr),<(vs),=(vo) 〉 (20)\n− 〈 =(vr),=(vs),<(vo) 〉 = v′s > Brv ′ o (21)\nThe last equality is obtained via a change of variables: For any complex entity embedding v ∈ Cm, we define a new real embedding v′ ∈ R2m such that{\n(v′)2k = <(v)k (v′)2k−1 = =(v)k ∀k = 1, 2, . . .m (22)\nThe corresponding Br is a block-diagonal matrix in B02m with its k-th block given by [ <(vr)k −=(vr)k =(vr)k <(vr)k ] ."
  }, {
    "heading": "5.3. Holographic Embeddings (HolE)",
    "text": "HolE (Nickel et al., 2016) defines the score function as\nφ(s, r, o) = 〈vr, vs ∗ vo〉 (23) where vs, vr, vo ∈ Rm,∀s, r, o (24)\nwhere the association of s and o is implemented via circular correlation denoted by ∗. This formulation is motivated by the holographic reduced representation (Plate, 2003).\nTo relate HolE with ANALOGY, we rewrite (24) in a bilinear form with a circulant matrix C(vr) in the middle\nφ(r, s, o) = v>s C(vr)vo (25)\nwhere entries of a circulant matrix are defined as\nC(x) =  x1 xm · · · x3 x2 x2 x1 xm x3 ... x2 x1 . . . ...\nxm−1 . . . . . . xm\nxm xm−1 · · · x2 x1\n (26)\nIt is not hard to verify that circulant matrices are normal and commute (Gray et al., 2006), hence entity analogies are encouraged in HolE, for which optimization (7) reduces to an unconstrained problem as equalities (8) and (9) are automatically satisfied when all Wr’s are circulant.\nThe next proposition further reveals that HolE is equivalent to ComplEx with minor relaxation.\nProposition 5.3. HolE embeddings can be equivalently obtained using the following score function\nφ(s, r, o) = < (〈vs, vr, vo〉) (27) where vs, vr, vo ∈ F(Rm),∀s, r, o (28)\nwhere F(Rm) denotes the image of Rm in Cm through the Discrete Fourier Transform (DFT). In particular, the above reduces to ComplEx by relaxing F(Rm) to Cm.\nProof. Let F be the DFT operator defined by F(x) = Fx where F ∈ Cm×m is called the Fourier basis of DFT. A well-known property for circulant matrices is that anyC(x) can always be diagonalized by F , and its eigenvalues are given by Fx (Gray et al., 2006).\nHence the score function can be further recast as\nφ(r, s, o) = v>s F −1 diag(Fvr)Fvo (29)\n= 1\nm (Fvs)\n> diag(Fvr)(Fvo) (30)\n= 1\nm 〈F(vs),F(vr),F(vo)〉 (31) = < [ 1\nm 〈F(vs),F(vr),F(vo)〉\n] (32)\nLet v′s = F(vs), v ′ o = F(vo) and v ′ r = 1 mF(vr), we obtain exactly the same score function as used in ComplEx\nφ(s, r, o) = < ( 〈v′s, v′r, v′o〉 ) (33)\n(33) is equivalent to (16) apart from an additional constraint that v′s, v ′ r, v ′ o are the image of R in the Fourier domain."
  }, {
    "heading": "6. Experiments",
    "text": ""
  }, {
    "heading": "6.1. Datasets",
    "text": "We evaluate ANALOGY and the baselines over two benchmark datasets for multi-relational embedding released by\nprevious work (Bordes et al., 2013), namely a subset of Freebase (FB15K) for generic facts and WordNet (WN18) for lexical relationships between words.\nThe dataset statistics are summarized in Table 1."
  }, {
    "heading": "6.2. Baselines",
    "text": "We compare the performance of ANALOGY against a variety types of multi-relational embedding models developed in recent years. Those models can be categorized as:\n• Translation-based models where relations are modeled as translation operators in the embedding space, including TransE (Bordes et al., 2013) and its variants TransH (Wang et al., 2014), TransR (Lin et al., 2015b), TransD (Ji et al., 2015), STransE (Nguyen et al., 2016) and RTransE (Garcia-Duran et al., 2015).\n• Multi-relational latent factor models including LFM (Jenatton et al., 2012) and RESCAL (Nickel et al., 2011) based collective matrix factorization.\n• Models involving neural network components such as neural tensor networks (Socher et al., 2013) and PTransE-RNN (Lin et al., 2015b), where RNN stands for recurrent neural networks.\n• Pathwise models including three different variants of PTransE (Lin et al., 2015a) which extend TransE by explicitly taking into account indirect connections (relational paths) between entities.\n• Models subsumed under our proposed framework (§5), including DistMult (Yang et al., 2014) based simple multiplicative interactions, ComplEx (Trouillon et al., 2016) using complex coefficients and HolE (Nickel et al., 2016) based on holographic representations. Those models are implicitly leveraging analogical structures per our previous analysis.\n• Models enhanced by external side information. We use Node+LinkFeat (NLF) (Toutanova & Chen, 2015) as a representative example, which leverages textual mentions derived from the ClueWeb corpus."
  }, {
    "heading": "6.3. Evaluation Metrics",
    "text": "Following the literature of multi-relational embedding, we use the conventional metrics of Hits@k and Mean Reciprocal Rank (MRR) which evaluate each system-produced\nranked list for each test instance and average the scores over all ranked lists for the entire test set of instances.\nThe two metrics would be flawed for the negative instances created in the test phase as a ranked list may contain some positive instances in the training and validation sets (Bordes et al., 2013). A recommended remedy, which we followed, is to remove all training- and validation-set triples from all ranked lists during testing. We use “filt.” and “raw” to indicate the evaluation metrics with or without filtering, respectively.\nIn the first set of our experiments, we used on Hits@k with k=10, which has been reported for most methods in the literature. We also provide additional results of ANALOGY and a subset of representative baseline methods using MRR, Hits@1 and Hits@3, to enable the comparison with the methods whose published results are in those metrics."
  }, {
    "heading": "6.4. Implementation Details",
    "text": ""
  }, {
    "heading": "6.4.1. LOSS FUNCTION",
    "text": "We use the logistic loss for ANALOGY throughout all experiments, namely `(φ(s, r, o), y) = − log σ(yφ(s, r, o)), where σ is the sigmoid activation function. We empirically found this simple loss function to perform reasonably well as compared to more sophisticated ranking loss functions."
  }, {
    "heading": "6.4.2. ASYNCHRONOUS ADAGRAD",
    "text": "Our C++ implementation2 runs over a CPU, as ANALOGY only requires lightweight linear algebra routines. We use asynchronous stochastic gradient descent (SGD) for optimization, where the gradients with respect to different mini-batches are simultaneously evaluated in multiple threads, and the gradient updates for the shared model parameters are carried out without synchronization. Asynchronous SGD is highly efficient, and causes little performance drop when parameters associated with different mini-batches are mutually disjoint with a high probability (Recht et al., 2011). We adapt the learning rate based on historical gradients using AdaGrad (Duchi et al., 2011)."
  }, {
    "heading": "6.4.3. CREATION OF NEGATIVE SAMPLES",
    "text": "Since only valid triples (positive instances) are explicitly given in the training set, invalid triples (negative instances) need to be artificially created. Specifically, for every positive example (s, r, o), we generate three negative instances (s′, r, o), (s, r′, o), (s, r, o′) by corrupting s, r, o with random entities/relations s′ ∈ E , r′ ∈ R, o′ ∈ E . The union of all positive and negative instances defines our data distribution D for SGD updates.\n2Code available at https://github.com/quark0/ANALOGY."
  }, {
    "heading": "6.4.4. MODEL SELECTION",
    "text": "We conducted a grid search to find the hyperparameters of ANALOGY which maximize the filtered MRR on the validation set, by enumerating all combinations of the embedding size m ∈ {100, 150, 200}, `2 weight decay factor λ ∈ {10−1, 10−2, 10−3} of model coefficients v and W , and the ratio of negative over positive samples α ∈ {3, 6}. The resulting hyperparameters for the WN18 dataset are m = 200, λ = 10−2, α = 3, and those for the FB15K dataset are m = 200, λ = 10−3, α = 6. The number of scalars on the diagonal of each Br is always set to be m2 . We set the initial learning rate to be 0.1 for both datasets and adjust it using AdaGrad during optimization. All models are trained for 500 epochs."
  }, {
    "heading": "6.5. Results",
    "text": "Table 2 compares the Hits@10 score of ANALOGY with that of 23 competing methods using the published scores\nTable 3. MRR and Hits@{1,3} of a subset of representative models on WN18 and FB15K. The performance scores of TransE and REACAL are cf. the results published in (Trouillon et al., 2016) and (Nickel et al., 2016), respectively.\nWN18 FB15\nModels MRR (filt.) MRR (raw) Hits@1 (filt.) Hits@3 (filt.) MRR (filt.) MRR (raw) Hits@1 (filt.) Hits@3 (filt.)\nRESCAL (Nickel et al., 2011) 89.0 60.3 84.2 90.4 35.4 18.9 23.5 40.9 TransE (Bordes et al., 2013) 45.4 33.5 8.9 82.3 38.0 22.1 23.1 47.2 DistMult (Yang et al., 2014) 82.2 53.2 72.8 91.4 65.4 24.2 54.6 73.3 HolE (Nickel et al., 2016) 93.8 61.6 93.0 94.5 52.4 23.2 40.2 61.3 ComplEx (Trouillon et al., 2016) 94.1 58.7 93.6 94.5 69.2 24.2 59.9 75.9\nOur ANALOGY 94.2 65.7 93.9 94.4 72.5 25.3 64.6 78.5\nfor these methods in the literature on the WN18 and FB15K datasets. For the methods not having both scores, the missing slots are indicated by “–”. The best score on each dataset is marked in the bold face; if the differences among the top second or third scores are not statistically significant from the top one, then these scores are also bold faced. We used one-sample proportion test (Yang & Liu, 1999) at the 5% p-value level for testing the statistical significances3.\nTable 3 compares the methods (including ours) whose results in additional metrics are available. The usage of the bold faces is the same as those in Table 2.\nIn both tables, ANALOGY performs either the best or the 2nd best which is in the equivalent class with the best score in each case according statistical significance test. Specifically, on the harder FB15K dataset in Table 2, which has a very large number of relations, our model outperforms all baseline methods. These results provide a good evidence for the effective modeling of analogical structures in our approach. We are pleased to see in Table 3 that ANALOGY outperforms DistMult, ComplEx and HolE in all the metrics, as the latter three can be viewed as more constrained versions of our method (as discussed in (§5)). Furthermore, our assertion on HolE for being a special case of ComplEx (§5) is justified in the same table by the fact that the performance of HolE is dominated by ComplEx.\nIn Figure 3 we show the empirical scalability of ANALOGY, which not only completes one epoch in a few seconds on both datasets, but also scales linearly in the size of the embedding problem. As compared to single-threaded AdaGrad, our asynchronous AdaGrad over 16 CPU threads offers 11.4x and 8.3x speedup on FB15K and WN18, respectively, on a single commercial desktop.\n3Notice that proportion tests only apply to performance scores as proportions, including Hits@k, but are not applicable to nonproportional scores such as MRR. Hence we only conducted the proportion tests on the Hits@k scores."
  }, {
    "heading": "7. Conclusion",
    "text": "We presented a novel framework for explicitly modeling analogical structures in multi-relational embedding, along with a differentiable objective function and a linear-time inference algorithm for large-scale embedding of knowledge graphs. The proposed approach obtains the state-of-the-art results on two popular benchmark datasets, outperforming a large number of strong baselines in most cases.\nAlthough we only focused on the multi-relational inference for knowledge-base embedding, we believe that analogical structures exist in many other machine learning problems beyond the scope of this paper. We hope this work shed light on a broad range of important problems where scalable inference for analogical analysis would make an impact, such as machine translation and image captioning (both problems require modeling cross-domain analogies). We leave these interesting topics as our future work."
  }, {
    "heading": "Acknowledgments",
    "text": "We thank the reviewers for their helpful comments. This work is supported in part by the National Science Founda-\ntion (NSF) under grant IIS-1546329."
  }],
  "year": 2017,
  "references": [{
    "title": "Dbpedia: A nucleus for a web of open data",
    "authors": ["Auer", "Sören", "Bizer", "Christian", "Kobilarov", "Georgi", "Lehmann", "Jens", "Cyganiak", "Richard", "Ives", "Zachary"],
    "venue": "In The semantic web,",
    "year": 2007
  }, {
    "title": "Freebase: a collaboratively created graph database for structuring human knowledge",
    "authors": ["Bollacker", "Kurt", "Evans", "Colin", "Paritosh", "Praveen", "Sturge", "Tim", "Taylor", "Jamie"],
    "venue": "In Proceedings of the 2008 ACM SIGMOD international conference on Management of data,",
    "year": 2008
  }, {
    "title": "Learning structured embeddings of knowledge bases",
    "authors": ["Bordes", "Antoine", "Weston", "Jason", "Collobert", "Ronan", "Bengio", "Yoshua"],
    "venue": "In Conference on artificial intelligence,",
    "year": 1923
  }, {
    "title": "Joint learning of words and meaning representations for open-text semantic parsing",
    "authors": ["Bordes", "Antoine", "Glorot", "Xavier", "Weston", "Jason", "Bengio", "Yoshua"],
    "venue": "In AISTATS,",
    "year": 2012
  }, {
    "title": "Translating embeddings for modeling multi-relational data",
    "authors": ["Bordes", "Antoine", "Usunier", "Nicolas", "Garcia-Duran", "Alberto", "Weston", "Jason", "Yakhnenko", "Oksana"],
    "venue": "In Advances in neural information processing systems,",
    "year": 2013
  }, {
    "title": "Category theory: an abstract setting for analogy and comparison",
    "authors": ["Brown", "Ronald", "Porter", "Tim"],
    "venue": "In What is category theory,",
    "year": 2006
  }, {
    "title": "Learning new facts from knowledge bases with neural tensor networks and semantic word vectors",
    "authors": ["Chen", "Danqi", "Socher", "Richard", "Manning", "Christopher D", "Ng", "Andrew Y"],
    "venue": "arXiv preprint arXiv:1301.3618,",
    "year": 2013
  }, {
    "title": "Entity query feature expansion using knowledge base links",
    "authors": ["Dalton", "Jeffrey", "Dietz", "Laura", "Allan", "James"],
    "venue": "In Proceedings of the 37th international ACM SIGIR conference on Research & development in information retrieval,",
    "year": 2014
  }, {
    "title": "Adaptive subgradient methods for online learning and stochastic optimization",
    "authors": ["Duchi", "John", "Hazan", "Elad", "Singer", "Yoram"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2011
  }, {
    "title": "The structure-mapping engine: Algorithm and examples",
    "authors": ["Falkenhainer", "Brian", "Forbus", "Kenneth D", "Gentner", "Dedre"],
    "venue": "Artificial intelligence,",
    "year": 1989
  }, {
    "title": "Building watson: An overview of the deepqa project",
    "authors": ["Ferrucci", "David", "Brown", "Eric", "Chu-Carroll", "Jennifer", "Fan", "James", "Gondek", "Kalyanpur", "Aditya A", "Lally", "Adam", "Murdock", "J William", "Nyberg", "Prager", "John"],
    "venue": "AI magazine,",
    "year": 2010
  }, {
    "title": "Wikipediabased semantic interpretation for natural language processing",
    "authors": ["Gabrilovich", "Evgeniy", "Markovitch", "Shaul"],
    "venue": "Journal of Artificial Intelligence Research,",
    "year": 2009
  }, {
    "title": "Composing relationships with translations",
    "authors": ["Garcia-Duran", "Alberto", "Bordes", "Antoine", "Usunier", "Nicolas"],
    "venue": "PhD thesis, CNRS, Heudiasyc,",
    "year": 2015
  }, {
    "title": "Structure-mapping: A theoretical framework for analogy",
    "authors": ["Gentner", "Dedre"],
    "venue": "Cognitive science,",
    "year": 1983
  }, {
    "title": "Introduction to statistical relational learning",
    "authors": ["Getoor", "Lise"],
    "venue": "MIT press,",
    "year": 2007
  }, {
    "title": "Traversing knowledge graphs in vector space",
    "authors": ["Guu", "Kelvin", "Miller", "John", "Liang", "Percy"],
    "venue": "arXiv preprint arXiv:1506.01094,",
    "year": 2015
  }, {
    "title": "Learning to represent knowledge graphs with gaussian embedding",
    "authors": ["He", "Shizhu", "Liu", "Kang", "Ji", "Guoliang", "Zhao", "Jun"],
    "venue": "In Proceedings of the 24th ACM International on Conference on Information and Knowledge Management,",
    "year": 2015
  }, {
    "title": "Analogy as the core of cognition. The analogical mind: Perspectives from cognitive science",
    "authors": ["Hofstadter", "Douglas R"],
    "year": 2001
  }, {
    "title": "Mental leaps: Analogy in creative thought",
    "authors": ["Holyoak", "Keith J", "Keith James", "Thagard", "Paul"],
    "venue": "MIT press,",
    "year": 1996
  }, {
    "title": "A latent factor model for highly multi-relational data",
    "authors": ["Jenatton", "Rodolphe", "Roux", "Nicolas L", "Bordes", "Antoine", "Obozinski", "Guillaume R"],
    "venue": "In Advances in Neural Information Processing Systems,",
    "year": 2012
  }, {
    "title": "Knowledge graph completion with adaptive sparse transfer matrix",
    "authors": ["Ji", "Guoliang", "Liu", "Kang", "He", "Shizhu", "Zhao", "Jun"],
    "venue": "In Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence, February 12-17,",
    "year": 2016
  }, {
    "title": "Modeling relation paths for representation learning of knowledge bases",
    "authors": ["Lin", "Yankai", "Liu", "Zhiyuan", "Luan", "Huanbo", "Sun", "Maosong", "Rao", "Siwei", "Song"],
    "venue": "arXiv preprint arXiv:1506.00379,",
    "year": 2015
  }, {
    "title": "Learning entity and relation embeddings for knowledge graph completion",
    "authors": ["Lin", "Yankai", "Liu", "Zhiyuan", "Sun", "Maosong", "Yang", "Zhu", "Xuan"],
    "venue": "In AAAI,",
    "year": 2015
  }, {
    "title": "Bipartite edge prediction via transductive learning over product graphs",
    "authors": ["Liu", "Hanxiao", "Yang", "Yiming"],
    "venue": "In ICML, pp",
    "year": 2015
  }, {
    "title": "Cross-graph learning of multi-relational associations",
    "authors": ["Liu", "Hanxiao", "Yang", "Yiming"],
    "venue": "In Proceedings of The 33rd International Conference on Machine Learning,",
    "year": 2016
  }, {
    "title": "Distributed representations of words and phrases and their compositionality",
    "authors": ["Mikolov", "Tomas", "Sutskever", "Ilya", "Chen", "Kai", "Corrado", "Greg S", "Dean", "Jeff"],
    "venue": "In Advances in neural information processing systems,",
    "year": 2013
  }, {
    "title": "Distant supervision for relation extraction with an incomplete knowledge base",
    "authors": ["Min", "Bonan", "Grishman", "Ralph", "Wan", "Li", "Wang", "Chang", "Gondek", "David"],
    "venue": "In HLTNAACL,",
    "year": 2013
  }, {
    "title": "Stranse: a novel embedding model of entities and relationships in knowledge bases",
    "authors": ["Nguyen", "Dat Quoc", "Sirts", "Kairit", "Qu", "Lizhen", "Johnson", "Mark"],
    "venue": "arXiv preprint arXiv:1606.08140,",
    "year": 2016
  }, {
    "title": "A three-way model for collective learning on multi-relational data",
    "authors": ["Nickel", "Maximilian", "Tresp", "Volker", "Kriegel", "HansPeter"],
    "venue": "In Proceedings of the 28th international conference on machine learning",
    "year": 2011
  }, {
    "title": "A review of relational machine learning for knowledge graphs",
    "authors": ["Nickel", "Maximilian", "Murphy", "Kevin", "Tresp", "Volker", "Gabrilovich", "Evgeniy"],
    "venue": "arXiv preprint arXiv:1503.00759,",
    "year": 2015
  }, {
    "title": "Holographic embeddings of knowledge graphs",
    "authors": ["Nickel", "Maximilian", "Rosasco", "Lorenzo", "Poggio", "Tomaso A"],
    "venue": "In Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence, February 12-17,",
    "year": 2016
  }, {
    "title": "Glove: Global vectors for word representation",
    "authors": ["Pennington", "Jeffrey", "Socher", "Richard", "Manning", "Christopher D"],
    "venue": "In EMNLP,",
    "year": 2014
  }, {
    "title": "Holographic reduced representation: Distributed representation for cognitive structures",
    "authors": ["Plate", "Tony A"],
    "year": 2003
  }, {
    "title": "Hogwild: A lock-free approach to parallelizing stochastic gradient descent",
    "authors": ["Recht", "Benjamin", "Re", "Christopher", "Wright", "Stephen", "Niu", "Feng"],
    "venue": "In Advances in Neural Information Processing Systems,",
    "year": 2011
  }, {
    "title": "Introducing the knowledge graph: things, not strings",
    "authors": ["Singhal", "Amit"],
    "venue": "Official google blog,",
    "year": 2012
  }, {
    "title": "Reasoning with neural tensor networks for knowledge base completion",
    "authors": ["Socher", "Richard", "Chen", "Danqi", "Manning", "Christopher D", "Ng", "Andrew"],
    "venue": "In Advances in neural information processing systems,",
    "year": 2013
  }, {
    "title": "Observed versus latent features for knowledge base and text inference",
    "authors": ["Toutanova", "Kristina", "Chen", "Danqi"],
    "venue": "In Proceedings of the 3rd Workshop on Continuous Vector Space Models and their Compositionality,",
    "year": 2015
  }, {
    "title": "Complex embeddings for simple link prediction",
    "authors": ["Trouillon", "Théo", "Welbl", "Johannes", "Riedel", "Sebastian", "Gaussier", "Éric", "Bouchard", "Guillaume"],
    "venue": "In Proceedings of the 33nd International Conference on Machine Learning,",
    "year": 2016
  }, {
    "title": "The latent relation mapping engine: Algorithm and experiments",
    "authors": ["Turney", "Peter D"],
    "venue": "Journal of Artificial Intelligence Research,",
    "year": 2008
  }, {
    "title": "Knowledge graph embedding by translating on hyperplanes",
    "authors": ["Wang", "Zhen", "Zhang", "Jianwen", "Feng", "Jianlin", "Chen", "Zheng"],
    "venue": "In AAAI,",
    "year": 2014
  }, {
    "title": "The algebraic eigenvalue problem, volume 87",
    "authors": ["Wilkinson", "James Hardy"],
    "year": 1965
  }, {
    "title": "Embedding entities and relations for learning and inference in knowledge bases",
    "authors": ["Yang", "Bishan", "Yih", "Wen-tau", "He", "Xiaodong", "Gao", "Jianfeng", "Deng", "Li"],
    "venue": "CoRR, abs/1412.6575,",
    "year": 2014
  }, {
    "title": "A re-examination of text categorization methods",
    "authors": ["Yang", "Yiming", "Liu", "Xin"],
    "venue": "In Proceedings of the 22nd annual international ACM SIGIR conference on Research and development in information retrieval,",
    "year": 1999
  }],
  "id": "SP:ee67f6961c2fc4baa3823a0adbb12ead9628fcba",
  "authors": [{
    "name": "Hanxiao Liu",
    "affiliations": []
  }, {
    "name": "Yuexin Wu",
    "affiliations": []
  }, {
    "name": "Yiming Yang",
    "affiliations": []
  }],
  "abstractText": "Large-scale multi-relational embedding refers to the task of learning the latent representations for entities and relations in large knowledge graphs. An effective and scalable solution for this problem is crucial for the true success of knowledgebased inference in a broad range of applications. This paper proposes a novel framework for optimizing the latent representations with respect to the analogical properties of the embedded entities and relations. By formulating the learning objective in a differentiable fashion, our model enjoys both theoretical power and computational scalability, and significantly outperformed a large number of representative baseline methods on benchmark datasets. Furthermore, the model offers an elegant unification of several well-known methods in multi-relational embedding, which can be proven to be special instantiations of our framework.",
  "title": "Analogical Inference for Multi-relational Embeddings"
}