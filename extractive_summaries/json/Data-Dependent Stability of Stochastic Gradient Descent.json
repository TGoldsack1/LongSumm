{
  "sections": [{
    "heading": "1. Introduction",
    "text": "Stochastic gradient descent (SGD) has become one of the workhorses of modern machine learning. In particular, it is the optimization method of choice for training highly complex and non-convex models, such as neural networks. When it was observed that these models generalize better (suffer less from overfitting) than classical machine learning theory suggests, a large theoretical interest emerged to explain this phenomenon. Given that SGD at best finds a local minimum of the non-convex objective function, it has been argued that all such minima might be equally good. However, at the same time, a large body of empirical work and tricks of trade, such as early stopping, suggests that in prac-\n1University of Milan, Italy 2IST Austria. Correspondence to: Ilja Kuzborskij <ilja.kuzborskij@gmail.com>.\nProceedings of the 35 th International Conference on Machine Learning, Stockholm, Sweden, PMLR 80, 2018. Copyright 2018 by the author(s).\ntice one might not even reach a minimum, yet nevertheless observes excellent performance.\nIn this work we follow an alternative route that aims to directly analyze the generalization ability of SGD by studying how sensitive it is to small perturbations in the training set. This is known as algorithmic stability approach (Bousquet & Elisseeff, 2002) and was used recently (Hardt et al., 2016) to establish generalization bounds for both convex and non-convex learning settings. To do so they employed a rather restrictive notion of stability that does not depend on the data, but captures only intrinsic characteristics of the learning algorithm and global properties of the objective function. Consequently, their analysis results in worst-case guarantees that in some cases tend to be too pessimistic. As recently pointed out in (Zhang et al., 2017), deep learning might indeed be such a case, as this notion of stability is insufficient to give deeper theoretical insights, and a less restrictive one is desirable.\nAs our main contribution in this work we establish that a data-dependent notion of algorithmic stability, very similar to the On-Average Stability (Shalev-Shwartz et al., 2010), holds for SGD when applied to convex as well as nonconvex learning problems. As a consequence we obtain new generalization bounds that depend on the data-generating distribution and the initialization point of an algorithm. For convex loss functions, the bound on the generalization error is essentially multiplicative in the risk at the initialization point when noise of stochastic gradient is not too high. For the non-convex loss functions, besides the risk, it is also critically controlled by the expected second-order information about the objective function at the initialization point. We further corroborate our findings empirically and show that, indeed, the data-dependent generalization bound is tighter than the worst-case counterpart on non-convex objective functions. Finally, the nature of the data-dependent bounds allows us to state optimistic bounds that switch to the faster rate of convergence subject to the vanishing empirical risk.\nIn particular, our findings justify the intuition that SGD is more stable in less curved areas of the objective function and link it to the generalization ability. This also backs up numerous empirical findings in the deep learning literature that solutions with low generalization error occur in less curved regions. At the same time, in pessimistic scenarios,\nour bounds are no worse than those of (Hardt et al., 2016).\nFinally, we exemplify an application of our bounds, and propose a simple yet principled transfer learning scheme for the convex and non-convex case, which is guaranteed to transfer from the best source of information. In addition, this approach can also be used to select a good initialization given a number of random starting positions. This is a theoretically sound alternative to the purely random commonly used in non-convex learning.\nThe rest of the paper is organized as follows. We revisit the connection between stability and generalization of SGD in Section 3 and introduce a data-dependent notion of stability in Section 4. We state the main results in Section 5, in particular, Theorem 3 for the convex case, and Theorem 4 for the non-convex one. Next we demonstrate empirically that the bound shown in Theorem 4 is tighter than the worstcase one in Section 5.2.1. Finally, we suggest application of these bounds by showcasing principled transfer learning approaches in Section 5.3, and we conclude in Section 7."
  }, {
    "heading": "2. Related Work",
    "text": "Algorithmic stability has been a topic of interest in learning theory for a long time, however, the modern approach on the relationship between stability and generalization goes back to the milestone work of (Bousquet & Elisseeff, 2002). They analyzed several notions of stability, which fall into two categories: distribution-free and distribution-dependent ones. The first category is usually called uniform stability and focuses on the intrinsic stability properties of an algorithm without regard to the data-generating distribution. Uniform stability was used to analyze many algorithms, including regularized Empirical Risk Minimization (ERM) (Bousquet & Elisseeff, 2002), randomized aggregation schemes (Elisseeff et al., 2005), and recently SGD by (Hardt et al., 2016; London, 2016), and (Poggio et al., 2011). Despite the fact that uniform stability has been shown to be sufficient to guarantee learnability, it can be too pessimistic, resulting in worst-case rates.\nIn this work we are interested in the data-dependent behavior of SGD, thus the emphasis will fall on the distributiondependent notion of stability, known as on-average stability, explored throughly in (Shalev-Shwartz et al., 2010). The attractive quality of this less restrictive stability type is that the resulting bounds are controlled by how stable the algorithm is under the data-generating distribution. For instance, in (Bousquet & Elisseeff, 2002) and (Devroye & Wagner, 1979), the on-average stability is related to the variance of an estimator. In (Shalev-Shwartz & Ben-David, 2014, Sec. 13), the authors show risk bounds that depend on the expected empirical risk of a solution to the regularized ERM. In turn, one can exploit this fact to state improved optimistic risk\nbounds, for instance, ones that exhibit fast-rate regimes (Koren & Levy, 2015; Gonen & Shalev-Shwartz, 2017), or even to design enhanced algorithms that minimize these bounds in a data-driven way, e.g. by exploiting side information as in transfer (Kuzborskij & Orabona, 2013; Ben-David & Urner, 2013) and metric learning (Perrot & Habrard, 2015). Here, we mainly focus on the later direction in the context of SGD: how stable is SGD under the data-generating distribution given an initialization point? We also touch the former direction by taking advantage of our data-driven analysis and show optimistic bounds as a corollary.\nWe will study the on-average stability of SGD for both convex and non-convex loss functions. In the convex setting, we will relate stability to the risk at the initialization point, while previous data-driven stability arguments usually consider minimizers of convex ERM rather than a stochastic approximation (Shalev-Shwartz & Ben-David, 2014; Koren & Levy, 2015). Beside convex problems, our work also covers the generalization ability of SGD on non-convex problems. Here, we borrow techniques of (Hardt et al., 2016) and extend them to the distribution-dependent setting. That said, while bounds of (Hardt et al., 2016) are stated in terms of worst-case quantities, ours reveal new connections to the data-dependent second-order information. These new insights also partially justify empirical observations in deep learning about the link between the curvature and the generalization error (Hochreiter & Schmidhuber, 1997; Keskar et al., 2017; Chaudhari et al., 2017). At the same time, our work is an alternative to the theoretical studies of neural network objective functions (Choromanska et al., 2015; Kawaguchi, 2016), as we focus on the direct connection between the generalization and the curvature.\nIn this light, our work is also related to non-convex optimization by SGD. Literature on this subject typically studies rates of convergence to the stationary points (Ghadimi & Lan, 2013; Allen-Zhu & Hazan, 2016; Reddi et al., 2016), and ways to avoid saddles (Ge et al., 2015; Lee et al., 2016). However, unlike these works, and similarly to (Hardt et al., 2016), we are interested in the generalization ability of SGD, and thanks to the stability approach, involvement of stationary points in our analysis is not necessary.\nFinally, we propose an example application of our findings in Transfer Learning (TL). For instance, by controlling the stability bound in a data-driven way, one can choose an initialization that leads to improved generalization. This is related to TL where one transfers from pre-trained models (Kuzborskij & Orabona, 2016; Tommasi et al., 2014; Pentina & Lampert, 2014; Ben-David & Urner, 2013), especially popular in deep learning due to its data-demanding nature (Galanti et al., 2016). Literature on this topic is mostly focused on the ERM setting and PAC-bounds, while our analysis of SGD yields such guarantees as a corollary."
  }, {
    "heading": "3. Stability of Stochastic Gradient Descent",
    "text": "First, we introduce definitions used in the rest of the paper."
  }, {
    "heading": "3.1. Definitions",
    "text": "We will denote with small and capital bold letters respectively column vectors and matrices, e.g., a “ ra1, a2, . . . , adsT P Rd and A P Rd1ˆd2 , }a} is understood as a Euclidean norm and }A}2 as the spectral norm. We denote enumeration by rns “ t1, . . . , nu for n P N.\nWe indicate an example space by Z and its member by z P Z . For instance, in a supervised setting Z “ X ˆ Y , such that X is the input and Y is the output space of a learning problem. We assume that training and testing examples are drawn iid from a probability distribution D over Z . In particular, we will denote the training set as S “ tziumi“1 „ Dm.\nFor a parameter space H, we define a learning algorithm as a map A : Zm ÞÑ H and for brevity we will use the notation AS “ ApSq. In the following we assume that H Ď Rd. To measure the accuracy of a learning algorithm A, we have a loss function fpw, zq, which measures the cost incurred by predicting with parameters w P H on an example z. The risk of w, with respect to the distribution D, and the empirical risk given a training set S are defined as\nRpwq :“ E z„D\nrfpw, zqs, and pRSpwq :“ 1\nm\nm ÿ i“1 fpw, ziq .\nFinally, define R‹ :“ infwPHRpwq."
  }, {
    "heading": "3.2. Uniform Stability and Generalization",
    "text": "On an intuitive level, a learning algorithm is said to be stable whenever a small perturbation in the training set does not affect its outcome too much. Of course, there is a number of ways to formalize the perturbation and the extent of the change in the outcome, and we will discuss some of them below. The most important consequence of a stable algorithm is that it generalizes from the training set to the unseen data sampled from the same distribution. In other words, the difference between the risk RpASq and the empirical risk pRSpASq of the algorithm’s output is controlled by the quantity that captures how stable the algorithm is. So, to observe good performance, or a decreasing true risk, we must have a stable algorithm and decreasing empirical risk (training error), which usually comes by design of the algorithm. In this work we focus on the stability of the Stochastic Gradient Descent (SGD) algorithm, and thus, as a consequence, we study its generalization ability.\nRecently, (Hardt et al., 2016) used a stability argument to prove generalization bounds for learning with SGD. Specifically, the authors extended the notion of the uniform stability\noriginally proposed by (Bousquet & Elisseeff, 2002), to accommodate randomized algorithms.\nDefinition 1 (Uniform stability). A randomized algorithm A is -uniformly stable if for all datasets S, Spiq P Zm such that S and Spiq differ in the i-th example, we have\nsup zPZ,iPrms\n!\nE A rfpAS , zq ´ fpASpiq , zqs\n)\nď .\nSince SGD is a randomized algorithm, we have to cope with two sources of randomness: the data-generating process and the randomization of the algorithm A itself, hence we have statements in expectation. The following theorem of (Hardt et al., 2016) shows that the uniform stability implies generalization in expectation.\nTheorem 1. Let A be -uniformly stable. Then, ˇ\nˇ ˇ ˇ E S,A\n” pRSpASq ´RpASq ı\nˇ ˇ ˇ ˇ ď .\nThus it suffices to characterize the uniform stability of an algorithm to state a generalization bound. In particular, (Hardt et al., 2016) showed generalization bounds for SGD under different assumptions on the loss function f . Despite that these results hold in expectation, other forms of generalization bounds, such as high-probability ones, can be derived from the above (Shalev-Shwartz et al., 2010).\nApart from SGD, uniform stability has been used before to prove generalization bounds for many learning algorithms (Bousquet & Elisseeff, 2002). However, these bounds typically suggest worst-case generalization rates, and rather reflect intrinsic stability properties of an algorithm. In other words, uniform stability is oblivious to the data-generating process and any other side information, which might reveal scenarios where generalization occurs at a faster rate. In turn, these insights could motivate the design of improved learning algorithms. In the following we address some limitations of analysis through uniform stability by using a less restrictive notion of stability. We extend the setting of (Hardt et al., 2016) by proving data-dependent stability bounds for convex and non-convex loss functions. In addition, we also take into account the initialization point of an algorithm as a form of supplementary information, and we dedicate special attention to its interplay with the data-generating distribution. Finally, we discuss situations where one can explicitly control the stability of SGD in a data-dependent way."
  }, {
    "heading": "4. Data-dependent Stability Bounds for SGD",
    "text": "In this section we describe a notion of data-dependent algorithmic stability, that allows us to state generalization bounds which depend not only on the properties of the learning algorithm, but also on the additional parameters of the\nalgorithm. We indicate such additional parameters by θ, and therefore we denote stability as a function pθq. In particular, in the following we will be interested in scenarios where θ describes the data-generating distribution and the initialization point of SGD.\nDefinition 2 (On-Average stability). A randomized algorithm A is pθq-on-average stable if it is true that\nsup iPrms\n\"\nE A E S,z rfpAS , zq ´ fpASpiq , zqs\n*\nď pθq ,\nwhere S iid„ Dm and Spiq is its copy with i-th example replaced by z iid„D.\nOur definition of on-average stability resembles the notion introduced by (Shalev-Shwartz et al., 2010). The difference lies in the fact that we take supremum over index of replaced example. A similar notion was also used by (Bousquet & Elisseeff, 2002) and later by (Elisseeff et al., 2005) for analysis of a randomized aggregation schemes, however their definition involves absolute difference of losses. The dependence on θ also bears similarity to recent work of (London, 2016), however, there, it is used in the context of uniform stability. The following theorem shows that on-average -stable random algorithm is guaranteed to generalize in expectation.\nTheorem 2. Let an algorithm A be pθq-on-average stable. Then,\nE S E A\n” RpASq ´ pRSpASq ı ď pθq ."
  }, {
    "heading": "5. Main Results",
    "text": "Before presenting our main results in this section, we discuss algorithmic details and assumptions. We will study the following variant of SGD: given a training set S “ tziumi“1\niid„ Dm, step sizes tαtuTt“1, random indices I “ tjtuTt“1, and an initialization point w1, perform updates\nwt`1 “ wt ´ αt∇fpwt, zjtq\nfor T ď m steps. Moreover we will use the notation wS,t to indicate the output of SGD ran on a training set S, at step t. We assume that the indices in I are sampled from the uniform distribution over rms without replacement, and that this is the only source of randomness for SGD. In practice this corresponds to permuting the training set before making a pass through it, as it is commonly done in practical applications. We also assume that the variance of stochastic gradients obeys\nE S,z\n” }∇fpwS,t, zq ´∇RpwS,tq}2 ı ď σ2 @t P rT s .\nNext, we introduce statements about the loss functions f used in the following.\nDefinition 3 (Lipschitz f ). A loss function f is L-Lipschitz if }∇fpw, zq} ď L, @w P H and @z P Z . Note that this also implies that |fpw, zq ´ fpv, zq| ď L}w ´ v} . Definition 4 (Smooth f ). A loss function is β-smooth if @w,v P H and @z P Z , }∇fpw, zq ´ ∇fpv, zq} ď β}w ´ v} , which also implies fpw, zq ´ fpv, zq ď ∇fpv, zqJpw ´ vq ` β2 }w ´ v} 2 . Definition 5 (Lipschitz Hessians). A loss function f has a ρLipschitz Hessian if @w,v P H and @z P Z , }∇2fpw, zq´ ∇2fpv, zq}2 ď ρ}w ´ v} .\nThe last condition is occasionally used in analysis of SGD (Ge et al., 2015) and holds whenever f has a bounded third derivative. All presented theorems assume that the loss function is non-negative, Lipschitz, and β-smooth. Examples of such commonly used loss functions are the logistic/softmax losses and neural networks with sigmoid activations. Convexity of loss functions or Lipschitzness of Hessians will only be required for some results, and we will denote it when necessary. Proofs for all the statements in this section are given in the arXiv version of the paper1."
  }, {
    "heading": "5.1. Convex Losses",
    "text": "First, we present a new and data-dependent stability result for convex losses.\nTheorem 3. Assume that f is convex, and that SGD’s step sizes satisfy αt “ c?t ď 1 β , @t P rT s. Then SGD is\npD,w1q-on-average stable with\npD,w1q “ O ˜ a c pRpw1q ´R‹q ¨ 4 ? T\nm ` cσ\n? T\nm\n¸\n.\nUnder the same assumptions, taking step size of order Op1{ ? tq, Theorem 3.7 of (Hardt et al., 2016) implies a uniform stability bound “ Op ? T {mq. Our bound differs since it involves a multiplicative risk at the initialization point. Thus, our bound corroborates the intuition that whenever we start at a good location of the objective function, the algorithm is more stable and thus generalizes better. However, this is only the case, whenever the variance of stochastic gradient σ2 is not too large. In the deterministic case, and of Rpw1q “ R‹, the theorem confirms that SGD, in expectation, does not need to make any updates and is therefore perfectly stable. On the other hand, when the variance σ2 is large enough to make the second summand in Theorem 3 dominant, the bound does not offer improvement compared to (Hardt et al., 2016). Note, that a result of this type cannot be obtained through the more restrictive uniform stability, precisely because such bounds on the stability must hold even for a worst-case choice of data distribution and initialization. In contrast, the notion of stability we\n1https://arxiv.org/abs/1703.01678\nemploy depends on the data-generating distribution, which allowed us to introduce dependency on the risk.\nFurthermore, consider that we start at arbitrary location w1: assuming that the loss function is bounded for a concrete H and Z , the rate of our bound up to a constant is no worse than that of (Hardt et al., 2016). Finally, one can always tighten this result by taking the minimum of two bounds."
  }, {
    "heading": "5.2. Non-convex Losses",
    "text": "Now we state a new stability result for non-convex losses.\nTheorem 4. Assume that fp¨, zq P r0, 1s and has a ρLipschitz Hessian, and that step sizes of a form αt “ ct satisfy c ď min !\n1 β , 1 4p2β lnpT qq2\n)\n. Then SGD is pD,w1qon-average stable with\npD,w1q ď 1` 1cγ m ` 2cL2 ˘ 1 1`cγ ˆ E S,A rRpASqs ¨ T ˙ cγ 1`cγ ,\n(1)\nwhere\nγ :“ Õ ´ min !\nβ, E z\n“ › ›∇2fpw1, zq › ›\n2\n‰ `∆‹1,σ2 )¯ , (2)\n∆‹1,σ2 :“ ρ ´ cσ ` a c pRpw1q ´R‹q ¯ .\nIn particular, γ characterizes how the curvature at the initialization point affects stability, and hence the generalization error of SGD. Since γ heavily affects the rate of convergence in (1), and in most situations smaller γ yields higher stability, we now look at a few cases of its behavior. Consider a regime such that γ is of the order Θ̃ ´ Er}∇2fpw1, zq}2s ` a Rpw1q ` σ ¯\n, or in other words, that stability is controlled by the curvature, the risk of the initialization point w1, and the variance of the stochastic gradient σ2. This suggests that starting from a point in a less curved region with low risk should yield higher stability, and therefore as predicted by our theory, allow for faster generalization. In addition, we observe that the considered stability regime offers a principled way to pre-screen a good initialization point in practice, by choosing the one that minimizes spectral norm of the Hessian and the risk.\nNext, we focus on a more specific case. Suppose that we choose a step size αt “ ct such that γ “ Θ̃ ` Er}∇2fpw1, zq}2s ˘\n, yet not too small, so that the empirical risk can still be decreased. Then, stability is dominated by the curvature around w1. Indeed, lower generalization errors on non-convex problems, such as training deep neural networks, have been observed empirically when SGD is actively guided (Hochreiter & Schmidhuber, 1997; Goodfellow et al., 2016; Chaudhari et al., 2017) or converges to solutions with low curvature (Keskar et al., 2017). However, to the best of our knowledge, Theorem 4 is the first\nto establish a theoretical link between the curvature of the loss function and the generalization ability of SGD in a data-dependent sense.\nTheorem 4 immediately implies the following statement that further reinforces the effect of the initialization point on the generalization error, assuming that ESrRpASqs ď Rpw1q. Corollary 1. Under conditions of Theorem 4 we have that SGD is pD,w1q-on-average stable with\npD,w1q “ O ˜ 1` 1cγ m pRpw1q ¨ T q cγ 1`cγ ¸ . (3)\nWe take a moment to discuss the role of the risk term in pRpw1q ¨ T q cγ 1`cγ . Observe that pD,w1q Ñ 0 as Rpw1q Ñ 0, in other words, the generalization error approaches zero as the risk of the initialization point vanishes. This is an intuitive behavior, however, uniform stability does not capture this due to its distribution-free nature. Finally, we note that (Hardt et al., 2016, Theorem 3.8) showed a bound similar to (1), however, in place of γ their bound has a Lipschitz constant of the gradient. The crucial difference lies in term γ which is now not merely a Lipschitz constant, but rather depends on the data-generating distribution and initialization point of SGD. We compare to their bound by considering the worst case scenario, namely, that SGD is initialized in a point with high curvature, or altogether, that the objective function is highly curved everywhere. Then, at least our bound is no worse than the one of (Hardt et al., 2016), since γ ď β. Finally, it should be noted that our bound can be compared to the one of (Hardt et al., 2016) only in a setting of a single pass. In a multiple-pass case, data-dependent analysis in a current form would not hold, since the output of SGD would not be independent from a newly observed example after the first pass. On the other hand, our results focus on the gains due to data-dependent initialization.\nTheorem 4 also allows us to prove an optimistic generalization bound for learning with SGD on non-convex objectives. Corollary 2. Under conditions of Theorem 4 we have that the output of SGD obeys\nE S,A\n” RpASq ´ pRSpASq ı “\nO\n˜\n1` 1 cγ\nm ¨max\n#\nˆ\nE S,A\n” pRSpASq ı ¨ T ˙\ncγ 1`cγ\n,\nˆ\nT\nm\n˙cγ +¸\n.\nAn important consequence of Corollary 2, is that for a vanishing expected empirical risk, in particular for ES,Ar pRSpASqs “ O ` T cγ\nm1`cγ\n˘\n, the generalization error behaves as O ` T cγ\nm1`cγ\n˘\n. Considering the full pass, that is m “ OpT q, we have an optimistic generalization error of order O p1{mq instead of Opm´ 1 1`cγ q. We note that\nPAC bounds with similar optimistic message (although not directly comparable), but without curvature information can also be obtained through empirical Bernstein bounds as in (Maurer & Pontil, 2009). However, a PAC bound does not suggest a way to minimize non-convex empirical risk in general, where SGD is known to work reasonably well."
  }, {
    "heading": "5.2.1. TIGHTNESS OF NON-CONVEX BOUNDS",
    "text": "Next we empirically assess the tightness of our non-convex generalization bounds on real data. In the following experiment we train a neural network with three convolutional layers interlaced with max-pooling, followed by the fully connected layer with 16 units, on the MNIST dataset. This totals in a model with 18K parameters. Figure 1 compares our data-dependent bound (1) to the distribution-free one of (Hardt et al., 2016, Theorem 3.8). As as a reference we also include an empirical estimate of the generalization error taken as an absolute difference of the validation and training average losses. Since our bound also depends on the initialization point, we plot (1) for multiple “warm-starts”, ie.with SGD initialized from a pre-trained position. We consider 7 such warm-starts at every 200 steps, and report data-dependent quantities used to compute (1) just beneath the graph. Our first observation is that, clearly, the datadependent bound gives tighter estimate, by roughly one order of magnitude. Second, simulating start from a pretrained position suggests even tighter estimates: we suspect that this is due to decreasing validation error which is used as an empirical estimate for Rpw1q which affects bound (1).\nWe compute an empirical estimate of the expected Hessian spectral norm by the power iteration method using an efficient Hessian-vector multiplication method (Pearlmutter, 1994). Since bounds depend on constants L, β, and ρ, we estimate them by tracking maximal values of the\ngradient and Hessian norms throughout optimization. We compute bounds with estimates pL “ 78.72, pβ “ 1692.28, pρ “ 3823.73, and c “ 10´3."
  }, {
    "heading": "5.3. Application to Transfer Learning",
    "text": "One example application of data-dependent bounds presented before lies in Transfer Learning (TL), where we are interested in achieving faster generalization on a target task by exploiting side information that originates from different but related source tasks. The literature on TL explored many ways to do so, and here we will focus on the one that is most compatible with our bounds. More formally, suppose that the target task at hand is characterized by a joint probability distribution D, and as before we have a training set S iid„Dm. Some TL approaches also assume access to the data sampled from the distributions associated with the source tasks. Here we follow a conservative approach – instead of the source data, we receive a set of source hypotheses twsrck u K k“1 Ă H, trained on the source tasks. The goal of a learner is to come up with a target hypothesis, which in the optimistic scenario generalizes better by relying on source hypotheses. In the TL literature this is known as Hypothesis Transfer Learning (HTL) (Kuzborskij & Orabona, 2016), that is, we transfer from the source hypotheses which act as a proxy to the source tasks and the risk Rpwsrck q quantifies how much source and target tasks are related. In the following we will consider SGD for HTL, where the source hypotheses act as initialization points. First, consider learning with convex losses: Theorem 3 depends on Rpw1q, thus it immediately quantifies the relatedness of source and target tasks. So it is enough to pick the point that minimizes the stability bound to transfer from the most related source. Then, bounding Rpwsrck q by pRSpwsrck q through Hoeffding bound along with union bound gives with high probability that\nmin kPrKs pD,wsrck q ď min kPrKs O\n˜\npRSpwsrck q ` c logpKq m\n¸\n.\nHence, the most related source is the one that simply minimizes empirical risk. Similar conclusions where drawn in HTL literature, albeit in the context of ERM. Matters are slightly more complicated in the non-convex case. We take a similar approach, however, now we minimize stability bound (3), and for the sake of simplicity assume that we make a full pass over the data, so T “ m. Minimizing the following empirical upper bound select the best source. Proposition 1. Let pγ˘k “ Θ ´ 1 m řm i“1 }∇2fpwsrck , ziq}2 ` b\npRSpwsrck q ˘ 4 a\nlogpKq{m ¯\n. Then with high probability the generalization error of wsrck is bounded by\nmin kPrKs\nO\n¨\n˝\nˆ\n1` 1 cpγ´k\n˙ pRSpwsrck q cpγ ` k 1`cpγ` k ¨ a logpKq\nm 1 1`cpγ` k\n˛\n‚ .\nNote that pγ˘k involves estimation of the spectral norm of the Hessian, which is computationally cheaper to evaluate compared to the complete Hessian matrix (Pearlmutter, 1994). This is particularly relevant for deep learning, where computation of the Hessian matrix can be prohibitively expensive."
  }, {
    "heading": "6. Proof Outline of Theorem 4",
    "text": "In this section we discuss the proof of Theorem 4, which bounds data-dependent stability for non-convex losses.\nWe say that the SGD gradient update rule is an operator Gt : H ÞÑ H, such that\nGtpwq :“ w ´ αt∇fpw, zitq ,\nand it is also a function of the training set S and a random index set I . Then, wt`1 “ Gtpwtq, throughout t “ 1, . . . , T . Recall the use of notation wS,t to indicate the output of SGD ran on a training set S, at step t, and define\nδtpS, zq :“ }wS,t ´wSpiq,t} .\nThe following propoperty of Gt will be central to our proof. Definition 6 (Expansiveness). A gradient update rule is η-expansive if for all w,v, }Gtpwq´Gtpvq} ď η}w´v} .\nThe following lemma characterizes expansiveness for the gradient update rule under different assumptions on f . Lemma 1 ((Hardt et al., 2016)). Assume that f is β-smooth. Then, we have that Gt is p1` αtβq-expansive.\nThe following lemma is similar to Lemma 3.11 of (Hardt et al., 2016), and is instrumental in bounding the stability of SGD. However, we make an adjustment and state it in expectation over the data. Note that it does not require convexity of the loss function. Lemma 2. Assume that the loss function fp¨, zq P r0, 1s is L-Lipschitz for all z. Then, for every t0 P t0, 1, 2, . . .mu we have that,\nE S,z E A\n“ fpwS,T , zq ´ fpwSpiq,T , zq ‰\n(4)\nď L E S,z\n”\nE A rδT pS, zq | δt0pS, zq “ 0s\nı\n` E S,A rRpASqs t0 m .\n(5)\nWe spend a moment to highlight the role of conditional expectation. Observe that we could naively bound (4) by the Lipschitzness of f , but Lemma 2 follows a more careful argument. First note that t0 is a free parameter. The expected distance in (5) between SGD outputs wS,t and wSpiq,t is conditioned on the fact that at step t0 outputs of SGD are still the same. This means that the perturbed point is encountered after t0. Then, the conditional expectation should be a decreasing function of t0: the later the perturbation occurs, the smaller deviation between wS,t and wSpiq,t we should expect. Eventually we minimize (5) over t0."
  }, {
    "heading": "6.1. Non-convex Losses",
    "text": "Our proof of a stability bound for non-convex loss functions, Theorem 4, follows a general outline of (Hardt et al., 2016, Theorem 3.8). Namely, the outputs of SGD run on a training set S and its perturbed version Spiq will not differ too much, because by the time a perturbation is encountered, the step size has already decayed enough. So, on the one hand, stabilization is enforced by the diminishing the step size, and on the other hand, by how much updates expand the distance between the gradients after the perturbation. Since (Hardt et al., 2016) work with uniform stability, they capture the expansiveness of post-perturbation update by the Lipschitzness of the gradient. In combination with a recursive argument, their bound has exponential dependency on the Lipschitz constant of the gradient. We argue that the Lipschitz continuity of the gradient can be too pessimistic in general. Instead, we rely on a local data-driven argument: considering that we initialize SGD at point w1, how much do updates expand the gradient under the distribution of interest? The following crucial lemma characterizes such behavior in terms of the curvature at w1.\nLemma 3. Assume that the loss function fp¨, zq is β-smooth and that its Hessian is ρ-Lipschitz. Then, ›\n›GtpwS,tq ´GtpwSpiq,tq › › ď p1` αtξtpS, zqq δtpS, zq\nFurthermore, for any t P rT s,\nE S,z rξtpS, zqs “ Õ\nˆ\nE S,z\n“ › ›∇2fpw1, ztq › ›\n2\n‰ `∆‹1,σ2 ˙ ,\n∆‹1,σ2 :“ ρ ´ cσ ` a c pRpw1q ´R‹q ¯ .\nNext, we need the following statement.\nProposition 2 (Bernstein-type inequality). Let Z be a zeromean real-valued r.v., such that |Z| ď b and ErZ2s ď σ2. Then for all |c| ď 12b , we have that E “ ecZ ‰ ď ec2σ2 .\nNow we are ready to prove Theorem 4.\nSketch proof of Theorem 4. We start from Lemma 2. Most of the proof is dedicated to bounding the first term in (5). We deal with this similarly as in (Hardt et al., 2016). Specifically, we state the bound on EA rδT pS, zq|δt0pS, zq “ 0s by using a recursion. In our case, however, we also have an expectation w.r.t. the data, and to avoid complications with dependencies, we first unroll the recursion for the random quantities, and only then take the expectation. At this point the proof crucially relies on the product of exponentials arising from the recursion, and all relevant random quantities end up inside of them. We alleviate this by Proposition 2. Finally, we conclude by minimizing (5) w.r.t. t0. Thus we have three steps: 1) recursion, 2) bounding Erexpp¨ ¨ ¨ qs, and 3) tuning of t0.\n1) Recursion. We begin by stating the bound on EA rδT pS, zq|δt0pS, zq “ 0s by recursion. Thus we will first state the bound on EA rδt`1pS, zq|δt0pS, zq “ 0s in terms of EA rδtpS, zq|δt0pS, zq “ 0s, and other relevant quantities and then unravel the recursion. We distinguish two cases: 1) SGD encounters the perturbed point at step t, that is t “ i, and 2) the current point is the same in S and Spiq, so t ‰ i. For the first case, we will use worst-case boundedness of Gt, that is, we observe that }GtpwS,tq ´ GtpwSpiq,tq} ď δtpS, zq ` 2αtL. To handle the second case we will use Lemma 3, namely, ›\n›GtpwS,tq ´GtpwSpiq,tq › › ď p1` αtξtpS, zqq δtpS, zq .\nIn addition, as a safety measure we will also take into account that the gradient update rule is at most p1 ` αtβqexpansive by Lemma 1. So we will work with the function ψtpS, zq :“ min tξtpS, zq, βu instead of ξtpS, zq. Now, introduce ∆tpS, zq :“ EArδtpS, zq | δt0pS, zq “ 0s, and decompose the expectation w.r.t. A for a step t. Noting that SGD encounters the perturbed example with probability 1m ,\n∆t`1pS, zq ď ˆ 1´ 1 m ˙ p1` αtψtpS, zqq∆tpS, zq\n` 1 m p2αtL`∆tpS, zqq “ ˆ 1` ˆ\n1´ 1 m\n˙ αtψtpS, zq ˙ ∆tpS, zq ` 2αtL\nm\nď exp pαtψtpS, zqq∆tpS, zq ` 2αtL\nm , (6)\nwhere the last inequality follows from 1`x ď exppxq. This inequality is not overly loose for x P r0, 1s, and, in our case it becomes instrumental in handling the recursion.\nNow, observe that relation xt`1 ď atxt ` bt with xt0 “ 0 unwinds from T to t0 as xT ď řT t“t0`1 bt śT k“t`1 ak. Consequently, having ∆t0pS, zq “ 0, we unwind (6) to get\n∆T pS, zq ď T ÿ\nt“t0`1\n˜\nT ź\nk“t`1 exp\nˆ\ncψkpS, zq k\n˙\n¸\n2cL\nmt\n“ T ÿ\nt“t0`1 exp\n˜\nc T ÿ\nk“t`1\nψkpS, zq k\n¸\n2cL mt . (7)\n2) Bounding Erexpp¨ ¨ ¨ qs. We take expectation w.r.t. S and z on both sides and focus on the expectation of the exponential in (7). First, introduce µk :“ ES,zrψkpS, zqs, and observe that the zero-mean version of ψkpS, zq is bounded as\nřT k“t`1 1 k |ψkpS, zq ´ µk| ď 2β lnpT q. Assuming the\nsetting of c ď 12p2β lnpT qq2 , we apply Proposition 2 and get\nE S,z\n«\nexp\n˜\nc T ÿ\nk“t`1\nψkpS, zq k\n¸ff ď exp ˜ c T ÿ\nk“t`1\n2µk k\n¸\n,\n(8)\nwhere we bounded variance by µk thanks to the setting of c. Next, we give an upper-bound on µk, that is µk ď min tβ,ES,zrξkpS, zqsu. Finally, we bound ES,zrξkpS, zqs using the second result of Lemma 3, which holds for any k P rT s, to get that µk ď γ, with γ defined in (2).\n3) Tuning of t0. Now we turn our attention back to (7). Considering that we took an expectation w.r.t. the data, we use (8) and the fact that µk ď γ to get that\nE S,z r∆T pS, zqs ď\nT ÿ\nt“t0`1 exp\n˜\n2cγ T ÿ\nk“t`1\n1\nk\n¸\n2cL\nmt\nď T ÿ\nt“t0`1 exp\nˆ\n2cγ ln\nˆ\nT\nt\n˙˙\n2cL mt ď L γm\nˆ\nT\nt0\n˙2cγ\n.\nPlug the above into (5) to get\nE S,z E A\n“ fpwS,T , zq ´ fpwSpiq,T , zq ‰\nď L 2\nγm\nˆ\nT\nt0\n˙2cγ\n` t0 m . (9)\nLet q “ 2cγ. Then, setting t0 “ ` 2cL2 ˘ 1 1`q T q 1`q minimizes (9). Plugging t0 back we get that (9) equals to 1` 1q m ` 2cL2 ˘ 1 1`q T q 1`q . This completes the proof."
  }, {
    "heading": "7. Conclusions and Future Work",
    "text": "In this work we proved data-dependent stability bounds for SGD and revisited its generalization ability. We presented novel bounds for convex and non-convex smooth loss functions, partially controlled by data-dependent quantities, while previous stability bounds for SGD were derived through the worst-case analysis. In particular, for non-convex learning, we demonstrated theoretically that generalization of SGD is heavily affected by the expected curvature around the initialization point. We demonstrated empirically that our bound is indeed tighter compared to the uniform one. In addition, our data-dependent analysis also allowed us to show optimistic bounds on the generalization error of SGD, which exhibit fast rates subject to the vanishing empirical risk of the algorithm’s output.\nIn future work we further intend to explore our theoretical findings experimentally and evaluate the feasibility of the transfer learning based on the second-order information. Another direction lies in making our bounds adaptive. So far we have presented bounds that have data-dependent components, however the step size cannot be adjusted depending on the data, e.g. as in (Zhao & Zhang, 2015). This was partially addressed by (London, 2016), albeit in the context of uniform stability, and we plan to extend this idea to the context of data-dependent stability."
  }, {
    "heading": "Acknowledgments",
    "text": "This work was in parts funded by the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement no 637076). This work was in parts funded by the European Research Council under the European Union’s Seventh Framework Programme (FP7/2007-2013)/ERC grant agreement no 308036."
  }],
  "year": 2018,
  "references": [{
    "title": "Variance reduction for faster non-convex optimization",
    "authors": ["Z. Allen-Zhu", "E. Hazan"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2016
  }, {
    "title": "Domain adaptation as learning with auxiliary information",
    "authors": ["S. Ben-David", "R. Urner"],
    "venue": "NIPS workshop on New Directions in Transfer and Multi-Task,",
    "year": 2013
  }, {
    "title": "Stability and Generalization",
    "authors": ["O. Bousquet", "A. Elisseeff"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2002
  }, {
    "title": "Entropy-sgd: Biasing gradient descent into wide valleys",
    "authors": ["P. Chaudhari", "A. Choromanska", "S. Soatto", "Y. LeCun", "C. Baldassi", "C. Borgs", "J. Chayes", "L. Sagun", "R. Zecchina"],
    "venue": "In International Conference on Learning Representations (ICLR),",
    "year": 2017
  }, {
    "title": "The loss surfaces of multilayer networks",
    "authors": ["A. Choromanska", "M. Henaff", "M. Mathieu", "G.B. Arous", "Y. LeCun"],
    "venue": "In International Conference on Artificial Intelligence and Statistics (AISTATS),",
    "year": 2015
  }, {
    "title": "Distribution-free performance bounds for potential function rules",
    "authors": ["L. Devroye", "T. Wagner"],
    "venue": "IEEE Transactions on Information Theory,",
    "year": 1979
  }, {
    "title": "Stability of randomized learning algorithms",
    "authors": ["A. Elisseeff", "T. Evgeniou", "M. Pontil"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2005
  }, {
    "title": "A theoretical framework for deep transfer learning",
    "authors": ["T. Galanti", "L. Wolf", "T. Hazan"],
    "venue": "Information and Inference, pp",
    "year": 2016
  }, {
    "title": "Escaping from saddle points-online stochastic gradient for tensor decomposition",
    "authors": ["R. Ge", "F. Huang", "C. Jin", "Y. Yuan"],
    "venue": "In Conference on Learning Theory (COLT),",
    "year": 2015
  }, {
    "title": "Stochastic first-and zeroth-order methods for nonconvex stochastic programming",
    "authors": ["S. Ghadimi", "G. Lan"],
    "venue": "SIAM Journal on Optimization,",
    "year": 2013
  }, {
    "title": "Fast rates for empirical risk minimization of strict saddle problems",
    "authors": ["A. Gonen", "S. Shalev-Shwartz"],
    "venue": "arXiv preprint arXiv:1701.04271,",
    "year": 2017
  }, {
    "title": "Train faster, generalize better: Stability of stochastic gradient descent",
    "authors": ["M. Hardt", "B. Recht", "Y. Singer"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2016
  }, {
    "title": "Deep learning without poor local minima",
    "authors": ["K. Kawaguchi"],
    "venue": "In Conference on Neural Information Processing Systems (NIPS),",
    "year": 2016
  }, {
    "title": "On large-batch training for deep learning: Generalization gap and sharp minima",
    "authors": ["N.S. Keskar", "D. Mudigere", "J. Nocedal", "M. Smelyanskiy", "P.T.P. Tang"],
    "venue": "In International Conference on Learning Representations (ICLR),",
    "year": 2017
  }, {
    "title": "Fast rates for exp-concave empirical risk minimization",
    "authors": ["T. Koren", "K. Levy"],
    "venue": "In Conference on Neural Information Processing Systems (NIPS),",
    "year": 2015
  }, {
    "title": "Stability and hypothesis transfer learning",
    "authors": ["I. Kuzborskij", "F. Orabona"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2013
  }, {
    "title": "Fast Rates by Transferring from Auxiliary Hypotheses",
    "authors": ["I. Kuzborskij", "F. Orabona"],
    "venue": "Machine Learning,",
    "year": 2016
  }, {
    "title": "Gradient descent only converges to minimizers",
    "authors": ["J.D. Lee", "M. Simchowitz", "M.I. Jordan", "B. Recht"],
    "venue": "In Conference on Learning Theory (COLT),",
    "year": 2016
  }, {
    "title": "Generalization bounds for randomized learning with application to stochastic gradient descent",
    "authors": ["B. London"],
    "venue": "In NIPS Workshop on Optimizing the Optimizers,",
    "year": 2016
  }, {
    "title": "Empirical bernstein bounds and sample variance penalization",
    "authors": ["A. Maurer", "M. Pontil"],
    "venue": "arXiv preprint arXiv:0907.3740,",
    "year": 2009
  }, {
    "title": "Fast exact multiplication by the hessian",
    "authors": ["B.A. Pearlmutter"],
    "venue": "Neural Computation,",
    "year": 1994
  }, {
    "title": "A pac-bayesian bound for lifelong learning",
    "authors": ["A. Pentina", "C.H. Lampert"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2014
  }, {
    "title": "A theoretical analysis of metric hypothesis transfer learning",
    "authors": ["M. Perrot", "A. Habrard"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2015
  }, {
    "title": "Online learning, stability, and stochastic gradient descent",
    "authors": ["T. Poggio", "S. Voinea", "L. Rosasco"],
    "venue": "arXiv preprint arXiv:1105.4701,",
    "year": 2011
  }, {
    "title": "Stochastic variance reduction for nonconvex optimization",
    "authors": ["S.J. Reddi", "A. Hefny", "S. Sra", "B. Poczos", "A. Smola"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2016
  }, {
    "title": "Understanding Machine Learning: From Theory to Algorithms",
    "authors": ["S. Shalev-Shwartz", "S. Ben-David"],
    "year": 2014
  }, {
    "title": "Learnability, stability and uniform convergence",
    "authors": ["S. Shalev-Shwartz", "O. Shamir", "N. Srebro", "K. Sridharan"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2010
  }, {
    "title": "Learning categories from few examples with multi model knowledge transfer",
    "authors": ["T. Tommasi", "F. Orabona", "B. Caputo"],
    "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
    "year": 2014
  }, {
    "title": "Understanding deep learning requires rethinking generalization",
    "authors": ["C. Zhang", "S. Bengio", "M. Hardt", "B. Recht", "O. Vinyals"],
    "venue": "In International Conference on Learning Representations (ICLR),",
    "year": 2017
  }, {
    "title": "Stochastic optimization with importance sampling for regularized loss minimization",
    "authors": ["P. Zhao", "T. Zhang"],
    "venue": "In International Conference on Machine Learing (ICML),",
    "year": 2015
  }],
  "id": "SP:93ea563fcc26069442ad3b71e1bc216fe5789d68",
  "authors": [{
    "name": "Ilja Kuzborskij",
    "affiliations": []
  }, {
    "name": "Christoph H. Lampert",
    "affiliations": []
  }],
  "abstractText": "We establish a data-dependent notion of algorithmic stability for Stochastic Gradient Descent (SGD), and employ it to develop novel generalization bounds. This is in contrast to previous distribution-free algorithmic stability results for SGD which depend on the worst-case constants. By virtue of the data-dependent argument, our bounds provide new insights into learning with SGD on convex and non-convex problems. In the convex case, we show that the bound on the generalization error depends on the risk at the initialization point. In the non-convex case, we prove that the expected curvature of the objective function around the initialization point has crucial influence on the generalization error. In both cases, our results suggest a simple data-driven strategy to stabilize SGD by pre-screening its initialization. As a corollary, our results allow us to show optimistic generalization bounds that exhibit fast convergence rates for SGD subject to a vanishing empirical risk and low noise of stochastic gradient.",
  "title": "Data-Dependent Stability of Stochastic Gradient Descent"
}