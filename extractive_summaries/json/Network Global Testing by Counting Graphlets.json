{
  "sections": [{
    "heading": "1. Introduction",
    "text": "Given a large symmetrical network, we are interested in the global testing problem where we use the adjacency matrix of the network to test whether the network consists of only one community or that it consists of multiple communities, where some nodes may have mixed memberships.\nReal networks frequently have severe degree heterogeneity. The Stochastic Block Model (SBM) is well-known, but does not accommodate severe degree heterogeneity. To tackle the problem, Karrer and Newman (2011) proposed the DegreeCorrected Block Model (DCBM). DCBM strikes a better balance between theory and practice than SBM, and has become increasingly more popular recently.\nWe adopt a Degree-Corrected Mixed-Membership (DCMM) model (Jin et al., 2017). DCMM can be viewed as an extension of DCBM, but allows for mixed memberships. Suppose the network has n nodes and K perceivable communities\nC1, C2, . . . , CK . *Equal contribution 1Department of Statistics and Data Science, Carnegie Mellon University, Pittsburgh, USA 2Department of Statistics, University of Chicago, Chicago, USA. Correspondence to: Jiashun Jin <jiashun@stat.cmu.edu>.\nProceedings of the 35 th International Conference on Machine Learning, Stockholm, Sweden, PMLR 80, 2018. Copyright 2018 by the author(s).\nFor each node, we assign a Probability Mass Function (PMF) πi = (πi(1), πi(2), · · · , πi(K))′, where πi(k) is the “weight” that node i puts on community Ck, 1 ≤ k ≤ K. We call node i “pure” if πi is degenerate and “mixed” otherwise. Let A ∈ Rn,n be the adjacency matrix, where Aij = 1 if nodes i and j have an edge, and Aij = 0 otherwise (all diagonal entries of A are 0 as we don’t treat a node as connecting to itself). In DCMM, we think the upper triangle of A contains independent Bernoulli random variables. Moreover, for n degree heterogeneity parameters θ1, θ2, . . . , θn and a non-singular, irreducible matrix P ∈ RK,K ,\nP(Aij = 1) = θiθj K∑ k=1 K∑ `=1 πi(k)πj(`)Pk`. (1)\nAlso, we assume (a) all diagonals of P are 1, and (b) each of the K communities has at least one pure node. With such constraints, DCMM is identifiable (Jin et al., 2017).\nLet Θ be the n× n diagonal matrix Θ = diag(θ1, . . . , θn) and let Π be the n×K matrix Π = [π1, π2, . . . , πn]′. Let Ω = ΘΠPΠ′Θ (recall that P ∈ RK,K):\nΩ = θ1 . . . θn  π ′ 1 ... π′n P [π1, . . . , πn] θ1 . . . θn  . Let diag(Ω) be the diagonal matrix where the i-th diagonal entry is Ωii, and let W = A− [Ω− diag(Ω)]. We have\nA = [Ω− diag(Ω)] +W = “signal” + “noise”.\nRemark 1. Many recent works use the “Random Degree Parameter (RDP)” model (which is narrower than ours): fixing a scaling parameter αn > 0 and a density function f over (0,∞) where the first a few moments of f are finite, and especially the second moment is 1, we assume (θi/αn)\niid∼ f , i = 1, 2, . . . , n. We call the resultant DCMM model the DCMM-RDP model. In applications where we don’t know how θi’s are correlated, it is preferable to treat θ as nonrandom as before, and it is safer to use the original DCMM than DCMM-RDP.\nThe testing problem can be cast as testing a null hypothesis H\n(n) 0 against a specific hypothesis H (n) 1 in its complement:\nH (n) 0 : K = 1 vs. H (n) 1 : K > 1, (2)\nwhere under H(n)1 , DCMM holds for some eligible (P, θ1, ..., θn, π1, ..., πn). Note that under H (n) 0 , P = 1, π1, ..., πn are all degenerate, and P(A(i, j) = 1) = θiθj .\nMost existing literatures for the testing problem (2) have been focused on the special case where\n• No degree heterogeneity. θ1 = θ2 = . . . = θn. • No mixed-membership. All πi are degenerate PMFs.\nMany tests were proposed for this special case, including but are not limited to the likelihood ratio test approach (Wang & Bickel, 2017) and the spectral approach (Bickel & Sarkar, 2016; Lei, 2016; Banerjee & Ma, 2017).\nHowever, in our setting, θ1, θ2, . . . , θn vary significantly from one to another, and it is unclear how to extend the methods above to the current setting. The likelihood ratio test is not applicable, for there are many unknown parameters (θ1, π1), (θ2, π2), ..., (θn, πn). The spectral approach also faces challenges, because the distributions of such test statistics depend on unknown parameters in a complicated way, and it is nontrivial to figure out the rejection region.\nAlso, it may be tempting to adapt the recent approaches on estimating K to our testing problem (Saldana et al., 2017; Chen & Lei, 2017; Le & Levina, 2015), but similarly, due to severe degree heterogeneity, the null distributions of such statistics are not tractable, so they cannot be used directly.\nRecently, Gao and Lafferty (2017) (see also Bubeck et al. (2016) which is related but on different settings) proposed a new test called the Erdős-Zuckerberg (EZ) test for DCMM, with the following constraints.\n• (GL1) No mixed-membership: all πi are degenerate. • (GL2) The community labels are uniformly drawn so\nthe K communities have roughly equal sizes.\n• (GL3) The DCMM-RDP holds (i.e., θi are iid samples), and the K ×K matrix P has the special form of\nP = a b · · · b... . . . ... b b · · · a  . Note that the last bullet point is particularly restrictive.\nGao and Lafferty (2017) made an interesting observation that the effect of the degree heterogeneity parameters θ1, θ2, . . . , θn is largely canceled out in the EZ test, and the test statistic approximately equals to 0 under the null, regardless of what θ1, θ2, . . . , θn are. This allows us to find a convenient way to map out the rejection region.\nUnfortunately, the authors did not make it clear whether the cancellation is “coincidental” and is due to the symmetry they imposed on the model (see GL1-GL3), or is “inherent” and holds for much broader settings.\nIn this paper, we introduce a class of test statistics by counting the number of graphlets in the network. Fixing a small m ≥ 1, we count two kinds of graphlets: length-m paths and m-cycles. Our main contributions are as follows:\n• Ideation. For a K-vector η and a K × K matrix G1/2PG1/2 to be introduced, we derive succinct proxies for the number of length-m paths and mcycles, using η and the eigenvalues and eigenvectors of G1/2PG1/2. The proxies motivate a systematic way of constructing tests where the degree heterogeneity is largely removed so the distributions are more tractable.\nTo the best of our knowledge, such proxies have not been discovered in the literature. • Methods and theory. We propose a class of graphlet count (GC) test statistics, and derive their asymptotic distributions, under the null and alternative hypotheses.\nWe try to be as general as possible, and our methods and theory are for DCMM with minimal constraints.\nThe way we construct our statistics is to use the proxies aforementioned, and thus is different from that in Gao and Lafferty (2017), which uses calculations that heavily depend on the imposed constraints GL1-GL3. See Section 3.2 for more comparison.\nOur findings support the philosophy of Jin (2015) which introduced the community detection algorithm SCORE. Jin (2015) pointed out that θ1, θ2, . . . , θn are required to model severe degree heterogeneity, but they turn out to be nuisance parameters, the effects of which can be largely removed with a proper construction of statistics.\nWhile our tests are designed for global testing, the idea is also useful for tackling other problems. For example, we can combine our idea with those in community detection (e.g. Jin (2015), Chen et al. (2018), Qin and Rohe (2013)) to estimate the number of communities K."
  }, {
    "heading": "2. A Class of Graphlet Count (GC) Statistics",
    "text": "The testing problem (2) is hard for there are so many unknown parameters: P, θ1, . . . , θn, π1, . . . , πn. The parameters θ1, θ2, . . . , θn, which are required to model the severe degree heterogeneity of real networks, are especially hard to deal with for they vary significantly from one to another. What we need is therefore a smart test statistic that\n• does not vary significantly as θ = (θ1, θ2, . . . , θn)′ varies, and has a tractable limiting distribution (so it is easy to map out the rejection region),\n• is powerful in differentiating the null and alternative.\nOur idea is to use the graphlet-count statistics. In a network, we say a path is a “self-avoiding path” if it doesn’t intersect with itself, and a “cycle” if it is a closed path that does not intersect with itself.\nDefinition 2.1 For 0 ≤ m ≤ n, let Bn,m = ∏m−1 s=0 (n− s). Definition 2.2 For m ≥ 1, we define the “density of lengthm self-avoiding paths” by\nL̂m = 1\nBn,m+1 ∑ 1≤i1,...,im+1≤n\ni1,··· ,im+1 are distinct\nAi1i2Ai2i3 · · ·Aimim+1 .\nand for m ≥ 3, we define the “density of m-cycles” by\nĈm = 1\nBn,m ∑ 1≤i1,...,im≤n\ni1,··· ,im are distinct\nAi1i2Ai2i3 · · ·Aimi1 .\nWe propose the family of test statistics, called the Graphlet Count (GC) test statistics:\nχ̂(m)gc = Ĉm − (L̂m−1/L̂m−2)m, m = 3, 4, . . . . (3)\nRemark 2. Using the adjacency matrix A, Ĉm and L̂m can be conveniently computed (e.g., Ĉ4 = 124(n4)\n[ tr(A4)−\n2(1′nA 21n) + 1 ′ nA1n\n] ). See supplemental material."
  }, {
    "heading": "2.1. The Key Idea: Why the GC Test Statistics Work",
    "text": "Recall that Ω = ΘΠPΠ′Θ. Let 1n be the n-dimensional vector of 1’s and let θ = (θ1, θ2, . . . , θn)′. We use (·, ·) to denote the inner product of two vectors. The K ×K matrix G ≡ Π′Θ2Π and the vector η ∈ RK play a key role.\nDefinition 2.3 Denote the vector G−1/2Π′Θ1n by η.\nDefinition 2.4 For 1 ≤ k ≤ K, let λk be the k-th largest (in absolute value) eigenvalue of G1/2PG1/2, and let ξk be the corresponding eigenvector.\nIt turns out that λ1, . . . , λK (eigenvalues of G1/2PG1/2) are the nonzero eigenvalues of Ω. The following results, which will be made precise in Theorems 3.1-3.2, play the key role:\nnm · Ĉm ≈ tr(Ωm) = K∑ k=1 λmk , (4)\nnm+1 · L̂m ≈ 1′nΩm1n = K∑ k=1 (η, ξk) 2λmk . (5)\nWe explain why these equations motivate the test statistic χ̂ (m) gc . Recall that we hope to have a statistic that does not vary too much as θ varies, so first, it is desirable to remove the terms (η, ξk)2, which not only depend on θ but are also not very tractable. Under the alternative hypothesis, it is unclear how to cancel these terms, but under the null hypothesis, K = 1, and the right hand side of (5) reduces to (η, ξ1)\n2λm1 , and there are many ways to do the cancellation. One such way is to use the following ratio:\nnmL̂m−1 nm−1L̂m−2 ≈ ∑K k=1(η, ξk) 2λm−1k∑K k=1(η, ξk) 2λm−2k { = λ1, under H (n) 0 ,\n≤ λ1, under H(n)1 . (6)\nTherefore, at least under H(n)0 , we have managed to cancel the terms (η, ξk)2.\nNext, it is also desirable to cancel the term λ1, at least under the null hypothesis. Comparing (4) and (6), there are many ways to do this, and one such way is to use the χ̂(m)gc statistic aforementioned:\nnmχ̂(m)gc = n mĈm − [ ( nmL̂m−1)/(n m−1L̂m−2) ]m .\nIn fact, by (4) and (6), we have that up to a negligible term (i.e., of a smaller order than that of the standard deviation of the statistic under H(n)0 ),\nχ̂(m)gc { = 0, under H(n)0 , ≥ 1nm ∑K k=2 λ m k , under H (n) 1 .\nOn the one hand, the effects of degree heterogeneity are largely canceled in the statistic, so it does not vary significantly as the vector θ varies (this is particularly important for we wish to have a rejection region that is relatively insensitive to θ). On the other hand, the statistic χ̂(m)gc is able to differentiate the null hypothesis and the alternative hypothesis, through the term ∑K k=2 λ m k . This suggests that χ̂ (m) gc is a reasonable test statistic.\nNote that χ̂(m)gc is only one of many test statistics with the desired properties above, but seemingly one of the simplest.\nRemark 3. Recall that λ1, . . . , λK are the eigenvalues of G1/2PG1/2, and they are also the eigenvalues of PG (nonnegative, irreducible). By Perron’s theorem (Horn & Johnson, 1985), λ1 is positive and λ1 > |λk| for all 2 ≤ k ≤ K.\nRemark 4. Our tests include the EZ test as a special case (i.e., χ̂(m)gc with m = 3), but our idea is by no means a straightforward extension of that in Gao and Lafferty (2017). The EZ test was derived by calculations that depend heavily on the constraints GL1-GL3 imposed on P , θ, etc., and it was unclear whether the core idea of the EZ test is only valid when these constraints hold, or in more general settings. The GC tests are derived by (4)-(6), where the relationship between the test statistics and θ, η, and the eigenvalues and eigenvectors of G1/2PG1/2 has not been discovered before, even in cases where the constraints GL1-GL3 hold.\nRemark 5. Can we simply use ∑K k=2 λ̂ m k as the test statistic, where λ̂k is the k-th eigenvalue of A? We can not, as K is unknown. Can we simply use λ̂2 as the test statistic? We can, but the asymptotic distribution of λ̂2 is much harder to derive than that of χ̂(m)gc (which is Gaussian; see below), so it is challenging to determine the rejection region."
  }, {
    "heading": "3. Main Results",
    "text": "In theory, we use n as the driving asymptotic parameter, let the matrices (Θ,Π, P ) change with n, and consider a\nsequence of problems where we test H(n)0 : K = 1 vs. H\n(n) 1 : K > 1 (K is unknown but does not change with n). Recall node i is pure if πi is degenerate. A pure node can be in any of the K communities. For 1 ≤ k ≤ K, we let"
  }, {
    "heading": "Nk = {1 ≤ i ≤ n : πi is degenerate and πi(k) = 1}",
    "text": "be the set of all pure nodes in the community k. Assume\n‖θ‖ → ∞, ‖θ‖3 → 0. (7)\nSince θmax ≤ ‖θ‖3, this implies θmax → 0. Suppose there is a constant c1 > 0 so that for any 1 ≤ k ≤ K,∑\ni∈Nk θ 2 i∑n\ni=1 θ 2 i\n≥ c1. (8)\n(this roughly says each community has sufficiently many pure nodes). Also, assume for some constant c2 ∈ (0, 1),\nall singular values of P fall between c2 and c−12 . (9)\nDenote Cm = E[Ĉm] and Lm = E[L̂m] and introduce a non-stochastic counterpart of χ̂(m)gc by\nχ(m)gc = Cm − (Lm−1/Lm−2)m. (10)\nTheorem 3.1 Consider the DCMM model (1) where (7)-(9) hold. As n→∞,\nχ(m)gc = 1\nnm { K∑ k=1 λmk − [∑K k=1(η, ξk) 2λm−1k∑K k=1(η, ξk) 2λm−2k ]m} +O(n−m‖θ‖44‖θ‖2m−4).\nThe last term is of a smaller order of the standard deviation of χ̂(m)gc and is thus negligible. Theorem 3.1 solidifies what we mentioned in Section 2.1 and is proved in Section 6.\nTheorem 3.2 Consider the DCMM model (1) where (7)-(9) hold. As n→∞, for m = 3, 4, under either H(n)0 or H\n(n) 1 ,√\nBn,m 2m\n· Ĉ−1/2m [ χ̂(m)gc − χ(m)gc ] d→ N(0, 1).\nThe proof for other fixed m is similar, but significantly more tedious so we leave it as future work. Theorem 3.2 is proved in the supplemental material. Compared to existing literature, our theorems are for a much broader setting where existing works have very little theory and understanding.\nRemark 6. Conditions (8)-(9) are only for H(n)1 since they naturally hold under H(n)0 ; the conditions are only mild. Condition (7) is also only mild. Take the DCMM-RDP model for example (see Remark 1): ‖θ‖ √ nαn and ‖θ‖3 n1/3αn, so Condition (7) requires n−1/2 αn n−1/3. The case αn n−1/3 corresponds to the “strong signal” case, the analysis of which is different and we leave it to the forthcoming manuscript."
  }, {
    "heading": "3.1. Testing Power",
    "text": "By Theorems 3.1-3.2, we expect to see that in distribution,√ Bn,m 2m · Ĉ−1/2m χ̂(m)gc ≈ N (√ Bn,m 2m C−1/2m χ (m) gc , 1 ) .\nMotivated by Theorem 3.1 and equation (4), we introduce a proxy of √\nBn,m 2m · C −1/2 m χ (m) gc , defined as\nδ(m)gc = (2m)−1/2√∑K\nk=1 λ m k\n[ K∑ k=1 λmk − (∑K k=1(η, ξk) 2λm−1k∑K k=1(η, ξk) 2λm−2k )m] ,\n(11) and we expect to see that in distribution,√\nBn,m 2m · Ĉ−1/2m χ̂(m)gc ≈ N(δ(m)gc , 1). (12)\nIt is noteworthy that under H(n)0 , δ (m) gc = 0.\nFixing 0 < α < 1, let zα be the (1−α)-quantile ofN(0, 1). Consider the Graphlet Count (GC) test where we\nreject H(n)0 ⇐⇒ √ Bn,m 2m · Ĉ−1/2m χ̂(m)gc > zα. (13)\nThe theorem below is proved in the supplemental material.\nTheorem 3.3 Consider the DCMM model (1) where (7)-(9) hold. As n → ∞, for m = 3, 4, the level and the power of the Graphlet Count test are respectively α + o(1) and Φ ( δ (m) gc − zα ) + o(1). Moreover, if δ(m)gc →∞ as n→∞, then the power→ 1."
  }, {
    "heading": "3.2. Comparison of χ̂(3)gc and χ̂(4)gc",
    "text": "One of the key messages is that, χ̂(3)gc may be powerless for some non-null cases, even when the “signals” are strong and the test is relatively easy. In comparison, χ̂(4)gc has successfully avoided such a pitfall. Note that translated to our terms, the EZ test by Gao and Lafferty (2017) is χ̂(3)gc .\nIn detail, by Remark 3, λ1 is positive and has the largest absolute value among all λk’s, so\n[ K∑ k=1 (η, ξk) 2λm−1k ]/[ K∑ k=1 (η, ξk) 2λm−2k ] ≤ λ1. (14)\nIt follows that under H(n)1\nδ(m)gc ≥ ( K∑ k=2 λmk )/[2m K∑ k=1 λmk ] 1/2, (15)\nwhere “=” is achievable; see Section 3.3 for examples.\nIt can be shown that ∑K k=1 λ m k > 0, no matter m is odd or\neven. The numerator ∑K k=2 λ m k , however, is more tricky.\n• When m is even, the numerator of (15) is positive.\n• When m is odd, the numerator of (15) can be negative or 0. In fact, δ(m)gc may be 0 under some H (n) 1 , even\nwhen signals are strong; see Section 3.3 for an example. If additionally P (and so G1/2PG1/2) is positive definite, then δ(m)gc is positive, either m is odd or even.\nCorollary 3.1 Consider the DCMM model (1) where (7)- (9) hold and the Graphlet Count test (13). As n→∞.\n• When m = 3, for some configurations of the non-null case, δ(3)gc = 0 and the power of the test is α+ o(1). If additionally the K ×K matrix P is positive definite, then there is a constant c3 > 0 such that δ (3) gc ≥ c3‖θ‖3\nand so the power of the test & Φ ( c3‖θ‖3− zα ) , which tends to 1 since ‖θ‖ → ∞ in our setting.\n• If m = 4, then there is a constant c4 > 0 such that δ (4) gc ≥ c4‖θ‖4 and the power of the test& Φ ( c4‖θ‖4−\nzα ) , which tends to 1 as ‖θ‖ → ∞ in our setting.\nSee the supplement for the proof. In comparison, χ̂(3)gc has a two-fold disadvantage: it may lose power in some non-null configurations even when ‖θ‖ is large, and as ‖θ‖ → ∞, its power grows to 1 in a speed slower than that of χ̂(4)gc .\nRemark 7. In the most subtle case where ‖θ‖ 1, for any m ≥ 3, χ̂(m)gc has a non-trivial power since the signal to noise ratio δ(m)gc ‖θ‖m. The form is reminiscent of the results on likelihood ratio (Mossel et al., 2015) which is unfortunately only for SBM (much narrower than DCMM).\nRemark 8. The computational complexity of the GC test is O(nd2) for m = 3 and O(nd3) for m = 4 (Schank & Wagner, 2005), where d is the maximum degree. Many large networks are reasonably sparse where d n, and the complexity is reasonably modest in such cases.\nRemark 9. Our work is connected to Maugis et al. (2017), which characterizes the expected number of closed walks. However, their work does not study the expected number non-closed walks, and the standard deviations of close and non-closed walks, so how to apply their results to our setting is unclear. Our work is also closed to the notion of clustering coefficient (Holland & Leinhardt, 1971; Watts & Strogatz, 1998), which in our notation equals to 3Ĉ3/L̂2. To use this as a test, the challenge is how to normalize the statistic properly so the limiting distribution is more tractable. Also, the test may lose power in some settings. In Section 3.3, we provide an example where C3/L2 = λ1 + ( ∑K k=2 λ 3 k)/λ 2 1,\nso when ∑K k=2 λ 3 k = 0, asymptotically, the test is powerless while the GC test may still have good power."
  }, {
    "heading": "3.3. An Example",
    "text": "It is instructive to consider an example where δ(m)gc can be further simplified. Consider a setting where • the DCMM-RDP model holds (see Remark 1), i.e.,\n(θi/αn) i.i.d.∼ f , where the 2nd moment of f is 1,\n• all πi’s are degenerate, dividing to K equal-size communities,\n• the rows of P have an equal sum.\nIt follows that approximately: (a). ‖θ‖ = √ nαn, (b). G ∝ the K ×K identity matrix, so ξ1 (the first eigenvector of G1/2PG1/2) is approximately proportional to the vector of ones 1K . (c). η = G−1/2Π′Θ1n ∝ 1K , due to the random model for θi. Therefore, (η, ξk) = (ξ1, ξk), which equals to 1 if k = 1 and 0 otherwise, and so by basic linear algebra,\nδ(m)gc = (2m)−1/2√∑K\nk=1 λ m k\n[ K∑ k=1 λmk − λm1 ] =\n∑K k=2 λ m k√\n2m ∑K k=1 λ m k .\nWe now consider a setting where we can spell out λk more explicitly. Suppose K is even and the K × K matrix P calibrating the community structure is a 2× 2 block-wise\nmatrix having the form of P = [ D C C D ] , where C,D ∈ RK/2,K/2 and\nD = 1 a · · · a... . . . ... a a · · · 1  and C = b b · · · b... . . . ... b b · · · b  . In this case, λ1 = nα2n K { (1− a) + K2 (a+ b) } , and the other (K− 1) eigenvalues are (which one is λ2 depends on (a, b))\nnα2n K [(1− a) + K 2 (a− b)], nα 2 n K (1− a), . . . , nα 2 n K (1− a).\nIf we let AK(a, b) = (1− a) + K2 (a− b) and BK(a, b) = (1− a) + K2 (a+ b), recalling ‖θ‖ = √ nαn, then\nδ(3)gc = (K− 3 2 ‖θ‖3) · [A3K(a, b) + (K − 2)(1− a)3]√\n[A3K(a, b) +B 3 K(a, b) + (K − 2)(1− a)3\n,\nδ(4)gc = (K−2‖θ‖4) · [A4K(a, b) + (K − 2)(1− a)4]√ A4K(a, b) +B 4 K(a, b) + (K − 2)(1− a)4 .\nNote that δ(4)gc is always positive, but δ (3) gc can be either positive or negative, and in particular,\nδ (3) gc = 0 when b = w + (1− w)a, where w = 1+(K−2)\n1/3\nK/2 .\nFigure 1 compares δ(3)gc and δ (4) gc for (K, a) = (10, .25) and various (b, ‖θ‖). Regardless of ‖θ‖, δ(3)gc gets small when b is close to 0.7. However, δ(4)gc has no such issue."
  }, {
    "heading": "3.4. The Lower Bound",
    "text": "The lower bound is not discussed here but is studied in the extended version (Jin et al., 2018), where we show that under DCMM, if ‖θ‖ ≤ c for a sufficiently small constant, then the risk (sum of type-I and type-II errors) of any test converges to 1 as n → ∞. See also Massoulié (2014), Mossel (2015), Abbe & Sandon (2016), Gao & Lafferty (2017). Note by Corollary 3.1, if the level α→ 0, then the risk of the GC test→ 0 as ‖θ‖ → ∞. A closely related work is Jin and Ke (2017). Under the DCMM and the assumption of θmax ≤ Cθmin, they showed that when ‖θ‖ 6→ ∞ it is impossible to successfully estimate the mixed memberships."
  }, {
    "heading": "4. Simulations",
    "text": "We investigate χ̂(m)gc for m = 3, 4. Recall that when m = 3, it coincides with the EZ test (Gao & Lafferty, 2017). The methods (Bickel & Sarkar, 2016; Lei, 2016; Banerjee & Ma, 2017; Wang & Bickel, 2017) are for SBM, which do not apply to our settings and so we skip them for study.\nExperiment 1 (checking for asymptotic normality). Fixing n = 200, we consider a null setting where θi’s are from√\n10θi iid∼ Pareto(4, 0.375);1 (note: severe degree heterogeneity!) We also consider an alternative case where θi’s are from √ 2θi\niid∼ Pareto(4, 0.375), K = 3, and P is the matrix with unit diagonals and all off-diagonals are 1/3. Among the 200 nodes, 180 are pure with 60 in each community, and the remaining 20 nodes have a mixed membership (1/3, 1/3, 1/3). The results of 500 repetitions are in Figure 2, which suggest that the claimed asymptotic normality is valid even for relatively small n.\nExperiment 2 (power comparison). Fix (n,K) = (300, 10). All nodes are pure with 30 in each commu-\n1In Pareto(α, xm), α is for shape, xm is for scale.\nFigure 2. Histograms of\n√\n(Bn,4/8) · Ĉ−1/24 χ̂ (4) gc for the null hy-\npothesis (light blue) and the alternative hypothesis (yellow). The blue and red curves are densities of N(0, 1) and N(δ(4)gc , 1), respectively, which support our results on asymptotical normality.\nnity. For (a, b) and h > 0, let the matrix P be the same as in Section 3.3. Set θi = (h/‖θ̃‖)θ̃i, where θ̃i iid∼ Pareto(4, 0.375); we note that ‖θ‖ = h.\nFor ‖θ‖ ranging in {5, 6, . . . , 10}, we consider three different settings for (a, b), (i)-(iii). See Table 1 for the results. In (i), (a, b) = (.15, .52) and the second eigenvalue λ2 of G1/2PG1/2 is moderately large, and χ̂(4)gc uniformly outperforms χ̂(3)gc (the EZ test). In (ii), (a, b) = (.30, .54), λ2 is relatively small and the testing problem is more challenging than (i). In this case, χ̂(4)gc performs better again. In (iii), we investigate a case where δ(3)gc = 0 and see how χ̂ (3) gc deals with this most challenging case (the case poses no challenge to χ̂(4)gc as δ (4) gc is always > 0; see Section 3.3). In this case, χ̂ (3) gc loses power, and significantly underperforms χ̂ (4) gc .\nThese results are consistent with our theoretical results, especially those of Section 3.3."
  }, {
    "heading": "5. Application to a Football Network",
    "text": "In the college football network (Girvan & Newman, 2002), each node is a Division I-A college team and two nodes have an edge if and only if they played ≥ 1 games during the Fall 2000 season. There are a total of 115 teams. Except for 5 “independent” teams, all teams are manually divided into 11 conferences for administration purposes; we treat these “manually labeled communities” as the ground truth.\nFirst, we consider a relatively easy setting where we test whether the whole network has only 1 community or has multiple communities. As expected, for both m = 3 and 4, our test χ̂(m)gc rejects the null with extremely small p-values.\nNext, we consider a more subtle problem, where for each of the 11 manually labeled communities aforementioned, we test whether it can’t be further divided into multiple communities (null) or it can (alternative). The results of all 11 testing settings are in Table 2.\nFor the first 10 test settings, despite some differences in the p-values, two tests, χ̂(3)gc and χ̂ (4) gc , agree with each other and both accept the null. For the last setting (corresponding to the Western Athletic Conference (WAC)), however, χ̂(4)gc votes for rejection and χ̂(3)gc votes for acceptance. It turns out that one team (“BioseState”) in the WAC is an outlier, which did not play any game in the data range. After removing the outlier, both tests vote for acceptance. These results are consistent with the ground truth, suggesting (a) both tests yield reasonable testing results even for small-size networks, and (b) χ̂(4)gc is more effective in detecting outliers.\nm χ̂\n(m)\ngc and corre-"
  }, {
    "heading": "6. Proof of Theorem 3.1",
    "text": "First, we show that for any m ≥ 3,\nBn,mCm = K∑ k=1 λmk +O ( ‖θ‖44‖θ‖2m−4 ) , (16)\nand for any m ≥ 1, Bn,m+1Lm equals to K∑ k=1 λmk (η ′ξk) 2 +O ( ‖θ‖21‖θ‖44‖θ‖2m−6 ) . (17)\nConsider (16). By definition, Bn,mCm = Bn,mE[Ĉm] =∑ i1,...,im E[Ai1i2 · · ·Aimi1 ] = ∑ i1,...,im\nΩi1i2 · · ·Ωimi1 , where the sum is over distinct indices i1, ..., im. As a result,\nBn,mCm = tr(Ω m)− ∑ non-distinct i1,...,im Ωi1i2Ωi2i3 · · ·Ωimi1 .\nWe calculate the term tr(Ωm). From the DCMM model, Ω = ΘΠPΠ′Θ. It follows that\nΩm = ΘΠP (Π′Θ2Π)P (Π′Θ2Π) · · ·P (Π′Θ2Π)PΠ′Θ\n= ΘΠ(PGPG · · ·PGP )Π′Θ = (ΘΠG−1/2)(G1/2PG1/2)m(G−1/2Π′Θ).\nFor any matrices A and B, tr(AB) = tr(BA). As a result, tr(Ωm) = tr [ (P 1/2GP 1/2)m(G−1/2Π′Θ)(ΘΠG−1/2) ] = tr [ (P 1/2GP 1/2)m\n] = ∑ k λmk . (18)\nWe then bound the remainder term. Note that Ωij = θiθj(π ′ iPπj) ≤ Cθiθj , where the last inequality is from Condition (9). Hence,∑ non-distinct i1,...,im Ωi1i2Ωi2i3 · · ·Ωimi1 ≤ ∑ non-distinct i1,...,im Cθ2i1θ 2 i2 · · · θ 2 im\n≤ ∑\ni1,...,im−1\nCθ4i1θ 2 i2 · · · θ 2 im−1 ≤ C‖θ‖ 4 4‖θ‖2(m−2).\nCombining the above gives (16).\nConsider (17). Similarly, we have\nBn,m+1Lm = 1 ′ nΩ m1n− ∑\nnon-distinct i1,...,im+1\nΩi1i2Ωi2i3 · · ·Ωimim+1 .\nSince Ω = ΘΠPΠ′Θ, it follows that\n1′nΩ m1n = 1 ′ nΘΠP (Π ′Θ2Π)P (Π′Θ2Π) · · ·PΠ′Θ1n = 1′nΘΠ(PGPG · · ·P )Π′Θ1n = 1′nΘΠG −1/2(G1/2PG1/2)mG−1/2Π′Θ1n\n= η′(G1/2PG1/2)mη.\nThe eigen-decomposition G1/2PG1/2 = ∑K k=1 λkξkξ ′ k im-\nplies that (G1/2PG1/2)m = ∑ k=1 λ m k ξkξ ′ k. As a result,\n1′nΩ m1n = η ′[ K∑ k=1 λmk ξkξ ′ k ] η = K∑ k=1 λmk (η ′ξk) 2. (19)\nWe then bound the remainder term. Since Ωij ≤ Cθiθj , Ωi1i2 · · ·Ωimim+1 ≤ Cθi1θim+1θ2i2 · · · θ 2 im\n. It follows that∑ non-distinct i1,...,im+1 Ωi1i2Ωi2i3 · · ·Ωimim+1\n≤ ( ∑ i1=im+1 + ∑ i2=im+1 + ∑\nnon-distinct i2,...,im\n) Cθi1θim+1θ 2 i2 · · · θ 2 im\n≤ ∑\ni1,...,im\nCθ2i1 · · · θ 2 im + ∑ i1,...,im Cθi1θ 3 i2θ 2 i3 · · · θ 2 im\n+ ∑\ni1,...,im−1,im+1\nθi1θim+1θ 4 i2θ 2 i3 · · · θ 2 im−1\n≤C [ ‖θ‖2m + ‖θ‖1‖θ‖33‖θ‖2(m−2) + ‖θ‖21‖θ‖44‖θ‖2(m−3) ]\n≤C‖θ‖2(m−3) ( ‖θ‖6 + ‖θ‖1‖θ‖33‖θ‖2 + ‖θ‖21‖θ‖44 ) .\nWe need to compare the three terms in the brackets. First, applying Holder’s inequality with p = 3 and q = 3/2,\nwe have ∑ i θ 2 i = ∑ i θ 4 3 i θ 2 3 i ≤ ( ∑ i θ 4p 3 i ) 1 p ( ∑ i θ 2q 3 i ) 1 q . It implies ‖θ‖2 ≤ ‖θ‖4/34 ‖θ‖ 2/3 1 . As a result, ‖θ‖6 ≤ ‖θ‖44‖θ‖21. This means the first term above is dominated by the last term. Second, by Cauchy-Schwartz inequality, ∑ i θ 3 i ≤\n( ∑ i θ 2 i ) 1/2( ∑ i θ 4 i )\n1/2, which means ‖θ‖33 ≤ ‖θ‖‖θ‖24. As a result, ‖θ‖1‖θ‖33‖θ‖2 ≤ ‖θ‖1‖θ‖24‖θ‖3. Furthermore, we have proved ‖θ‖3 ≤ ‖θ‖24‖θ‖1. Combining the above gives ‖θ‖1‖θ‖33‖θ‖2 ≤ ‖θ‖21‖θ‖44. Hence, the second term is dominated by the last term. In summary, the remainder term is O(‖θ‖21‖θ‖44‖θ‖2(m−3)). This proves (17).\nNext, we use (16)-(17) to show the claim. Write for short\nχ (m) gc,0 =\n1\nBn,m {∑ k λmk − [∑ k(η, ξk) 2λm−1k∑ k(η, ξk) 2λm−2k ]m} .\nWrite C̃m = Bn,mCm, C̃0m = tr(Ω m), L̃m = Bn,m+1Lm, and L̃0m = 1 ′ nΩ m1n, for all m. By definition and (18)-(19),\nBn,mχ (m) gc,0 = C̃ 0 m − (L̃0m−1/L̃0m−2)m,\nBn,mχ (m) gc = Bn,m[Cm − (Lm−1/Lm−2)m]\n= C̃m − (Bn,m−1) m\n(Bn,m)m−1 · (L̃m−1/L̃m−2)m.\nAs a result,\nBn,m|χ(m)gc − χ (m) gc,0| ≤ |C̃m − C̃0m|+ ∣∣∣ (L̃m−1)m (L̃m−2)m − (L̃ 0 m−1) m (L̃0m−2) m ∣∣∣ + (L̃m−1) m\n(L̃m−2)m ∣∣∣ (Bn,m−1)m(Bn,m)m−1 − 1∣∣∣ ≡ I1 + I2 + I3. (20)\nWe now bound these three terms. By (16)-(17),\n|C̃m − C̃0m| = O(‖θ‖44‖θ‖2m−4), |L̃m − L̃0m| = O(‖θ‖21‖θ‖44‖θ‖2m−6). (21)\nHence, I1 = O(‖θ‖44‖θ‖2m−4).\nTo bound I2, we need the following lemma, which is proved in the supplemental material.\nLemma 6.1 Under conditions of Theorem 3.3, |λk| ‖θ‖2 for 1 ≤ k ≤ K, and max1≤k≤K |η′ξk| ‖θ‖−1‖θ‖1.\nBy (19), L̃0m = ∑ k(η ′ξk)\n2λmk . For m even, it then follows from Lemma 6.1 that\nL̃0m ≥ c‖θ‖2m−2‖θ‖21 (22)\nfor a constant c > 0. For m odd, this is still true; see the proof of Lemma B.1 in the supplemental material. Additionally, by Cauchy-Schwarz inequality, ‖θ‖4 ≤ n‖θ‖44; hence, for m ≤ 3, |L̃m − L̃0m| is negligible compared to the order of L̃0m, so we also have L̃m ≥ c‖θ‖2m−2‖θ‖21. Now,∣∣∣ L̃0m−1 L̃0m−2 − L̃m−1 L̃m−2 ∣∣∣ ≤ |L̃m−1−L̃0m−1| L̃0m−2 + L̃m−1 L̃m−2 |L̃m−2−L̃0m−2| L̃0m−2\n= O (‖θ‖21‖θ‖44‖θ‖2m−8 ‖θ‖2m−6‖θ‖21 ) +O ( ‖θ‖2 ‖θ‖ 2 1‖θ‖44‖θ‖2m−10 ‖θ‖2m−6‖θ‖21 ) = O(‖θ‖44‖θ‖−2).\nSince |xm − ym| ≤ C|x− y|(|x|+ |y|)m−1,\nI2 ≤ C ∣∣∣ L̃0m−1 L̃0m−2 − L̃m−1 L̃m−2 ∣∣∣ · ∣∣∣ L̃0m−1 L̃0m−2 ∣∣∣m−1 = O(‖θ‖44‖θ‖−2 · ‖θ‖2m−2) = O(‖θ‖44‖θ‖2m−4).\nConsider I3. Note that (Bn,m−1)\nm (Bn,m)m−1 = n(n−1)···(n−m+2)(n−m+1)m−1 =∏m−1\nj=1 (1 + j n−m+1 ) = 1 +O( 1 n ). So,\nI3 = O(‖θ‖2m · n−1) = O(‖θ‖44‖θ‖2m−4),\nwhere we have used the universal inequality ‖θ‖4 ≤ n‖θ‖44.\nWe plug the above results into (20) and note that Bn,m ∼ nm. The claim follows immediately."
  }, {
    "heading": "7. Conclusion",
    "text": "We consider a hard testing problem in the rather general DCMM model where the challenge is severe degree heterogeneity. We discover a systematic way to cancel the effects of degree heterogeneity, and propose a family of tests, with careful analysis and numerical support. Compared to literature, our tests have competitive powers and are applicable in much broader settings. Our theory is also for very broad settings where existing works have very limited understanding. We point out an unappealing feature of the EZ test (Gao & Lafferty, 2017), and shows a new test in our family has successfully overcome the problem that the EZ test faces.\nIn our theorems, we require K to be fixed, but the results continue to hold if K → ∞ reasonably slowly. We also require the singular values of P are in the same order, but this is mostly for simplicity in presentation and can be replaced by weaker conditions. We also assume ‖θ‖3 → 0. The case ‖θ‖3 →∞ is related to the “dense network” case, the analysis of which can be done but is different and we leave it as future work."
  }],
  "year": 2018,
  "references": [{
    "title": "Mixed membership stochastic blockmodels",
    "authors": ["E. Airoldi", "D. Blei", "S. Fienberg", "E. Xing"],
    "venue": "Journal of Machine Learning Research,",
    "year": 2008
  }, {
    "title": "Optimal hypothesis testing for stochastic block models with growing degrees",
    "authors": ["D. Banerjee", "Z. Ma"],
    "year": 2017
  }, {
    "title": "Hypothesis testing for automated community detection in networks",
    "authors": ["P.J. Bickel", "P. Sarkar"],
    "venue": "Journal of the Royal Statistical Society: Series B (Statistical Methodology),",
    "year": 2016
  }, {
    "title": "Testing for high-dimensional geometry in random graphs",
    "authors": ["S. Bubeck", "J. Ding", "R. Eldan", "M.Z. Rácz"],
    "venue": "Random Structures & Algorithms,",
    "year": 2016
  }, {
    "title": "Network cross-validation for determining the number of communities in network data",
    "authors": ["K. Chen", "J. Lei"],
    "venue": "Journal of the American Statistical Association,",
    "year": 2017
  }, {
    "title": "Convexified modularity maximization for degree-corrected stochastic block models",
    "authors": ["Y. Chen", "X. Li", "J. Xu"],
    "venue": "The Annals of Statistics,",
    "year": 2018
  }, {
    "title": "Testing for global network structure using small subgraph statistics",
    "authors": ["C. Gao", "J. Lafferty"],
    "year": 2017
  }, {
    "title": "Community structure in social and biological networks",
    "authors": ["M. Girvan", "M. Newman"],
    "venue": "Proceedings of the National Academy of Sciences,",
    "year": 2002
  }, {
    "title": "Transitivity in structural models of small groups",
    "authors": ["P.W. Holland", "S. Leinhardt"],
    "venue": "Comparative Group Studies,",
    "year": 1971
  }, {
    "title": "Matrix Analysis",
    "authors": ["R. Horn", "C. Johnson"],
    "year": 1985
  }, {
    "title": "Fast community detection by SCORE",
    "authors": ["J. Jin"],
    "venue": "The Annals of Statistics,",
    "year": 2015
  }, {
    "title": "A sharp lower bound for mixedmembership estimation",
    "authors": ["J. Jin", "Z.T. Ke"],
    "year": 2017
  }, {
    "title": "Estimating network memberships by simplex vertices hunting",
    "authors": ["J. Jin", "Z.T. Ke", "S. Luo"],
    "year": 2017
  }, {
    "title": "Network global testing by counting graphlets (extended version)",
    "authors": ["J. Jin", "Z.T. Ke", "S. Luo"],
    "year": 2018
  }, {
    "title": "Stochastic blockmodels and community structure in networks",
    "authors": ["B. Karrer", "M. Newman"],
    "venue": "Physical Review E,",
    "year": 2011
  }, {
    "title": "Estimating the number of communities in networks by spectral methods",
    "authors": ["C.M. Le", "E. Levina"],
    "year": 2015
  }, {
    "title": "A goodness-of-fit test for stochastic block models",
    "authors": ["J. Lei"],
    "venue": "The Annals of Statistics,",
    "year": 2016
  }, {
    "title": "Community detection thresholds and the weak ramanujan property",
    "authors": ["L. Massoulié"],
    "venue": "In Proceedings of the fortysixth annual ACM symposium on Theory of computing,",
    "year": 2014
  }, {
    "title": "Topology reveals universal features for network comparison",
    "authors": ["Maugis", "P.-A. G", "S.C. Olhede", "P.J. Wolfe"],
    "year": 2017
  }, {
    "title": "Reconstruction and estimation in the planted partition model",
    "authors": ["E. Mossel", "J. Neeman", "A. Sly"],
    "venue": "Probability Theory and Related Fields,",
    "year": 2015
  }, {
    "title": "Regularized spectral clustering under the degree-corrected stochastic blockmodel",
    "authors": ["T. Qin", "K. Rohe"],
    "venue": "In Advances in Neural Information Processing Systems,",
    "year": 2013
  }, {
    "title": "How many communities are there",
    "authors": ["D. Saldana", "Y. Yu", "Y. Feng"],
    "venue": "Journal of Computational and Graphical Statistics,",
    "year": 2017
  }, {
    "title": "Approximating clustering coefficient and transitivity",
    "authors": ["T. Schank", "D. Wagner"],
    "venue": "Journal of Graph Algorithms and Applications,",
    "year": 2005
  }, {
    "title": "Likelihood-based model selection for stochastic block models",
    "authors": ["Y.R. Wang", "P.J. Bickel"],
    "venue": "The Annals of Statistics,",
    "year": 2017
  }],
  "id": "SP:a6b90b21e61d88d2f5344aa7475b2cd3cc2e1da8",
  "authors": [{
    "name": "Jiashun Jin",
    "affiliations": []
  }, {
    "name": "Zheng Tracy Ke",
    "affiliations": []
  }, {
    "name": "Shengming Luo",
    "affiliations": []
  }],
  "abstractText": "Consider a large social network with possibly severe degree heterogeneity and mixedmemberships. We are interested in testing whether the network has only one community or there are more than one communities. The problem is known to be non-trivial, partially due to the presence of severe degree heterogeneity. We construct a class of test statistics using the numbers of short paths and short cycles, and the key to our approach is a general framework for canceling the effects of degree heterogeneity. The tests compare favorably with existing methods. We support our methods with careful analysis and numerical study with simulated data and a real data example.",
  "title": "Network Global Testing by Counting Graphlets"
}